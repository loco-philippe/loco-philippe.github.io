<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.8.1" />
<title>ES.ESValue API documentation</title>
<meta name="description" content="Created on Mon Aug
2 14:51:23 2021 …" />
<link href='https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css' rel='stylesheet'>
<link href='https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/8.0.0/sanitize.min.css' rel='stylesheet'>
<link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" rel="stylesheet">
<style>.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>ES.ESValue</code></h1>
</header>
<section id="section-intro">
<p>Created on Mon Aug
2 14:51:23 2021</p>
<p>@author: philippe@loco-labs.io</p>
<p>This module groups together the classes of the objects used in the <code><a title="ES.ESObs" href="ESObs.html">ES.ESObs</a></code> module.</p>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># -*- coding: utf-8 -*-
&#34;&#34;&#34;
Created on Mon Aug  2 14:51:23 2021

@author: philippe@loco-labs.io

This module groups together the classes of the objects used in the `ES.ESObs` module.
&#34;&#34;&#34;
import json, geojson, struct, numpy, pandas, shapely
from datetime import datetime
from ESconstante import ES, mDistRef, identity
#from shapely.geometry import shape #, mapping
from ESElement import isESAtt, isUserAtt
from geopy import distance

def gshape(coord):
    if type(coord) == list:  coor = json.dumps(coord)
    elif type(coord) == str: coor = coord
    else: coor = coord.copy()
    for tpe in [&#34;Point&#34;, &#34;MultiPoint&#34;, &#34;Polygon&#34;, &#34;MultiPolygon&#34;]:
    #for tpe in [&#34;MultiPoint&#34;, &#34;Polygon&#34;, &#34;MultiPolygon&#34;]:
        try:
            s = shapely.geometry.shape(geojson.loads(&#39;{&#34;type&#34;:&#34;&#39; + tpe + &#39;&#34;,&#34;coordinates&#34;:&#39; + coor + &#39;}&#39;))
            return s
        except: s = None
    return s

class ESValue:
    &#34;&#34;&#34;
    This class is the parent class for each kind of values 
     (`ES.ESValue.DatationValue`, `ES.ESValue.LocationValue`, `ES.ESValue.PropertyValue`,
      `ES.ESValue.ResultValue`,
    &#34;&#34;&#34;
    def mini(x, y):
        if type(x) == LocationValue: mm = LocationValue([min(x.point[0], y.point[0]), min(x.point[1], y.point[1])])
        elif type(x) == DatationValue: mm = DatationValue(min(x.instant, y.instant))
        else : mm = x
        return mm

    def maxi(x, y):
        if type(x) == LocationValue:
            mm = LocationValue([max(x.point[0], y.point[0]), max(x.point[1], y.point[1])])
        elif type(x) == DatationValue: mm = DatationValue(max(x.instant, y.instant))  
        else : mm = x
        return mm
    
    def __init__(self):
        self.name = ES.nullName

    def vName(self, genName=ES.nullName):  
        if self.name == ES.nullName : return genName
        else : return self.name
    
    def majName(self, nam):
        name = str(nam)
        #☺if type(name) != str : name = str(name)
        if name != &#39;&#39; : self.name = name

    def majValue(self, val, simple = True):
        if type(val) == LocationValue :
            if not simple and val.shap != None and val.shap != gshape(ES.nullCoor) : 
                self.shap = val.shap
                self.point = [self.shap.centroid.x, self.shap.centroid.y]
            if simple and val.point != ES.nullCoor : self.point = val.point
        elif type(val) == DatationValue :
            if not simple and val.slot != [ES.nullDate, ES.nullDate] : 
                self.slot = val.slot
                self.instant = self.slot[0] + (self.slot[1] - self.slot[0]) / 2
            if simple and val.instant != ES.nullDate : self.instant = val.instant

    def to_strBytes(self, simple = False):
        bval = str.encode(self.name)
        if simple : return str.encode(self.name)
        else : return struct.pack(&#39;&gt;B&#39;,bval.__len__()) + bval
        
    def from_strBytes(self, byt, simple = False):
        if simple : 
            siz = byt.__len__()
            name = bytes.decode(byt)
        else : 
            siz = struct.unpack(&#39;&gt;B&#39;, byt[0:1])[0]
            name = bytes.decode(byt[1: siz + 1])
        self.init(name)
        return siz + 1
                
class ESIndexValue(ESValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    def __init__(self, ind):
        self.ind = ind

class DatationValue(ESValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    #nullName    = ES.dat_nullName
    valName     = ES.dat_valName
    #valueName   = ES.dat_valueName
    valueType   = ES.dat_valueType

    def __init__(self, val = ES.nullDate):
        ESValue.__init__(self)
        self.slot = [ES.nullDate, ES.nullDate]
        self.instant = ES.nullDate
        self.init(val)
        
    def init(self, val = ES.nullDate):
        if type(val) == DatationValue :
            self.instant = val.instant
            self.slot = val.slot
            self.name = val.name
            return
        elif type(val) == dict :
            self.name, val = list(val.items())[0]   
        slot = self.initSlot(val)
        if slot == [ES.nullDate, ES.nullDate] : 
            if type(val) == str and self.name == ES.nullName : self.name = val
        elif slot[0] == slot[1] : self.instant = slot[0]
        else : self.slot = slot

    def initSlot(self, val= ES.nullDate):
        if   type(val) == DatationValue:  return val.slot
        elif type(val) == list: 
            if type(val[0]) == datetime : return val
            else : return [datetime.fromisoformat(str(val[0])), datetime.fromisoformat(str(val[1]))]
        elif type(val) == datetime: return [val, val]
        elif type(val) == numpy.datetime64 :
            sl = pandas.Timestamp(val).to_pydatetime()
            return [sl, sl]                    
        elif type(val) == pandas._libs.tslibs.timestamps.Timestamp :
            sl = val.to_pydatetime()
            return [sl, sl]                    
        elif type(val) == str: 
            try:
                sl = datetime.fromisoformat(val)
                slo = [sl, sl]
            except:
                try:
                    val2 = json.loads(val)
                    slo = [datetime.fromisoformat(val2[0]),
                           datetime.fromisoformat(val2[1])]
                except:
                    sl = ES.nullDate
                    slo = [sl, sl]
            return slo
        else: 
            sl = ES.nullDate
            return [sl, sl]
        
    def __lt__(self, other): 
        return self.instant &lt; other.instant
 
    def __eq__(self, other): 
        return self.instant == other.instant and self.slot == other.slot and self.name == other.name
        #or (self.name[0:3] == self.nullName and other.name[0:3] == self.nullName))

    def __repr__(self): return self.json()

    def getInstant(self) : return self.instant
    
    def getSlot(self) : return self.slot

    def vInstant(self, option = ES.mOption, string = False) : #string=False):  
        if self.slot != [ES.nullDate, ES.nullDate] : val = [self.slot[0], self.slot[1]]
        else: val =  self.instant
        if option[&#34;json_dat_instant&#34;]:
            if self.instant != ES.nullDate : val =  self.instant
            elif self.slot != [ES.nullDate, ES.nullDate] : 
                val =  (self.slot[0] + (self.slot[1] - self.slot[0]) / 2)
        if   string and type(val) == dict : return [val[0].isoformat(), val[1].isoformat()]
        elif string and type(val) != dict : return val.isoformat()
        else : return val

    def json(self, option = ES.mOption): 
        val = self.vInstant(option, string=True)
        if option[&#34;json_dat_name&#34;] and self.name != ES.nullName :
            if val != ES.nullDate.isoformat():  return json.dumps({self.name : val})
            else :                              return self.name
        else : 
            if type(val) == str :               return val
            else :                              return json.dumps(val)

    def to_bytes(self):
        return struct.pack(&#39;&lt;HBBBBB&#39;, self.instant.year, self.instant.month,
                           self.instant.day, self.instant.hour,
                           self.instant.minute, self.instant.second)
        
    def from_bytes(self, byt):
        dt = struct.unpack(&#39;&lt;HBBBBB&#39;, byt[0:7])
        self.init(datetime(dt[0], dt[1], dt[2], dt[3], dt[4], dt[5]))
        return 7

class LocationValue(ESValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    #nullName    = ES.nullName
    valName     = ES.loc_valName
    valueType   = ES.loc_valueType

    def __init__(self, val=ES.nullCoor, geo=True, cart=True):
        ESValue.__init__(self)
        self.point = ES.nullCoor
        self.shap = None
        self.geod = geo
        self.carto = cart
        self.init(val)
    
    def init(self, val=ES.nullCoor):
        if type(val) == LocationValue :
            self.shap = val.shap
            self.point = val.point
            self.name = val.name
            self.geod = val.geod
            self.carto = val.carto
            return
        elif type(val) == dict :
            self.name, val = list(val.items())[0]   
        shap = gshape(val)
        if shap == None :
            if type(val) == str and self.name == ES.nullName : self.name = val
        elif type(shap) == shapely.geometry.point.Point : self.point = [shap.x, shap.y]
        else : self.shap = shap
        #self.shap = gshape(val)
        #self.point = ES.nullCoor
        #if self.shap != None: self.point = [self.shap.centroid.x, self.shap.centroid.y]
        #elif type(val) == str and self.name == ES.nullName : self.name = val

    def __eq__(self, other): return self.point == other.point and self.geod == other.geod \
        and self.carto == other.carto and self.shap == other.shap and self.name == other.name
        #or (self.name[0:3] == self.nullName and other.name[0:3] == self.nullName))

    #def __repr__(self): return object.__repr__(self) + &#39;\n&#39; + self.json()
    def __repr__(self): return self.json()

    def __lt__(self, other): 
        return distance.distance(self.coorInv, mDistRef) &lt;  distance.distance(other.coorInv, mDistRef)
    
    @property
    def coorInv(self):  return [self.vPoint()[1], self.vPoint()[0]]
    
    def getShap(self) : return self.shap
    
    def getPoint(self) : return self.point
    
    def vPoint(self, option = ES.mOption):  
        val = ES.nullCoor
        if self.shap != None :              val =  self.shap.__geo_interface__[ES.coordinates]
        else:                               val =  self.point
        if option[&#34;json_loc_point&#34;]:
            if self.point != ES.nullCoor :  val =  self.point
            elif self.shap != None :        val = [self.shap.centroid.x, self.shap.centroid.y]
        return val

    def vPointX(self, option = ES.mOption) : return self.vPoint(option)[0]
    def vPointY(self, option = ES.mOption) : return self.vPoint(option)[1]

    def json(self, option = ES.mOption): 
        val = self.vPoint(option)
        if option[&#34;json_loc_name&#34;] and self.name != ES.nullName :
            if val != ES.nullCoor: return json.dumps({self.name : val})
            else : return self.name
        else : return json.dumps(val)

    def to_bytes(self):
        return struct.pack(&#39;&lt;ll&#39;,round(self.point[0]*10**7), round(self.point[1]*10**7))
        
    def from_bytes(self, byt):
        pt = list(struct.unpack(&#39;&lt;ll&#39;, byt[0:8]))
        self.init(list((pt[0] *10**-7, pt[1] *10**-7)))
        return 8

class PropertyValue(ESValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    #nullName    = ES.prp_nullName
    valName     = ES.prp_valName
    valueType   = ES.prp_valueType
    
    def __init__(self, val={}):
        ESValue.__init__(self)
        self.name           = ES.nullName
        self.pType          = &#34;null&#34;
        self.unit           = &#34;null&#34;
        self.sampling       = &#34;null&#34;
        self.application    = &#34;null&#34;
        self.period         = 0
        self.interval       = 0
        self.uncertain      = 0
        self.EMFId          = &#34;null&#34;
        self.detail         = dict()
        self.init(val)
    
    def init(self, val={}):
        if type(val) == dict :
            for k, v in val.items():
                if   ES.prp_propType == k : self.pType       = v
                elif ES.prp_unit     == k : self.unit        = v
                elif ES.prp_sampling == k : self.sampling    = v
                elif ES.prp_appli    == k : self.application = v
                elif ES.prp_period   == k : self.period      = v
                elif ES.prp_interval == k : self.interval    = v
                elif ES.prp_uncertain== k : self.uncertain   = v
                elif ES.prp_EMFId    == k : self.EMFId       = v
                else : self.detail[k] = v
        elif type(val) == str : self.name = val

    def __eq__(self, other): return self.pType == other.pType and \
        self.unit == other.unit and self.sampling == other.sampling and \
        self.application == other.application and self.EMFId == other.EMFId and \
        self.detail == other.detail and self.name == other.name
        #or (self.name[0:3] == self.nullName and other.name[0:3] == self.nullName)))

    def __repr__(self): return self.json(ES.mOption)

    def __lt__(self, other): 
        return self.pType + self.name &lt; other.pType + other.name

    def json(self, option = ES.mOption): 
        li = dict()
        if (self.pType != &#34;null&#34;):   li[ES.prp_propType] = self.pType
        if not option[&#34;json_prp_type&#34;] : 
            if (self.unit != &#34;null&#34;):           li[ES.prp_unit]     = self.unit
            if (self.sampling != &#34;null&#34;):       li[ES.prp_sampling] = self.sampling
            if (self.application != &#34;null&#34;):    li[ES.prp_appli]    = self.application
            if (self.period != 0):              li[ES.prp_period]   = self.period
            if (self.interval != 0):            li[ES.prp_interval] = self.interval
            if (self.uncertain != 0):           li[ES.prp_uncertain]= self.uncertain
            if (self.EMFId != &#34;null&#34;):          li[ES.prp_EMFId]    = self.EMFId
            li |= self.detail
        if option[&#34;json_prp_name&#34;] and self.name != ES.nullName : 
            if li == {} : return self.name
            else : li[ES.prp_name] = self.name 
        return json.dumps(li, ensure_ascii=False)

    def to_bytes(self):
        byt = struct.pack(&#39;&lt;BBBLLB&#39;, ES.prop[self.pType][0], 
                           ES.sampling[self.sampling],
                           ES.application[self.application],
                           self.period,
                           self.interval,
                           self.uncertain * 2
                           )
        return byt[0:6] +byt[7:10] + byt[11:12]
        
    def from_bytes(self, byt):
        bytl = byt[0:6] + b&#39;\x00&#39; +byt[6:9] + b&#39;\x00&#39; + byt[9:10]
        prp = struct.unpack(&#39;&lt;BBBLLB&#39;, bytl)
        self.pType      = ES.cnum[prp[0]]
        self.unit       = ES.prop[ES.cnum[prp[0]]][5]
        self.sampling   = ES.invSampling[prp[1]]
        self.application = ES.invApplication[prp[2]]
        self.period     = prp[3]
        self.interval   = prp[4]
        self.uncertain  = prp[5] // 2
        return 10

class ResultValue (ESIndexValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    valName     = ES.res_valName
    valueType   = ES.res_valueType

    def __init__(self, val = None, ind = ES.nullInd):
        ESIndexValue.__init__(self, ind)
        ESValue.__init__(self)
        #self.value = &#39;null&#39; 
        self.init(val, ind)
        
        
    def init(self, val = None, ind = ES.nullInd):
        if type(val) == str : 
            try: js=json.loads(val)
            except:
                self.setValue(val)
                return
            if (type(js) == list and ind != ES.nullInd): self.setValue(json.dumps(js))
            elif (type(js) == list and ind == ES.nullInd): 
                if type(js[1]) == list: self.setIndValue(js)
                else: self.setValue(json.dumps(js))
            elif (type(js) == float or type(js) == int): self.setValue(js)
            else : self.setValue(json.dumps(js))
        elif type(val) == list : self.setIndValue(val)
        elif type(val) == ResultValue : 
            self.value = val.value
            self.ind = val.ind
        elif (type(val) == float or type(val) == int): self.setValue(val)
        else : self.setValue(json.dumps(val))
        if type(ind) == list and ind != ES.nullInd and self.ind == ES.nullInd : self.ind = ind

    def __eq__(self, other): return self.value == other.value

    def __lt__(self, other):         
        o = ES.mOption[&#34;sort_order&#34;]
        return self.ind[o[0]] &lt; other.ind[o[0]] or \
              (self.ind[o[0]] == other.ind[o[0]] and self.ind[o[1]] &lt;  other.ind[o[1]]) or \
              (self.ind[o[0]] == other.ind[o[0]] and self.ind[o[1]] == other.ind[o[1]] and self.ind[o[2]] &lt; other.ind[o[2]])

    #def __repr__(self): return object.__repr__(self) + &#39;\n&#39; + self.json()
    def __repr__(self): return  self.json(ES.mOption)

    def setIndValue(self, val):
        if (type(val) == list) : 
            self.setValue(val[0])
            self.ind = val[1]
        else : self.value = None

    def setValue(self, val):
        if (type(val) in [str, int, float]) : self.value = val
        else : self.value = json.dumps(val)

    def json(self, option = ES.mOption): 
        if (type(self.value) == str and json.dumps(self.value)[1:-1]!=self.value):
            if option[&#34;json_res_index&#34;]: return &#39;[&#39; + self.value + &#39;, &#39; + json.dumps(self.ind) + &#39;]&#39;
            else: return self.value
        else:
            if option[&#34;json_res_index&#34;] : return json.dumps([self.value, self.ind])
            else: return json.dumps(self.value)
    
    def to_bytes(self, resIndex = False, prp = &#34;null&#34;):
        formaPrp = ES.prop[prp][1]
        dexp = ES.prop[prp][3]
        bexp = ES.prop[prp][4]
        val = self.value * 10**-dexp * 2**-bexp
        if resIndex : return struct.pack(&#39;&lt;BBB&#39; + formaPrp,  self.ind[0],
                                         self.ind[1], self.ind[2], val)
        else : return struct.pack(&#39;&lt;&#39; + formaPrp, val)
        
    def from_bytes(self, byt, resInd = False, prp = &#34;null&#34;):
        formaPrp = ES.prop[prp][1]
        leng = ES.prop[prp][2]
        dexp = ES.prop[prp][3]
        bexp = ES.prop[prp][4]        
        if resInd :
            dt = struct.unpack(&#39;&lt;BBB&#39;+ formaPrp, byt[0:leng + 3])
            self.init(dt[3] * 10**dexp * 2**bexp, [dt[0], dt[1], dt[2]])
            return 3 + leng
        else :
            self.init(struct.unpack(&#39;&lt;&#39;+ formaPrp, byt[0:leng])[0] * 10**dexp * 2**bexp)
            return leng

    def to_float(self):
        if self.value == None :         return float(&#39;nan&#39;)
        elif type(self.value)==str:
            if self.value == &#39;null&#39;:    return float(&#39;nan&#39;)
            else : 
                try:                    return float(self.value)
                except:                 return float(&#39;nan&#39;)
        else :                          return float(self.value)           

ValueCod = [ None, LocationValue, DatationValue, PropertyValue, 
            LocationValue, DatationValue, PropertyValue]
    
class ESSet:
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;

    def __init__(self, ValueClass = None, jObj = None):
        if ValueClass == None: return
        self.valueList = list()
        self.iSort = list()
        self.nValue = 0
        if  type(jObj) == list :
            try :
                for val in jObj : self.addValue(ValueClass, val)
            except : self.addValue(ValueClass, jObj)
        elif jObj == None : return 
        else : self.addValue(ValueClass, jObj)

    def initESSet(self, ValueClass, jObj):
        if type(jObj) == dict:
            userAtt = False
            jDat = jObj.copy()
            for k, v in jDat.items():   # si mot-clef ESobs
                if k == self.classES: 
                    jDat = v
                    userAtt = True
            for k, v in jDat.items(): # attributs
                if isESAtt(self.classES, k) or (userAtt and isUserAtt(k)): self.mAtt[k] = v
            for vName in ValueClass.valName:   # valeurs
                if vName in list(jDat): ESSet.__init__(self, ValueClass, jDat[vName])
        elif type(jObj) == ValueClass or jObj == None: 
            ESSet.__init__(self, ValueClass, jObj)
    
    @property
    def vListName(self):
        return [self.valueList[i].vName(ES.vName[self.classES] + str(i)) for i in range(self.nValue)]

    def vList(self, func=identity):
        return [func(self.valueList[i]) for i in range(self.nValue)]
        
    def majListName(self, listName):
        for i in range(self.nValue) : self.valueList[i].majName(listName[min(i,len(listName))])

    def majListValue(self, ValueClass, listVal, simple = True):
        for i in range(self.nValue) : self.valueList[i].majValue(ValueClass(listVal[min(i,len(listVal))]), simple)
        
    def addValue(self, ValueClass, value):
        if type(value) == ValueClass : val = value
        else: val = ValueClass(value)
        if ValueClass == ResultValue :
            if val.ind != ES.nullInd :
                for i in range(len(self.valueList)):
                    if self.valueList[i].ind == val.ind : return i                
            self.valueList.append(val)
        else :
            for i in range(len(self.valueList)):
                if self.valueList[i] == val and ES.mOption[&#34;unic_index&#34;]: return i
            self.valueList.append(val)
        self.nValue = len(self.valueList)
        return len(self.valueList) - 1

    def jsonESSet(self, ES_valName, option):
        try:
            if len(self.valueList) == 0: return &#34;&#34;
        except: return&#34;&#34;
        elt_type_nb = 0
        if option[&#34;json_elt_type&#34;] : elt_type_nb = min(2, self.nValue)
        js = &#34;&#34;
        if option[&#34;json_ESobs_class&#34;]: js = &#39;&#34;&#39; + self.classES + &#39;&#34;:{&#39;
        js += self.jsonAtt(elt_type_nb) 
        js += &#39;&#34;&#39; + ES_valName + &#39;&#34;:&#39; + self.jsonSet(option) + &#34;,&#34;
        if js[-1] == &#39;,&#39;: js = js[:-1]
        if option[&#34;json_ESobs_class&#34;]: js += &#39;}&#39; 
        return js

    def jsonSet(self, option) :
        if len(self.valueList) == 0 : return &#34;&#34;
        if len(self.valueList) == 1 : return self.valueList[0].json(option)
        li = list()
        for i in range(self.nValue): 
            try: li.append(json.loads(self.valueList[i].json(option)))
            except: li.append(self.valueList[i].json(option))    
        return json.dumps(li)

    def to_bytes(self, nameES = False, resIndex = False, forma = &#39;null&#39;, prpList = []):
        byt = bytes()
        offset = 3 * (not nameES)
        code_el = ES.codeb[self.classES] # type de ESobs
        if code_el &lt; 4 : code_ES = ES.codeb[self.mAtt[ES.type]] + offset # choix name ou value
        else : code_ES = ES.prop[forma][0]     
        if code_el == 4 and resIndex : code_el = 5
        unique = self.nValue == 1 
        oct1 = (code_el &lt;&lt; 5) | (unique &lt;&lt; 4) | code_ES
        byt += struct.pack(&#39;&lt;B&#39;, oct1)
        if not unique : byt += struct.pack(&#39;&lt;H&#39;, self.nValue)
        for i in range(self.nValue) :
            prp = forma
            if forma == &#39;null&#39; and prpList == [] : prp = &#34;null&#34;
            if (nameES and code_el &lt; 4) or (code_el &gt; 3 and forma == &#34;UTF-8&#34;) : 
                byt += self.valueList[i].to_strBytes()
            elif not nameES and code_el &lt; 4 : byt += self.valueList[i].to_bytes()
            elif code_el &lt; 6 : 
                #if forma == &#39;null&#39; and prpList != [] : prp = prpList[i]
                if forma == &#39;null&#39; and prpList != [] : prp = prpList[self.valueList[i].ind[2]]
                byt += self.valueList[i].to_bytes(resIndex, prp)
        return byt
    
    def from_bytes(self, byt, prpList = []):  #prplist complète si sans index
        code_ES =  byt[0] &amp; 0b00001111
        unique  = (byt[0] &amp; 0b00010000) &gt;&gt; 4
        code_el = (byt[0] &amp; 0b11100000) &gt;&gt; 5
        nameES = not(code_ES // 3)
        forma = &#39;null&#39;
        if code_el &gt; 3 : forma = ES.cnum[code_ES]
        resIndex = code_el == 5
        nVal = 1
        idx = 1
        n = 0
        if not unique : 
            nVal = struct.unpack(&#39;&lt;H&#39;,byt[1:3])[0]
            idx = 3
        for i in range(nVal):
            if   code_el &lt; 4 : esValue = ValueCod[code_ES]
            elif code_el &lt; 6 : esValue = ResultValue
            esVal = esValue()
            prp = forma
            if forma == &#39;null&#39; and prpList == [] : prp = &#34;null&#34;
            #if prpList == [] : prp = &#34;null&#34;
            if (nameES and code_el &lt; 4) or (code_el &gt; 3 and forma == &#34;utf-8&#34;) : 
                n = esVal.from_strBytes(byt[idx:])
            elif not nameES and code_el &lt; 4 : n = esVal.from_bytes(byt[idx:])
            elif code_el &lt; 6 and not resIndex: 
                if forma == &#39;null&#39; and prpList != [] : prp = prpList[i]
                n = esVal.from_bytes(byt[idx:], resIndex, prp)
            elif code_el &lt; 6 and resIndex : 
                nPrp = struct.unpack(&#39;&lt;BBB&#39;,byt[idx:idx+3])[2]
                if forma == &#39;null&#39; and prpList != [] : prp = prpList[nPrp]
                n = esVal.from_bytes(byt[idx:], resIndex, prp)
            self.addValue(esValue, esVal)
            idx += n
        return idx
        
    def __len__(self): 
        try: return len(self.valueList)
        except : return 0
    
    def __getitem__(self, key): return self.valueList[key]
    
    def __setitem__(self, key, value): self.valueList[key] = value

    def __repr__(self): return object.__repr__(self) + &#39;\n&#39; + self.jsonSet(ES.mOption) + &#39;\n&#39;

    def miniBox(self):
        if (len(self) &lt; 1): return None
        minimum = self.valueList[0]
        for val in self.valueList: minimum = ESValue.mini(val, minimum)
        return minimum;

    def maxiBox(self):
        if (len(self) &lt; 1): return None
        maximum = self.valueList[0]
        for val in self.valueList: maximum = ESValue.maxi(val, maximum)
        return maximum;

    def sort(self, order = [], update = True):
        if order == [] :
            listInd = sorted(list(zip(self.valueList, list(range(self.nValue)))))
            valueTri, indTri = zip(*listInd)
            if update : self.valueList = list(valueTri)
        else :
            if update : self.valueList = [self.valueList[order[i]] for i in range(len(self.valueList))]
            indTri = order
        return list(indTri)
        
&#39;&#39;&#39;class TimeSlot:
    def __init__(self, val= ES.nullDate):
        if   type(val) == DatationValue:
            self.slot1 = val.slot.slot1
            self.slot2 = val.slot.slot2
        elif type(val) == list:  
            self.slot1 = datetime.fromisoformat(val[0])
            self.slot2 = datetime.fromisoformat(val[1])
        elif type(val) == datetime: 
            self.slot1 = val
            self.slot2 = self.slot1
        elif type(val) == numpy.datetime64 :
            self.slot1 = pandas.Timestamp(val).to_pydatetime()
            self.slot2 = self.slot1                    
        elif type(val) == pandas._libs.tslibs.timestamps.Timestamp :
            self.slot1 = val.to_pydatetime()
            self.slot2 = self.slot1            
        elif type(val) == str: 
            try:
                self.slot1 = datetime.fromisoformat(val)
                self.slot2 = self.slot1
            except:
                try:
                    val2 = json.loads(val)
                    self.slot1 = datetime.fromisoformat(val2[0])
                    self.slot2 = datetime.fromisoformat(val2[1])
                except:
                    self.slot1= ES.nullDate
                    self.slot2 = self.slot1
        else: 
            self.slot1= ES.nullDate
            self.slot2 = self.slot1

    def __repr__(self): return object.__repr__(self) + &#39;\n&#39; + self.json()

    def __eq__(self, other): return self.slot1 == other.slot1 and self.slot2 == other.slot2

    def json(self): return json.dumps([self.slot1.isoformat(), self.slot2.isoformat()])
    @property
    def centroid(self): return self.slot1 + (self.slot2 - self.slot1) / 2&#39;&#39;&#39;

        </code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="ES.ESValue.gshape"><code class="name flex">
<span>def <span class="ident">gshape</span></span>(<span>coord)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def gshape(coord):
    if type(coord) == list:  coor = json.dumps(coord)
    elif type(coord) == str: coor = coord
    else: coor = coord.copy()
    for tpe in [&#34;Point&#34;, &#34;MultiPoint&#34;, &#34;Polygon&#34;, &#34;MultiPolygon&#34;]:
    #for tpe in [&#34;MultiPoint&#34;, &#34;Polygon&#34;, &#34;MultiPolygon&#34;]:
        try:
            s = shapely.geometry.shape(geojson.loads(&#39;{&#34;type&#34;:&#34;&#39; + tpe + &#39;&#34;,&#34;coordinates&#34;:&#39; + coor + &#39;}&#39;))
            return s
        except: s = None
    return s</code></pre>
</details>
</dd>
</dl>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="ES.ESValue.DatationValue"><code class="flex name class">
<span>class <span class="ident">DatationValue</span></span>
<span>(</span><span>val=datetime.datetime(1970, 1, 1, 0, 0))</span>
</code></dt>
<dd>
<div class="desc"><p>Classe liée à la structure interne</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class DatationValue(ESValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    #nullName    = ES.dat_nullName
    valName     = ES.dat_valName
    #valueName   = ES.dat_valueName
    valueType   = ES.dat_valueType

    def __init__(self, val = ES.nullDate):
        ESValue.__init__(self)
        self.slot = [ES.nullDate, ES.nullDate]
        self.instant = ES.nullDate
        self.init(val)
        
    def init(self, val = ES.nullDate):
        if type(val) == DatationValue :
            self.instant = val.instant
            self.slot = val.slot
            self.name = val.name
            return
        elif type(val) == dict :
            self.name, val = list(val.items())[0]   
        slot = self.initSlot(val)
        if slot == [ES.nullDate, ES.nullDate] : 
            if type(val) == str and self.name == ES.nullName : self.name = val
        elif slot[0] == slot[1] : self.instant = slot[0]
        else : self.slot = slot

    def initSlot(self, val= ES.nullDate):
        if   type(val) == DatationValue:  return val.slot
        elif type(val) == list: 
            if type(val[0]) == datetime : return val
            else : return [datetime.fromisoformat(str(val[0])), datetime.fromisoformat(str(val[1]))]
        elif type(val) == datetime: return [val, val]
        elif type(val) == numpy.datetime64 :
            sl = pandas.Timestamp(val).to_pydatetime()
            return [sl, sl]                    
        elif type(val) == pandas._libs.tslibs.timestamps.Timestamp :
            sl = val.to_pydatetime()
            return [sl, sl]                    
        elif type(val) == str: 
            try:
                sl = datetime.fromisoformat(val)
                slo = [sl, sl]
            except:
                try:
                    val2 = json.loads(val)
                    slo = [datetime.fromisoformat(val2[0]),
                           datetime.fromisoformat(val2[1])]
                except:
                    sl = ES.nullDate
                    slo = [sl, sl]
            return slo
        else: 
            sl = ES.nullDate
            return [sl, sl]
        
    def __lt__(self, other): 
        return self.instant &lt; other.instant
 
    def __eq__(self, other): 
        return self.instant == other.instant and self.slot == other.slot and self.name == other.name
        #or (self.name[0:3] == self.nullName and other.name[0:3] == self.nullName))

    def __repr__(self): return self.json()

    def getInstant(self) : return self.instant
    
    def getSlot(self) : return self.slot

    def vInstant(self, option = ES.mOption, string = False) : #string=False):  
        if self.slot != [ES.nullDate, ES.nullDate] : val = [self.slot[0], self.slot[1]]
        else: val =  self.instant
        if option[&#34;json_dat_instant&#34;]:
            if self.instant != ES.nullDate : val =  self.instant
            elif self.slot != [ES.nullDate, ES.nullDate] : 
                val =  (self.slot[0] + (self.slot[1] - self.slot[0]) / 2)
        if   string and type(val) == dict : return [val[0].isoformat(), val[1].isoformat()]
        elif string and type(val) != dict : return val.isoformat()
        else : return val

    def json(self, option = ES.mOption): 
        val = self.vInstant(option, string=True)
        if option[&#34;json_dat_name&#34;] and self.name != ES.nullName :
            if val != ES.nullDate.isoformat():  return json.dumps({self.name : val})
            else :                              return self.name
        else : 
            if type(val) == str :               return val
            else :                              return json.dumps(val)

    def to_bytes(self):
        return struct.pack(&#39;&lt;HBBBBB&#39;, self.instant.year, self.instant.month,
                           self.instant.day, self.instant.hour,
                           self.instant.minute, self.instant.second)
        
    def from_bytes(self, byt):
        dt = struct.unpack(&#39;&lt;HBBBBB&#39;, byt[0:7])
        self.init(datetime(dt[0], dt[1], dt[2], dt[3], dt[4], dt[5]))
        return 7</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ES.ESValue.ESValue" href="#ES.ESValue.ESValue">ESValue</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ES.ESValue.DatationValue.valName"><code class="name">var <span class="ident">valName</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ES.ESValue.DatationValue.valueType"><code class="name">var <span class="ident">valueType</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ES.ESValue.DatationValue.from_bytes"><code class="name flex">
<span>def <span class="ident">from_bytes</span></span>(<span>self, byt)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def from_bytes(self, byt):
    dt = struct.unpack(&#39;&lt;HBBBBB&#39;, byt[0:7])
    self.init(datetime(dt[0], dt[1], dt[2], dt[3], dt[4], dt[5]))
    return 7</code></pre>
</details>
</dd>
<dt id="ES.ESValue.DatationValue.getInstant"><code class="name flex">
<span>def <span class="ident">getInstant</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getInstant(self) : return self.instant</code></pre>
</details>
</dd>
<dt id="ES.ESValue.DatationValue.getSlot"><code class="name flex">
<span>def <span class="ident">getSlot</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getSlot(self) : return self.slot</code></pre>
</details>
</dd>
<dt id="ES.ESValue.DatationValue.init"><code class="name flex">
<span>def <span class="ident">init</span></span>(<span>self, val=datetime.datetime(1970, 1, 1, 0, 0))</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init(self, val = ES.nullDate):
    if type(val) == DatationValue :
        self.instant = val.instant
        self.slot = val.slot
        self.name = val.name
        return
    elif type(val) == dict :
        self.name, val = list(val.items())[0]   
    slot = self.initSlot(val)
    if slot == [ES.nullDate, ES.nullDate] : 
        if type(val) == str and self.name == ES.nullName : self.name = val
    elif slot[0] == slot[1] : self.instant = slot[0]
    else : self.slot = slot</code></pre>
</details>
</dd>
<dt id="ES.ESValue.DatationValue.initSlot"><code class="name flex">
<span>def <span class="ident">initSlot</span></span>(<span>self, val=datetime.datetime(1970, 1, 1, 0, 0))</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def initSlot(self, val= ES.nullDate):
    if   type(val) == DatationValue:  return val.slot
    elif type(val) == list: 
        if type(val[0]) == datetime : return val
        else : return [datetime.fromisoformat(str(val[0])), datetime.fromisoformat(str(val[1]))]
    elif type(val) == datetime: return [val, val]
    elif type(val) == numpy.datetime64 :
        sl = pandas.Timestamp(val).to_pydatetime()
        return [sl, sl]                    
    elif type(val) == pandas._libs.tslibs.timestamps.Timestamp :
        sl = val.to_pydatetime()
        return [sl, sl]                    
    elif type(val) == str: 
        try:
            sl = datetime.fromisoformat(val)
            slo = [sl, sl]
        except:
            try:
                val2 = json.loads(val)
                slo = [datetime.fromisoformat(val2[0]),
                       datetime.fromisoformat(val2[1])]
            except:
                sl = ES.nullDate
                slo = [sl, sl]
        return slo
    else: 
        sl = ES.nullDate
        return [sl, sl]</code></pre>
</details>
</dd>
<dt id="ES.ESValue.DatationValue.json"><code class="name flex">
<span>def <span class="ident">json</span></span>(<span>self, option={'json_res_index': False, 'json_prp_type': True, 'json_prp_name': False, 'json_dat_instant': True, 'json_dat_name': False, 'json_loc_point': True, 'json_loc_name': False, 'json_ESobs_class': False, 'json_elt_type': False, 'json_obs_val': True, 'json_obs_attrib': False, 'json_param': False, 'json_info_type': True, 'json_info_nval': True, 'json_info_box': True, 'json_info_autre': True, 'unic_index': True, 'bytes_res_format': 'null', 'maj_reset_index': False, 'sort_order': [0, 1, 2]})</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def json(self, option = ES.mOption): 
    val = self.vInstant(option, string=True)
    if option[&#34;json_dat_name&#34;] and self.name != ES.nullName :
        if val != ES.nullDate.isoformat():  return json.dumps({self.name : val})
        else :                              return self.name
    else : 
        if type(val) == str :               return val
        else :                              return json.dumps(val)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.DatationValue.to_bytes"><code class="name flex">
<span>def <span class="ident">to_bytes</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_bytes(self):
    return struct.pack(&#39;&lt;HBBBBB&#39;, self.instant.year, self.instant.month,
                       self.instant.day, self.instant.hour,
                       self.instant.minute, self.instant.second)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.DatationValue.vInstant"><code class="name flex">
<span>def <span class="ident">vInstant</span></span>(<span>self, option={'json_res_index': False, 'json_prp_type': True, 'json_prp_name': False, 'json_dat_instant': True, 'json_dat_name': False, 'json_loc_point': True, 'json_loc_name': False, 'json_ESobs_class': False, 'json_elt_type': False, 'json_obs_val': True, 'json_obs_attrib': False, 'json_param': False, 'json_info_type': True, 'json_info_nval': True, 'json_info_box': True, 'json_info_autre': True, 'unic_index': True, 'bytes_res_format': 'null', 'maj_reset_index': False, 'sort_order': [0, 1, 2]}, string=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def vInstant(self, option = ES.mOption, string = False) : #string=False):  
    if self.slot != [ES.nullDate, ES.nullDate] : val = [self.slot[0], self.slot[1]]
    else: val =  self.instant
    if option[&#34;json_dat_instant&#34;]:
        if self.instant != ES.nullDate : val =  self.instant
        elif self.slot != [ES.nullDate, ES.nullDate] : 
            val =  (self.slot[0] + (self.slot[1] - self.slot[0]) / 2)
    if   string and type(val) == dict : return [val[0].isoformat(), val[1].isoformat()]
    elif string and type(val) != dict : return val.isoformat()
    else : return val</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="ES.ESValue.ESIndexValue"><code class="flex name class">
<span>class <span class="ident">ESIndexValue</span></span>
<span>(</span><span>ind)</span>
</code></dt>
<dd>
<div class="desc"><p>Classe liée à la structure interne</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ESIndexValue(ESValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    def __init__(self, ind):
        self.ind = ind</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ES.ESValue.ESValue" href="#ES.ESValue.ESValue">ESValue</a></li>
</ul>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ES.ESValue.ResultValue" href="#ES.ESValue.ResultValue">ResultValue</a></li>
</ul>
</dd>
<dt id="ES.ESValue.ESSet"><code class="flex name class">
<span>class <span class="ident">ESSet</span></span>
<span>(</span><span>ValueClass=None, jObj=None)</span>
</code></dt>
<dd>
<div class="desc"><p>Classe liée à la structure interne</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ESSet:
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;

    def __init__(self, ValueClass = None, jObj = None):
        if ValueClass == None: return
        self.valueList = list()
        self.iSort = list()
        self.nValue = 0
        if  type(jObj) == list :
            try :
                for val in jObj : self.addValue(ValueClass, val)
            except : self.addValue(ValueClass, jObj)
        elif jObj == None : return 
        else : self.addValue(ValueClass, jObj)

    def initESSet(self, ValueClass, jObj):
        if type(jObj) == dict:
            userAtt = False
            jDat = jObj.copy()
            for k, v in jDat.items():   # si mot-clef ESobs
                if k == self.classES: 
                    jDat = v
                    userAtt = True
            for k, v in jDat.items(): # attributs
                if isESAtt(self.classES, k) or (userAtt and isUserAtt(k)): self.mAtt[k] = v
            for vName in ValueClass.valName:   # valeurs
                if vName in list(jDat): ESSet.__init__(self, ValueClass, jDat[vName])
        elif type(jObj) == ValueClass or jObj == None: 
            ESSet.__init__(self, ValueClass, jObj)
    
    @property
    def vListName(self):
        return [self.valueList[i].vName(ES.vName[self.classES] + str(i)) for i in range(self.nValue)]

    def vList(self, func=identity):
        return [func(self.valueList[i]) for i in range(self.nValue)]
        
    def majListName(self, listName):
        for i in range(self.nValue) : self.valueList[i].majName(listName[min(i,len(listName))])

    def majListValue(self, ValueClass, listVal, simple = True):
        for i in range(self.nValue) : self.valueList[i].majValue(ValueClass(listVal[min(i,len(listVal))]), simple)
        
    def addValue(self, ValueClass, value):
        if type(value) == ValueClass : val = value
        else: val = ValueClass(value)
        if ValueClass == ResultValue :
            if val.ind != ES.nullInd :
                for i in range(len(self.valueList)):
                    if self.valueList[i].ind == val.ind : return i                
            self.valueList.append(val)
        else :
            for i in range(len(self.valueList)):
                if self.valueList[i] == val and ES.mOption[&#34;unic_index&#34;]: return i
            self.valueList.append(val)
        self.nValue = len(self.valueList)
        return len(self.valueList) - 1

    def jsonESSet(self, ES_valName, option):
        try:
            if len(self.valueList) == 0: return &#34;&#34;
        except: return&#34;&#34;
        elt_type_nb = 0
        if option[&#34;json_elt_type&#34;] : elt_type_nb = min(2, self.nValue)
        js = &#34;&#34;
        if option[&#34;json_ESobs_class&#34;]: js = &#39;&#34;&#39; + self.classES + &#39;&#34;:{&#39;
        js += self.jsonAtt(elt_type_nb) 
        js += &#39;&#34;&#39; + ES_valName + &#39;&#34;:&#39; + self.jsonSet(option) + &#34;,&#34;
        if js[-1] == &#39;,&#39;: js = js[:-1]
        if option[&#34;json_ESobs_class&#34;]: js += &#39;}&#39; 
        return js

    def jsonSet(self, option) :
        if len(self.valueList) == 0 : return &#34;&#34;
        if len(self.valueList) == 1 : return self.valueList[0].json(option)
        li = list()
        for i in range(self.nValue): 
            try: li.append(json.loads(self.valueList[i].json(option)))
            except: li.append(self.valueList[i].json(option))    
        return json.dumps(li)

    def to_bytes(self, nameES = False, resIndex = False, forma = &#39;null&#39;, prpList = []):
        byt = bytes()
        offset = 3 * (not nameES)
        code_el = ES.codeb[self.classES] # type de ESobs
        if code_el &lt; 4 : code_ES = ES.codeb[self.mAtt[ES.type]] + offset # choix name ou value
        else : code_ES = ES.prop[forma][0]     
        if code_el == 4 and resIndex : code_el = 5
        unique = self.nValue == 1 
        oct1 = (code_el &lt;&lt; 5) | (unique &lt;&lt; 4) | code_ES
        byt += struct.pack(&#39;&lt;B&#39;, oct1)
        if not unique : byt += struct.pack(&#39;&lt;H&#39;, self.nValue)
        for i in range(self.nValue) :
            prp = forma
            if forma == &#39;null&#39; and prpList == [] : prp = &#34;null&#34;
            if (nameES and code_el &lt; 4) or (code_el &gt; 3 and forma == &#34;UTF-8&#34;) : 
                byt += self.valueList[i].to_strBytes()
            elif not nameES and code_el &lt; 4 : byt += self.valueList[i].to_bytes()
            elif code_el &lt; 6 : 
                #if forma == &#39;null&#39; and prpList != [] : prp = prpList[i]
                if forma == &#39;null&#39; and prpList != [] : prp = prpList[self.valueList[i].ind[2]]
                byt += self.valueList[i].to_bytes(resIndex, prp)
        return byt
    
    def from_bytes(self, byt, prpList = []):  #prplist complète si sans index
        code_ES =  byt[0] &amp; 0b00001111
        unique  = (byt[0] &amp; 0b00010000) &gt;&gt; 4
        code_el = (byt[0] &amp; 0b11100000) &gt;&gt; 5
        nameES = not(code_ES // 3)
        forma = &#39;null&#39;
        if code_el &gt; 3 : forma = ES.cnum[code_ES]
        resIndex = code_el == 5
        nVal = 1
        idx = 1
        n = 0
        if not unique : 
            nVal = struct.unpack(&#39;&lt;H&#39;,byt[1:3])[0]
            idx = 3
        for i in range(nVal):
            if   code_el &lt; 4 : esValue = ValueCod[code_ES]
            elif code_el &lt; 6 : esValue = ResultValue
            esVal = esValue()
            prp = forma
            if forma == &#39;null&#39; and prpList == [] : prp = &#34;null&#34;
            #if prpList == [] : prp = &#34;null&#34;
            if (nameES and code_el &lt; 4) or (code_el &gt; 3 and forma == &#34;utf-8&#34;) : 
                n = esVal.from_strBytes(byt[idx:])
            elif not nameES and code_el &lt; 4 : n = esVal.from_bytes(byt[idx:])
            elif code_el &lt; 6 and not resIndex: 
                if forma == &#39;null&#39; and prpList != [] : prp = prpList[i]
                n = esVal.from_bytes(byt[idx:], resIndex, prp)
            elif code_el &lt; 6 and resIndex : 
                nPrp = struct.unpack(&#39;&lt;BBB&#39;,byt[idx:idx+3])[2]
                if forma == &#39;null&#39; and prpList != [] : prp = prpList[nPrp]
                n = esVal.from_bytes(byt[idx:], resIndex, prp)
            self.addValue(esValue, esVal)
            idx += n
        return idx
        
    def __len__(self): 
        try: return len(self.valueList)
        except : return 0
    
    def __getitem__(self, key): return self.valueList[key]
    
    def __setitem__(self, key, value): self.valueList[key] = value

    def __repr__(self): return object.__repr__(self) + &#39;\n&#39; + self.jsonSet(ES.mOption) + &#39;\n&#39;

    def miniBox(self):
        if (len(self) &lt; 1): return None
        minimum = self.valueList[0]
        for val in self.valueList: minimum = ESValue.mini(val, minimum)
        return minimum;

    def maxiBox(self):
        if (len(self) &lt; 1): return None
        maximum = self.valueList[0]
        for val in self.valueList: maximum = ESValue.maxi(val, maximum)
        return maximum;

    def sort(self, order = [], update = True):
        if order == [] :
            listInd = sorted(list(zip(self.valueList, list(range(self.nValue)))))
            valueTri, indTri = zip(*listInd)
            if update : self.valueList = list(valueTri)
        else :
            if update : self.valueList = [self.valueList[order[i]] for i in range(len(self.valueList))]
            indTri = order
        return list(indTri)</code></pre>
</details>
<h3>Instance variables</h3>
<dl>
<dt id="ES.ESValue.ESSet.vListName"><code class="name">var <span class="ident">vListName</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def vListName(self):
    return [self.valueList[i].vName(ES.vName[self.classES] + str(i)) for i in range(self.nValue)]</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ES.ESValue.ESSet.addValue"><code class="name flex">
<span>def <span class="ident">addValue</span></span>(<span>self, ValueClass, value)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def addValue(self, ValueClass, value):
    if type(value) == ValueClass : val = value
    else: val = ValueClass(value)
    if ValueClass == ResultValue :
        if val.ind != ES.nullInd :
            for i in range(len(self.valueList)):
                if self.valueList[i].ind == val.ind : return i                
        self.valueList.append(val)
    else :
        for i in range(len(self.valueList)):
            if self.valueList[i] == val and ES.mOption[&#34;unic_index&#34;]: return i
        self.valueList.append(val)
    self.nValue = len(self.valueList)
    return len(self.valueList) - 1</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.from_bytes"><code class="name flex">
<span>def <span class="ident">from_bytes</span></span>(<span>self, byt, prpList=[])</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def from_bytes(self, byt, prpList = []):  #prplist complète si sans index
    code_ES =  byt[0] &amp; 0b00001111
    unique  = (byt[0] &amp; 0b00010000) &gt;&gt; 4
    code_el = (byt[0] &amp; 0b11100000) &gt;&gt; 5
    nameES = not(code_ES // 3)
    forma = &#39;null&#39;
    if code_el &gt; 3 : forma = ES.cnum[code_ES]
    resIndex = code_el == 5
    nVal = 1
    idx = 1
    n = 0
    if not unique : 
        nVal = struct.unpack(&#39;&lt;H&#39;,byt[1:3])[0]
        idx = 3
    for i in range(nVal):
        if   code_el &lt; 4 : esValue = ValueCod[code_ES]
        elif code_el &lt; 6 : esValue = ResultValue
        esVal = esValue()
        prp = forma
        if forma == &#39;null&#39; and prpList == [] : prp = &#34;null&#34;
        #if prpList == [] : prp = &#34;null&#34;
        if (nameES and code_el &lt; 4) or (code_el &gt; 3 and forma == &#34;utf-8&#34;) : 
            n = esVal.from_strBytes(byt[idx:])
        elif not nameES and code_el &lt; 4 : n = esVal.from_bytes(byt[idx:])
        elif code_el &lt; 6 and not resIndex: 
            if forma == &#39;null&#39; and prpList != [] : prp = prpList[i]
            n = esVal.from_bytes(byt[idx:], resIndex, prp)
        elif code_el &lt; 6 and resIndex : 
            nPrp = struct.unpack(&#39;&lt;BBB&#39;,byt[idx:idx+3])[2]
            if forma == &#39;null&#39; and prpList != [] : prp = prpList[nPrp]
            n = esVal.from_bytes(byt[idx:], resIndex, prp)
        self.addValue(esValue, esVal)
        idx += n
    return idx</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.initESSet"><code class="name flex">
<span>def <span class="ident">initESSet</span></span>(<span>self, ValueClass, jObj)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def initESSet(self, ValueClass, jObj):
    if type(jObj) == dict:
        userAtt = False
        jDat = jObj.copy()
        for k, v in jDat.items():   # si mot-clef ESobs
            if k == self.classES: 
                jDat = v
                userAtt = True
        for k, v in jDat.items(): # attributs
            if isESAtt(self.classES, k) or (userAtt and isUserAtt(k)): self.mAtt[k] = v
        for vName in ValueClass.valName:   # valeurs
            if vName in list(jDat): ESSet.__init__(self, ValueClass, jDat[vName])
    elif type(jObj) == ValueClass or jObj == None: 
        ESSet.__init__(self, ValueClass, jObj)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.jsonESSet"><code class="name flex">
<span>def <span class="ident">jsonESSet</span></span>(<span>self, ES_valName, option)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def jsonESSet(self, ES_valName, option):
    try:
        if len(self.valueList) == 0: return &#34;&#34;
    except: return&#34;&#34;
    elt_type_nb = 0
    if option[&#34;json_elt_type&#34;] : elt_type_nb = min(2, self.nValue)
    js = &#34;&#34;
    if option[&#34;json_ESobs_class&#34;]: js = &#39;&#34;&#39; + self.classES + &#39;&#34;:{&#39;
    js += self.jsonAtt(elt_type_nb) 
    js += &#39;&#34;&#39; + ES_valName + &#39;&#34;:&#39; + self.jsonSet(option) + &#34;,&#34;
    if js[-1] == &#39;,&#39;: js = js[:-1]
    if option[&#34;json_ESobs_class&#34;]: js += &#39;}&#39; 
    return js</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.jsonSet"><code class="name flex">
<span>def <span class="ident">jsonSet</span></span>(<span>self, option)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def jsonSet(self, option) :
    if len(self.valueList) == 0 : return &#34;&#34;
    if len(self.valueList) == 1 : return self.valueList[0].json(option)
    li = list()
    for i in range(self.nValue): 
        try: li.append(json.loads(self.valueList[i].json(option)))
        except: li.append(self.valueList[i].json(option))    
    return json.dumps(li)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.majListName"><code class="name flex">
<span>def <span class="ident">majListName</span></span>(<span>self, listName)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def majListName(self, listName):
    for i in range(self.nValue) : self.valueList[i].majName(listName[min(i,len(listName))])</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.majListValue"><code class="name flex">
<span>def <span class="ident">majListValue</span></span>(<span>self, ValueClass, listVal, simple=True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def majListValue(self, ValueClass, listVal, simple = True):
    for i in range(self.nValue) : self.valueList[i].majValue(ValueClass(listVal[min(i,len(listVal))]), simple)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.maxiBox"><code class="name flex">
<span>def <span class="ident">maxiBox</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def maxiBox(self):
    if (len(self) &lt; 1): return None
    maximum = self.valueList[0]
    for val in self.valueList: maximum = ESValue.maxi(val, maximum)
    return maximum;</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.miniBox"><code class="name flex">
<span>def <span class="ident">miniBox</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def miniBox(self):
    if (len(self) &lt; 1): return None
    minimum = self.valueList[0]
    for val in self.valueList: minimum = ESValue.mini(val, minimum)
    return minimum;</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.sort"><code class="name flex">
<span>def <span class="ident">sort</span></span>(<span>self, order=[], update=True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def sort(self, order = [], update = True):
    if order == [] :
        listInd = sorted(list(zip(self.valueList, list(range(self.nValue)))))
        valueTri, indTri = zip(*listInd)
        if update : self.valueList = list(valueTri)
    else :
        if update : self.valueList = [self.valueList[order[i]] for i in range(len(self.valueList))]
        indTri = order
    return list(indTri)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.to_bytes"><code class="name flex">
<span>def <span class="ident">to_bytes</span></span>(<span>self, nameES=False, resIndex=False, forma='null', prpList=[])</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_bytes(self, nameES = False, resIndex = False, forma = &#39;null&#39;, prpList = []):
    byt = bytes()
    offset = 3 * (not nameES)
    code_el = ES.codeb[self.classES] # type de ESobs
    if code_el &lt; 4 : code_ES = ES.codeb[self.mAtt[ES.type]] + offset # choix name ou value
    else : code_ES = ES.prop[forma][0]     
    if code_el == 4 and resIndex : code_el = 5
    unique = self.nValue == 1 
    oct1 = (code_el &lt;&lt; 5) | (unique &lt;&lt; 4) | code_ES
    byt += struct.pack(&#39;&lt;B&#39;, oct1)
    if not unique : byt += struct.pack(&#39;&lt;H&#39;, self.nValue)
    for i in range(self.nValue) :
        prp = forma
        if forma == &#39;null&#39; and prpList == [] : prp = &#34;null&#34;
        if (nameES and code_el &lt; 4) or (code_el &gt; 3 and forma == &#34;UTF-8&#34;) : 
            byt += self.valueList[i].to_strBytes()
        elif not nameES and code_el &lt; 4 : byt += self.valueList[i].to_bytes()
        elif code_el &lt; 6 : 
            #if forma == &#39;null&#39; and prpList != [] : prp = prpList[i]
            if forma == &#39;null&#39; and prpList != [] : prp = prpList[self.valueList[i].ind[2]]
            byt += self.valueList[i].to_bytes(resIndex, prp)
    return byt</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESSet.vList"><code class="name flex">
<span>def <span class="ident">vList</span></span>(<span>self, func=&lt;function identity&gt;)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def vList(self, func=identity):
    return [func(self.valueList[i]) for i in range(self.nValue)]</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="ES.ESValue.ESValue"><code class="flex name class">
<span>class <span class="ident">ESValue</span></span>
</code></dt>
<dd>
<div class="desc"><p>This class is the parent class for each kind of values
(<code><a title="ES.ESValue.DatationValue" href="#ES.ESValue.DatationValue">DatationValue</a></code>, <code><a title="ES.ESValue.LocationValue" href="#ES.ESValue.LocationValue">LocationValue</a></code>, <code><a title="ES.ESValue.PropertyValue" href="#ES.ESValue.PropertyValue">PropertyValue</a></code>,
<code><a title="ES.ESValue.ResultValue" href="#ES.ESValue.ResultValue">ResultValue</a></code>,</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ESValue:
    &#34;&#34;&#34;
    This class is the parent class for each kind of values 
     (`ES.ESValue.DatationValue`, `ES.ESValue.LocationValue`, `ES.ESValue.PropertyValue`,
      `ES.ESValue.ResultValue`,
    &#34;&#34;&#34;
    def mini(x, y):
        if type(x) == LocationValue: mm = LocationValue([min(x.point[0], y.point[0]), min(x.point[1], y.point[1])])
        elif type(x) == DatationValue: mm = DatationValue(min(x.instant, y.instant))
        else : mm = x
        return mm

    def maxi(x, y):
        if type(x) == LocationValue:
            mm = LocationValue([max(x.point[0], y.point[0]), max(x.point[1], y.point[1])])
        elif type(x) == DatationValue: mm = DatationValue(max(x.instant, y.instant))  
        else : mm = x
        return mm
    
    def __init__(self):
        self.name = ES.nullName

    def vName(self, genName=ES.nullName):  
        if self.name == ES.nullName : return genName
        else : return self.name
    
    def majName(self, nam):
        name = str(nam)
        #☺if type(name) != str : name = str(name)
        if name != &#39;&#39; : self.name = name

    def majValue(self, val, simple = True):
        if type(val) == LocationValue :
            if not simple and val.shap != None and val.shap != gshape(ES.nullCoor) : 
                self.shap = val.shap
                self.point = [self.shap.centroid.x, self.shap.centroid.y]
            if simple and val.point != ES.nullCoor : self.point = val.point
        elif type(val) == DatationValue :
            if not simple and val.slot != [ES.nullDate, ES.nullDate] : 
                self.slot = val.slot
                self.instant = self.slot[0] + (self.slot[1] - self.slot[0]) / 2
            if simple and val.instant != ES.nullDate : self.instant = val.instant

    def to_strBytes(self, simple = False):
        bval = str.encode(self.name)
        if simple : return str.encode(self.name)
        else : return struct.pack(&#39;&gt;B&#39;,bval.__len__()) + bval
        
    def from_strBytes(self, byt, simple = False):
        if simple : 
            siz = byt.__len__()
            name = bytes.decode(byt)
        else : 
            siz = struct.unpack(&#39;&gt;B&#39;, byt[0:1])[0]
            name = bytes.decode(byt[1: siz + 1])
        self.init(name)
        return siz + 1</code></pre>
</details>
<h3>Subclasses</h3>
<ul class="hlist">
<li><a title="ES.ESValue.DatationValue" href="#ES.ESValue.DatationValue">DatationValue</a></li>
<li><a title="ES.ESValue.ESIndexValue" href="#ES.ESValue.ESIndexValue">ESIndexValue</a></li>
<li><a title="ES.ESValue.LocationValue" href="#ES.ESValue.LocationValue">LocationValue</a></li>
<li><a title="ES.ESValue.PropertyValue" href="#ES.ESValue.PropertyValue">PropertyValue</a></li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="ES.ESValue.ESValue.from_strBytes"><code class="name flex">
<span>def <span class="ident">from_strBytes</span></span>(<span>self, byt, simple=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def from_strBytes(self, byt, simple = False):
    if simple : 
        siz = byt.__len__()
        name = bytes.decode(byt)
    else : 
        siz = struct.unpack(&#39;&gt;B&#39;, byt[0:1])[0]
        name = bytes.decode(byt[1: siz + 1])
    self.init(name)
    return siz + 1</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESValue.majName"><code class="name flex">
<span>def <span class="ident">majName</span></span>(<span>self, nam)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def majName(self, nam):
    name = str(nam)
    #☺if type(name) != str : name = str(name)
    if name != &#39;&#39; : self.name = name</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESValue.majValue"><code class="name flex">
<span>def <span class="ident">majValue</span></span>(<span>self, val, simple=True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def majValue(self, val, simple = True):
    if type(val) == LocationValue :
        if not simple and val.shap != None and val.shap != gshape(ES.nullCoor) : 
            self.shap = val.shap
            self.point = [self.shap.centroid.x, self.shap.centroid.y]
        if simple and val.point != ES.nullCoor : self.point = val.point
    elif type(val) == DatationValue :
        if not simple and val.slot != [ES.nullDate, ES.nullDate] : 
            self.slot = val.slot
            self.instant = self.slot[0] + (self.slot[1] - self.slot[0]) / 2
        if simple and val.instant != ES.nullDate : self.instant = val.instant</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESValue.maxi"><code class="name flex">
<span>def <span class="ident">maxi</span></span>(<span>x, y)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def maxi(x, y):
    if type(x) == LocationValue:
        mm = LocationValue([max(x.point[0], y.point[0]), max(x.point[1], y.point[1])])
    elif type(x) == DatationValue: mm = DatationValue(max(x.instant, y.instant))  
    else : mm = x
    return mm</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESValue.mini"><code class="name flex">
<span>def <span class="ident">mini</span></span>(<span>x, y)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def mini(x, y):
    if type(x) == LocationValue: mm = LocationValue([min(x.point[0], y.point[0]), min(x.point[1], y.point[1])])
    elif type(x) == DatationValue: mm = DatationValue(min(x.instant, y.instant))
    else : mm = x
    return mm</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESValue.to_strBytes"><code class="name flex">
<span>def <span class="ident">to_strBytes</span></span>(<span>self, simple=False)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_strBytes(self, simple = False):
    bval = str.encode(self.name)
    if simple : return str.encode(self.name)
    else : return struct.pack(&#39;&gt;B&#39;,bval.__len__()) + bval</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ESValue.vName"><code class="name flex">
<span>def <span class="ident">vName</span></span>(<span>self, genName='')</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def vName(self, genName=ES.nullName):  
    if self.name == ES.nullName : return genName
    else : return self.name</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="ES.ESValue.LocationValue"><code class="flex name class">
<span>class <span class="ident">LocationValue</span></span>
<span>(</span><span>val=[-1, -1], geo=True, cart=True)</span>
</code></dt>
<dd>
<div class="desc"><p>Classe liée à la structure interne</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class LocationValue(ESValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    #nullName    = ES.nullName
    valName     = ES.loc_valName
    valueType   = ES.loc_valueType

    def __init__(self, val=ES.nullCoor, geo=True, cart=True):
        ESValue.__init__(self)
        self.point = ES.nullCoor
        self.shap = None
        self.geod = geo
        self.carto = cart
        self.init(val)
    
    def init(self, val=ES.nullCoor):
        if type(val) == LocationValue :
            self.shap = val.shap
            self.point = val.point
            self.name = val.name
            self.geod = val.geod
            self.carto = val.carto
            return
        elif type(val) == dict :
            self.name, val = list(val.items())[0]   
        shap = gshape(val)
        if shap == None :
            if type(val) == str and self.name == ES.nullName : self.name = val
        elif type(shap) == shapely.geometry.point.Point : self.point = [shap.x, shap.y]
        else : self.shap = shap
        #self.shap = gshape(val)
        #self.point = ES.nullCoor
        #if self.shap != None: self.point = [self.shap.centroid.x, self.shap.centroid.y]
        #elif type(val) == str and self.name == ES.nullName : self.name = val

    def __eq__(self, other): return self.point == other.point and self.geod == other.geod \
        and self.carto == other.carto and self.shap == other.shap and self.name == other.name
        #or (self.name[0:3] == self.nullName and other.name[0:3] == self.nullName))

    #def __repr__(self): return object.__repr__(self) + &#39;\n&#39; + self.json()
    def __repr__(self): return self.json()

    def __lt__(self, other): 
        return distance.distance(self.coorInv, mDistRef) &lt;  distance.distance(other.coorInv, mDistRef)
    
    @property
    def coorInv(self):  return [self.vPoint()[1], self.vPoint()[0]]
    
    def getShap(self) : return self.shap
    
    def getPoint(self) : return self.point
    
    def vPoint(self, option = ES.mOption):  
        val = ES.nullCoor
        if self.shap != None :              val =  self.shap.__geo_interface__[ES.coordinates]
        else:                               val =  self.point
        if option[&#34;json_loc_point&#34;]:
            if self.point != ES.nullCoor :  val =  self.point
            elif self.shap != None :        val = [self.shap.centroid.x, self.shap.centroid.y]
        return val

    def vPointX(self, option = ES.mOption) : return self.vPoint(option)[0]
    def vPointY(self, option = ES.mOption) : return self.vPoint(option)[1]

    def json(self, option = ES.mOption): 
        val = self.vPoint(option)
        if option[&#34;json_loc_name&#34;] and self.name != ES.nullName :
            if val != ES.nullCoor: return json.dumps({self.name : val})
            else : return self.name
        else : return json.dumps(val)

    def to_bytes(self):
        return struct.pack(&#39;&lt;ll&#39;,round(self.point[0]*10**7), round(self.point[1]*10**7))
        
    def from_bytes(self, byt):
        pt = list(struct.unpack(&#39;&lt;ll&#39;, byt[0:8]))
        self.init(list((pt[0] *10**-7, pt[1] *10**-7)))
        return 8</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ES.ESValue.ESValue" href="#ES.ESValue.ESValue">ESValue</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ES.ESValue.LocationValue.valName"><code class="name">var <span class="ident">valName</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ES.ESValue.LocationValue.valueType"><code class="name">var <span class="ident">valueType</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="ES.ESValue.LocationValue.coorInv"><code class="name">var <span class="ident">coorInv</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def coorInv(self):  return [self.vPoint()[1], self.vPoint()[0]]</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ES.ESValue.LocationValue.from_bytes"><code class="name flex">
<span>def <span class="ident">from_bytes</span></span>(<span>self, byt)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def from_bytes(self, byt):
    pt = list(struct.unpack(&#39;&lt;ll&#39;, byt[0:8]))
    self.init(list((pt[0] *10**-7, pt[1] *10**-7)))
    return 8</code></pre>
</details>
</dd>
<dt id="ES.ESValue.LocationValue.getPoint"><code class="name flex">
<span>def <span class="ident">getPoint</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getPoint(self) : return self.point</code></pre>
</details>
</dd>
<dt id="ES.ESValue.LocationValue.getShap"><code class="name flex">
<span>def <span class="ident">getShap</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getShap(self) : return self.shap</code></pre>
</details>
</dd>
<dt id="ES.ESValue.LocationValue.init"><code class="name flex">
<span>def <span class="ident">init</span></span>(<span>self, val=[-1, -1])</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init(self, val=ES.nullCoor):
    if type(val) == LocationValue :
        self.shap = val.shap
        self.point = val.point
        self.name = val.name
        self.geod = val.geod
        self.carto = val.carto
        return
    elif type(val) == dict :
        self.name, val = list(val.items())[0]   
    shap = gshape(val)
    if shap == None :
        if type(val) == str and self.name == ES.nullName : self.name = val
    elif type(shap) == shapely.geometry.point.Point : self.point = [shap.x, shap.y]
    else : self.shap = shap
    #self.shap = gshape(val)
    #self.point = ES.nullCoor
    #if self.shap != None: self.point = [self.shap.centroid.x, self.shap.centroid.y]
    #elif type(val) == str and self.name == ES.nullName : self.name = val</code></pre>
</details>
</dd>
<dt id="ES.ESValue.LocationValue.json"><code class="name flex">
<span>def <span class="ident">json</span></span>(<span>self, option={'json_res_index': False, 'json_prp_type': True, 'json_prp_name': False, 'json_dat_instant': True, 'json_dat_name': False, 'json_loc_point': True, 'json_loc_name': False, 'json_ESobs_class': False, 'json_elt_type': False, 'json_obs_val': True, 'json_obs_attrib': False, 'json_param': False, 'json_info_type': True, 'json_info_nval': True, 'json_info_box': True, 'json_info_autre': True, 'unic_index': True, 'bytes_res_format': 'null', 'maj_reset_index': False, 'sort_order': [0, 1, 2]})</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def json(self, option = ES.mOption): 
    val = self.vPoint(option)
    if option[&#34;json_loc_name&#34;] and self.name != ES.nullName :
        if val != ES.nullCoor: return json.dumps({self.name : val})
        else : return self.name
    else : return json.dumps(val)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.LocationValue.to_bytes"><code class="name flex">
<span>def <span class="ident">to_bytes</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_bytes(self):
    return struct.pack(&#39;&lt;ll&#39;,round(self.point[0]*10**7), round(self.point[1]*10**7))</code></pre>
</details>
</dd>
<dt id="ES.ESValue.LocationValue.vPoint"><code class="name flex">
<span>def <span class="ident">vPoint</span></span>(<span>self, option={'json_res_index': False, 'json_prp_type': True, 'json_prp_name': False, 'json_dat_instant': True, 'json_dat_name': False, 'json_loc_point': True, 'json_loc_name': False, 'json_ESobs_class': False, 'json_elt_type': False, 'json_obs_val': True, 'json_obs_attrib': False, 'json_param': False, 'json_info_type': True, 'json_info_nval': True, 'json_info_box': True, 'json_info_autre': True, 'unic_index': True, 'bytes_res_format': 'null', 'maj_reset_index': False, 'sort_order': [0, 1, 2]})</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def vPoint(self, option = ES.mOption):  
    val = ES.nullCoor
    if self.shap != None :              val =  self.shap.__geo_interface__[ES.coordinates]
    else:                               val =  self.point
    if option[&#34;json_loc_point&#34;]:
        if self.point != ES.nullCoor :  val =  self.point
        elif self.shap != None :        val = [self.shap.centroid.x, self.shap.centroid.y]
    return val</code></pre>
</details>
</dd>
<dt id="ES.ESValue.LocationValue.vPointX"><code class="name flex">
<span>def <span class="ident">vPointX</span></span>(<span>self, option={'json_res_index': False, 'json_prp_type': True, 'json_prp_name': False, 'json_dat_instant': True, 'json_dat_name': False, 'json_loc_point': True, 'json_loc_name': False, 'json_ESobs_class': False, 'json_elt_type': False, 'json_obs_val': True, 'json_obs_attrib': False, 'json_param': False, 'json_info_type': True, 'json_info_nval': True, 'json_info_box': True, 'json_info_autre': True, 'unic_index': True, 'bytes_res_format': 'null', 'maj_reset_index': False, 'sort_order': [0, 1, 2]})</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def vPointX(self, option = ES.mOption) : return self.vPoint(option)[0]</code></pre>
</details>
</dd>
<dt id="ES.ESValue.LocationValue.vPointY"><code class="name flex">
<span>def <span class="ident">vPointY</span></span>(<span>self, option={'json_res_index': False, 'json_prp_type': True, 'json_prp_name': False, 'json_dat_instant': True, 'json_dat_name': False, 'json_loc_point': True, 'json_loc_name': False, 'json_ESobs_class': False, 'json_elt_type': False, 'json_obs_val': True, 'json_obs_attrib': False, 'json_param': False, 'json_info_type': True, 'json_info_nval': True, 'json_info_box': True, 'json_info_autre': True, 'unic_index': True, 'bytes_res_format': 'null', 'maj_reset_index': False, 'sort_order': [0, 1, 2]})</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def vPointY(self, option = ES.mOption) : return self.vPoint(option)[1]</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="ES.ESValue.PropertyValue"><code class="flex name class">
<span>class <span class="ident">PropertyValue</span></span>
<span>(</span><span>val={})</span>
</code></dt>
<dd>
<div class="desc"><p>Classe liée à la structure interne</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class PropertyValue(ESValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    #nullName    = ES.prp_nullName
    valName     = ES.prp_valName
    valueType   = ES.prp_valueType
    
    def __init__(self, val={}):
        ESValue.__init__(self)
        self.name           = ES.nullName
        self.pType          = &#34;null&#34;
        self.unit           = &#34;null&#34;
        self.sampling       = &#34;null&#34;
        self.application    = &#34;null&#34;
        self.period         = 0
        self.interval       = 0
        self.uncertain      = 0
        self.EMFId          = &#34;null&#34;
        self.detail         = dict()
        self.init(val)
    
    def init(self, val={}):
        if type(val) == dict :
            for k, v in val.items():
                if   ES.prp_propType == k : self.pType       = v
                elif ES.prp_unit     == k : self.unit        = v
                elif ES.prp_sampling == k : self.sampling    = v
                elif ES.prp_appli    == k : self.application = v
                elif ES.prp_period   == k : self.period      = v
                elif ES.prp_interval == k : self.interval    = v
                elif ES.prp_uncertain== k : self.uncertain   = v
                elif ES.prp_EMFId    == k : self.EMFId       = v
                else : self.detail[k] = v
        elif type(val) == str : self.name = val

    def __eq__(self, other): return self.pType == other.pType and \
        self.unit == other.unit and self.sampling == other.sampling and \
        self.application == other.application and self.EMFId == other.EMFId and \
        self.detail == other.detail and self.name == other.name
        #or (self.name[0:3] == self.nullName and other.name[0:3] == self.nullName)))

    def __repr__(self): return self.json(ES.mOption)

    def __lt__(self, other): 
        return self.pType + self.name &lt; other.pType + other.name

    def json(self, option = ES.mOption): 
        li = dict()
        if (self.pType != &#34;null&#34;):   li[ES.prp_propType] = self.pType
        if not option[&#34;json_prp_type&#34;] : 
            if (self.unit != &#34;null&#34;):           li[ES.prp_unit]     = self.unit
            if (self.sampling != &#34;null&#34;):       li[ES.prp_sampling] = self.sampling
            if (self.application != &#34;null&#34;):    li[ES.prp_appli]    = self.application
            if (self.period != 0):              li[ES.prp_period]   = self.period
            if (self.interval != 0):            li[ES.prp_interval] = self.interval
            if (self.uncertain != 0):           li[ES.prp_uncertain]= self.uncertain
            if (self.EMFId != &#34;null&#34;):          li[ES.prp_EMFId]    = self.EMFId
            li |= self.detail
        if option[&#34;json_prp_name&#34;] and self.name != ES.nullName : 
            if li == {} : return self.name
            else : li[ES.prp_name] = self.name 
        return json.dumps(li, ensure_ascii=False)

    def to_bytes(self):
        byt = struct.pack(&#39;&lt;BBBLLB&#39;, ES.prop[self.pType][0], 
                           ES.sampling[self.sampling],
                           ES.application[self.application],
                           self.period,
                           self.interval,
                           self.uncertain * 2
                           )
        return byt[0:6] +byt[7:10] + byt[11:12]
        
    def from_bytes(self, byt):
        bytl = byt[0:6] + b&#39;\x00&#39; +byt[6:9] + b&#39;\x00&#39; + byt[9:10]
        prp = struct.unpack(&#39;&lt;BBBLLB&#39;, bytl)
        self.pType      = ES.cnum[prp[0]]
        self.unit       = ES.prop[ES.cnum[prp[0]]][5]
        self.sampling   = ES.invSampling[prp[1]]
        self.application = ES.invApplication[prp[2]]
        self.period     = prp[3]
        self.interval   = prp[4]
        self.uncertain  = prp[5] // 2
        return 10</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ES.ESValue.ESValue" href="#ES.ESValue.ESValue">ESValue</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ES.ESValue.PropertyValue.valName"><code class="name">var <span class="ident">valName</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ES.ESValue.PropertyValue.valueType"><code class="name">var <span class="ident">valueType</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ES.ESValue.PropertyValue.from_bytes"><code class="name flex">
<span>def <span class="ident">from_bytes</span></span>(<span>self, byt)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def from_bytes(self, byt):
    bytl = byt[0:6] + b&#39;\x00&#39; +byt[6:9] + b&#39;\x00&#39; + byt[9:10]
    prp = struct.unpack(&#39;&lt;BBBLLB&#39;, bytl)
    self.pType      = ES.cnum[prp[0]]
    self.unit       = ES.prop[ES.cnum[prp[0]]][5]
    self.sampling   = ES.invSampling[prp[1]]
    self.application = ES.invApplication[prp[2]]
    self.period     = prp[3]
    self.interval   = prp[4]
    self.uncertain  = prp[5] // 2
    return 10</code></pre>
</details>
</dd>
<dt id="ES.ESValue.PropertyValue.init"><code class="name flex">
<span>def <span class="ident">init</span></span>(<span>self, val={})</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init(self, val={}):
    if type(val) == dict :
        for k, v in val.items():
            if   ES.prp_propType == k : self.pType       = v
            elif ES.prp_unit     == k : self.unit        = v
            elif ES.prp_sampling == k : self.sampling    = v
            elif ES.prp_appli    == k : self.application = v
            elif ES.prp_period   == k : self.period      = v
            elif ES.prp_interval == k : self.interval    = v
            elif ES.prp_uncertain== k : self.uncertain   = v
            elif ES.prp_EMFId    == k : self.EMFId       = v
            else : self.detail[k] = v
    elif type(val) == str : self.name = val</code></pre>
</details>
</dd>
<dt id="ES.ESValue.PropertyValue.json"><code class="name flex">
<span>def <span class="ident">json</span></span>(<span>self, option={'json_res_index': False, 'json_prp_type': True, 'json_prp_name': False, 'json_dat_instant': True, 'json_dat_name': False, 'json_loc_point': True, 'json_loc_name': False, 'json_ESobs_class': False, 'json_elt_type': False, 'json_obs_val': True, 'json_obs_attrib': False, 'json_param': False, 'json_info_type': True, 'json_info_nval': True, 'json_info_box': True, 'json_info_autre': True, 'unic_index': True, 'bytes_res_format': 'null', 'maj_reset_index': False, 'sort_order': [0, 1, 2]})</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def json(self, option = ES.mOption): 
    li = dict()
    if (self.pType != &#34;null&#34;):   li[ES.prp_propType] = self.pType
    if not option[&#34;json_prp_type&#34;] : 
        if (self.unit != &#34;null&#34;):           li[ES.prp_unit]     = self.unit
        if (self.sampling != &#34;null&#34;):       li[ES.prp_sampling] = self.sampling
        if (self.application != &#34;null&#34;):    li[ES.prp_appli]    = self.application
        if (self.period != 0):              li[ES.prp_period]   = self.period
        if (self.interval != 0):            li[ES.prp_interval] = self.interval
        if (self.uncertain != 0):           li[ES.prp_uncertain]= self.uncertain
        if (self.EMFId != &#34;null&#34;):          li[ES.prp_EMFId]    = self.EMFId
        li |= self.detail
    if option[&#34;json_prp_name&#34;] and self.name != ES.nullName : 
        if li == {} : return self.name
        else : li[ES.prp_name] = self.name 
    return json.dumps(li, ensure_ascii=False)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.PropertyValue.to_bytes"><code class="name flex">
<span>def <span class="ident">to_bytes</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_bytes(self):
    byt = struct.pack(&#39;&lt;BBBLLB&#39;, ES.prop[self.pType][0], 
                       ES.sampling[self.sampling],
                       ES.application[self.application],
                       self.period,
                       self.interval,
                       self.uncertain * 2
                       )
    return byt[0:6] +byt[7:10] + byt[11:12]</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="ES.ESValue.ResultValue"><code class="flex name class">
<span>class <span class="ident">ResultValue</span></span>
<span>(</span><span>val=None, ind=[-1, -1, -1])</span>
</code></dt>
<dd>
<div class="desc"><p>Classe liée à la structure interne</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class ResultValue (ESIndexValue):
    &#34;&#34;&#34;
    Classe liée à la structure interne
    &#34;&#34;&#34;
    valName     = ES.res_valName
    valueType   = ES.res_valueType

    def __init__(self, val = None, ind = ES.nullInd):
        ESIndexValue.__init__(self, ind)
        ESValue.__init__(self)
        #self.value = &#39;null&#39; 
        self.init(val, ind)
        
        
    def init(self, val = None, ind = ES.nullInd):
        if type(val) == str : 
            try: js=json.loads(val)
            except:
                self.setValue(val)
                return
            if (type(js) == list and ind != ES.nullInd): self.setValue(json.dumps(js))
            elif (type(js) == list and ind == ES.nullInd): 
                if type(js[1]) == list: self.setIndValue(js)
                else: self.setValue(json.dumps(js))
            elif (type(js) == float or type(js) == int): self.setValue(js)
            else : self.setValue(json.dumps(js))
        elif type(val) == list : self.setIndValue(val)
        elif type(val) == ResultValue : 
            self.value = val.value
            self.ind = val.ind
        elif (type(val) == float or type(val) == int): self.setValue(val)
        else : self.setValue(json.dumps(val))
        if type(ind) == list and ind != ES.nullInd and self.ind == ES.nullInd : self.ind = ind

    def __eq__(self, other): return self.value == other.value

    def __lt__(self, other):         
        o = ES.mOption[&#34;sort_order&#34;]
        return self.ind[o[0]] &lt; other.ind[o[0]] or \
              (self.ind[o[0]] == other.ind[o[0]] and self.ind[o[1]] &lt;  other.ind[o[1]]) or \
              (self.ind[o[0]] == other.ind[o[0]] and self.ind[o[1]] == other.ind[o[1]] and self.ind[o[2]] &lt; other.ind[o[2]])

    #def __repr__(self): return object.__repr__(self) + &#39;\n&#39; + self.json()
    def __repr__(self): return  self.json(ES.mOption)

    def setIndValue(self, val):
        if (type(val) == list) : 
            self.setValue(val[0])
            self.ind = val[1]
        else : self.value = None

    def setValue(self, val):
        if (type(val) in [str, int, float]) : self.value = val
        else : self.value = json.dumps(val)

    def json(self, option = ES.mOption): 
        if (type(self.value) == str and json.dumps(self.value)[1:-1]!=self.value):
            if option[&#34;json_res_index&#34;]: return &#39;[&#39; + self.value + &#39;, &#39; + json.dumps(self.ind) + &#39;]&#39;
            else: return self.value
        else:
            if option[&#34;json_res_index&#34;] : return json.dumps([self.value, self.ind])
            else: return json.dumps(self.value)
    
    def to_bytes(self, resIndex = False, prp = &#34;null&#34;):
        formaPrp = ES.prop[prp][1]
        dexp = ES.prop[prp][3]
        bexp = ES.prop[prp][4]
        val = self.value * 10**-dexp * 2**-bexp
        if resIndex : return struct.pack(&#39;&lt;BBB&#39; + formaPrp,  self.ind[0],
                                         self.ind[1], self.ind[2], val)
        else : return struct.pack(&#39;&lt;&#39; + formaPrp, val)
        
    def from_bytes(self, byt, resInd = False, prp = &#34;null&#34;):
        formaPrp = ES.prop[prp][1]
        leng = ES.prop[prp][2]
        dexp = ES.prop[prp][3]
        bexp = ES.prop[prp][4]        
        if resInd :
            dt = struct.unpack(&#39;&lt;BBB&#39;+ formaPrp, byt[0:leng + 3])
            self.init(dt[3] * 10**dexp * 2**bexp, [dt[0], dt[1], dt[2]])
            return 3 + leng
        else :
            self.init(struct.unpack(&#39;&lt;&#39;+ formaPrp, byt[0:leng])[0] * 10**dexp * 2**bexp)
            return leng

    def to_float(self):
        if self.value == None :         return float(&#39;nan&#39;)
        elif type(self.value)==str:
            if self.value == &#39;null&#39;:    return float(&#39;nan&#39;)
            else : 
                try:                    return float(self.value)
                except:                 return float(&#39;nan&#39;)
        else :                          return float(self.value)           </code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li><a title="ES.ESValue.ESIndexValue" href="#ES.ESValue.ESIndexValue">ESIndexValue</a></li>
<li><a title="ES.ESValue.ESValue" href="#ES.ESValue.ESValue">ESValue</a></li>
</ul>
<h3>Class variables</h3>
<dl>
<dt id="ES.ESValue.ResultValue.valName"><code class="name">var <span class="ident">valName</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="ES.ESValue.ResultValue.valueType"><code class="name">var <span class="ident">valueType</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="ES.ESValue.ResultValue.from_bytes"><code class="name flex">
<span>def <span class="ident">from_bytes</span></span>(<span>self, byt, resInd=False, prp='null')</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def from_bytes(self, byt, resInd = False, prp = &#34;null&#34;):
    formaPrp = ES.prop[prp][1]
    leng = ES.prop[prp][2]
    dexp = ES.prop[prp][3]
    bexp = ES.prop[prp][4]        
    if resInd :
        dt = struct.unpack(&#39;&lt;BBB&#39;+ formaPrp, byt[0:leng + 3])
        self.init(dt[3] * 10**dexp * 2**bexp, [dt[0], dt[1], dt[2]])
        return 3 + leng
    else :
        self.init(struct.unpack(&#39;&lt;&#39;+ formaPrp, byt[0:leng])[0] * 10**dexp * 2**bexp)
        return leng</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ResultValue.init"><code class="name flex">
<span>def <span class="ident">init</span></span>(<span>self, val=None, ind=[-1, -1, -1])</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def init(self, val = None, ind = ES.nullInd):
    if type(val) == str : 
        try: js=json.loads(val)
        except:
            self.setValue(val)
            return
        if (type(js) == list and ind != ES.nullInd): self.setValue(json.dumps(js))
        elif (type(js) == list and ind == ES.nullInd): 
            if type(js[1]) == list: self.setIndValue(js)
            else: self.setValue(json.dumps(js))
        elif (type(js) == float or type(js) == int): self.setValue(js)
        else : self.setValue(json.dumps(js))
    elif type(val) == list : self.setIndValue(val)
    elif type(val) == ResultValue : 
        self.value = val.value
        self.ind = val.ind
    elif (type(val) == float or type(val) == int): self.setValue(val)
    else : self.setValue(json.dumps(val))
    if type(ind) == list and ind != ES.nullInd and self.ind == ES.nullInd : self.ind = ind</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ResultValue.json"><code class="name flex">
<span>def <span class="ident">json</span></span>(<span>self, option={'json_res_index': False, 'json_prp_type': True, 'json_prp_name': False, 'json_dat_instant': True, 'json_dat_name': False, 'json_loc_point': True, 'json_loc_name': False, 'json_ESobs_class': False, 'json_elt_type': False, 'json_obs_val': True, 'json_obs_attrib': False, 'json_param': False, 'json_info_type': True, 'json_info_nval': True, 'json_info_box': True, 'json_info_autre': True, 'unic_index': True, 'bytes_res_format': 'null', 'maj_reset_index': False, 'sort_order': [0, 1, 2]})</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def json(self, option = ES.mOption): 
    if (type(self.value) == str and json.dumps(self.value)[1:-1]!=self.value):
        if option[&#34;json_res_index&#34;]: return &#39;[&#39; + self.value + &#39;, &#39; + json.dumps(self.ind) + &#39;]&#39;
        else: return self.value
    else:
        if option[&#34;json_res_index&#34;] : return json.dumps([self.value, self.ind])
        else: return json.dumps(self.value)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ResultValue.setIndValue"><code class="name flex">
<span>def <span class="ident">setIndValue</span></span>(<span>self, val)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setIndValue(self, val):
    if (type(val) == list) : 
        self.setValue(val[0])
        self.ind = val[1]
    else : self.value = None</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ResultValue.setValue"><code class="name flex">
<span>def <span class="ident">setValue</span></span>(<span>self, val)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setValue(self, val):
    if (type(val) in [str, int, float]) : self.value = val
    else : self.value = json.dumps(val)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ResultValue.to_bytes"><code class="name flex">
<span>def <span class="ident">to_bytes</span></span>(<span>self, resIndex=False, prp='null')</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_bytes(self, resIndex = False, prp = &#34;null&#34;):
    formaPrp = ES.prop[prp][1]
    dexp = ES.prop[prp][3]
    bexp = ES.prop[prp][4]
    val = self.value * 10**-dexp * 2**-bexp
    if resIndex : return struct.pack(&#39;&lt;BBB&#39; + formaPrp,  self.ind[0],
                                     self.ind[1], self.ind[2], val)
    else : return struct.pack(&#39;&lt;&#39; + formaPrp, val)</code></pre>
</details>
</dd>
<dt id="ES.ESValue.ResultValue.to_float"><code class="name flex">
<span>def <span class="ident">to_float</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def to_float(self):
    if self.value == None :         return float(&#39;nan&#39;)
    elif type(self.value)==str:
        if self.value == &#39;null&#39;:    return float(&#39;nan&#39;)
        else : 
            try:                    return float(self.value)
            except:                 return float(&#39;nan&#39;)
    else :                          return float(self.value)           </code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="ES" href="index.html">ES</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="ES.ESValue.gshape" href="#ES.ESValue.gshape">gshape</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="ES.ESValue.DatationValue" href="#ES.ESValue.DatationValue">DatationValue</a></code></h4>
<ul class="two-column">
<li><code><a title="ES.ESValue.DatationValue.from_bytes" href="#ES.ESValue.DatationValue.from_bytes">from_bytes</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.getInstant" href="#ES.ESValue.DatationValue.getInstant">getInstant</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.getSlot" href="#ES.ESValue.DatationValue.getSlot">getSlot</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.init" href="#ES.ESValue.DatationValue.init">init</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.initSlot" href="#ES.ESValue.DatationValue.initSlot">initSlot</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.json" href="#ES.ESValue.DatationValue.json">json</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.to_bytes" href="#ES.ESValue.DatationValue.to_bytes">to_bytes</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.vInstant" href="#ES.ESValue.DatationValue.vInstant">vInstant</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.valName" href="#ES.ESValue.DatationValue.valName">valName</a></code></li>
<li><code><a title="ES.ESValue.DatationValue.valueType" href="#ES.ESValue.DatationValue.valueType">valueType</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ES.ESValue.ESIndexValue" href="#ES.ESValue.ESIndexValue">ESIndexValue</a></code></h4>
</li>
<li>
<h4><code><a title="ES.ESValue.ESSet" href="#ES.ESValue.ESSet">ESSet</a></code></h4>
<ul class="two-column">
<li><code><a title="ES.ESValue.ESSet.addValue" href="#ES.ESValue.ESSet.addValue">addValue</a></code></li>
<li><code><a title="ES.ESValue.ESSet.from_bytes" href="#ES.ESValue.ESSet.from_bytes">from_bytes</a></code></li>
<li><code><a title="ES.ESValue.ESSet.initESSet" href="#ES.ESValue.ESSet.initESSet">initESSet</a></code></li>
<li><code><a title="ES.ESValue.ESSet.jsonESSet" href="#ES.ESValue.ESSet.jsonESSet">jsonESSet</a></code></li>
<li><code><a title="ES.ESValue.ESSet.jsonSet" href="#ES.ESValue.ESSet.jsonSet">jsonSet</a></code></li>
<li><code><a title="ES.ESValue.ESSet.majListName" href="#ES.ESValue.ESSet.majListName">majListName</a></code></li>
<li><code><a title="ES.ESValue.ESSet.majListValue" href="#ES.ESValue.ESSet.majListValue">majListValue</a></code></li>
<li><code><a title="ES.ESValue.ESSet.maxiBox" href="#ES.ESValue.ESSet.maxiBox">maxiBox</a></code></li>
<li><code><a title="ES.ESValue.ESSet.miniBox" href="#ES.ESValue.ESSet.miniBox">miniBox</a></code></li>
<li><code><a title="ES.ESValue.ESSet.sort" href="#ES.ESValue.ESSet.sort">sort</a></code></li>
<li><code><a title="ES.ESValue.ESSet.to_bytes" href="#ES.ESValue.ESSet.to_bytes">to_bytes</a></code></li>
<li><code><a title="ES.ESValue.ESSet.vList" href="#ES.ESValue.ESSet.vList">vList</a></code></li>
<li><code><a title="ES.ESValue.ESSet.vListName" href="#ES.ESValue.ESSet.vListName">vListName</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ES.ESValue.ESValue" href="#ES.ESValue.ESValue">ESValue</a></code></h4>
<ul class="two-column">
<li><code><a title="ES.ESValue.ESValue.from_strBytes" href="#ES.ESValue.ESValue.from_strBytes">from_strBytes</a></code></li>
<li><code><a title="ES.ESValue.ESValue.majName" href="#ES.ESValue.ESValue.majName">majName</a></code></li>
<li><code><a title="ES.ESValue.ESValue.majValue" href="#ES.ESValue.ESValue.majValue">majValue</a></code></li>
<li><code><a title="ES.ESValue.ESValue.maxi" href="#ES.ESValue.ESValue.maxi">maxi</a></code></li>
<li><code><a title="ES.ESValue.ESValue.mini" href="#ES.ESValue.ESValue.mini">mini</a></code></li>
<li><code><a title="ES.ESValue.ESValue.to_strBytes" href="#ES.ESValue.ESValue.to_strBytes">to_strBytes</a></code></li>
<li><code><a title="ES.ESValue.ESValue.vName" href="#ES.ESValue.ESValue.vName">vName</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ES.ESValue.LocationValue" href="#ES.ESValue.LocationValue">LocationValue</a></code></h4>
<ul class="two-column">
<li><code><a title="ES.ESValue.LocationValue.coorInv" href="#ES.ESValue.LocationValue.coorInv">coorInv</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.from_bytes" href="#ES.ESValue.LocationValue.from_bytes">from_bytes</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.getPoint" href="#ES.ESValue.LocationValue.getPoint">getPoint</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.getShap" href="#ES.ESValue.LocationValue.getShap">getShap</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.init" href="#ES.ESValue.LocationValue.init">init</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.json" href="#ES.ESValue.LocationValue.json">json</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.to_bytes" href="#ES.ESValue.LocationValue.to_bytes">to_bytes</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.vPoint" href="#ES.ESValue.LocationValue.vPoint">vPoint</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.vPointX" href="#ES.ESValue.LocationValue.vPointX">vPointX</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.vPointY" href="#ES.ESValue.LocationValue.vPointY">vPointY</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.valName" href="#ES.ESValue.LocationValue.valName">valName</a></code></li>
<li><code><a title="ES.ESValue.LocationValue.valueType" href="#ES.ESValue.LocationValue.valueType">valueType</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ES.ESValue.PropertyValue" href="#ES.ESValue.PropertyValue">PropertyValue</a></code></h4>
<ul class="two-column">
<li><code><a title="ES.ESValue.PropertyValue.from_bytes" href="#ES.ESValue.PropertyValue.from_bytes">from_bytes</a></code></li>
<li><code><a title="ES.ESValue.PropertyValue.init" href="#ES.ESValue.PropertyValue.init">init</a></code></li>
<li><code><a title="ES.ESValue.PropertyValue.json" href="#ES.ESValue.PropertyValue.json">json</a></code></li>
<li><code><a title="ES.ESValue.PropertyValue.to_bytes" href="#ES.ESValue.PropertyValue.to_bytes">to_bytes</a></code></li>
<li><code><a title="ES.ESValue.PropertyValue.valName" href="#ES.ESValue.PropertyValue.valName">valName</a></code></li>
<li><code><a title="ES.ESValue.PropertyValue.valueType" href="#ES.ESValue.PropertyValue.valueType">valueType</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="ES.ESValue.ResultValue" href="#ES.ESValue.ResultValue">ResultValue</a></code></h4>
<ul class="two-column">
<li><code><a title="ES.ESValue.ResultValue.from_bytes" href="#ES.ESValue.ResultValue.from_bytes">from_bytes</a></code></li>
<li><code><a title="ES.ESValue.ResultValue.init" href="#ES.ESValue.ResultValue.init">init</a></code></li>
<li><code><a title="ES.ESValue.ResultValue.json" href="#ES.ESValue.ResultValue.json">json</a></code></li>
<li><code><a title="ES.ESValue.ResultValue.setIndValue" href="#ES.ESValue.ResultValue.setIndValue">setIndValue</a></code></li>
<li><code><a title="ES.ESValue.ResultValue.setValue" href="#ES.ESValue.ResultValue.setValue">setValue</a></code></li>
<li><code><a title="ES.ESValue.ResultValue.to_bytes" href="#ES.ESValue.ResultValue.to_bytes">to_bytes</a></code></li>
<li><code><a title="ES.ESValue.ResultValue.to_float" href="#ES.ESValue.ResultValue.to_float">to_float</a></code></li>
<li><code><a title="ES.ESValue.ResultValue.valName" href="#ES.ESValue.ResultValue.valName">valName</a></code></li>
<li><code><a title="ES.ESValue.ResultValue.valueType" href="#ES.ESValue.ResultValue.valueType">valueType</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.8.1</a>.</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad()</script>
</body>
</html>