<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 11.0.0"/>
    <title>ES.ESObservation API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(:first-of-type){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.pdoc details{filter:opacity(1);}.pdoc details:not([open]){height:0;}.pdoc details > summary{position:absolute;top:-35px;right:0;font-size:.75rem;color:var(--muted);padding:0 .7em;user-select:none;cursor:pointer;}.pdoc details > summary:focus{outline:0;}.pdoc > section:first-of-type details > summary{top:-20px;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc .headerlink{position:absolute;width:0;margin-left:-1.5rem;line-height:1.4rem;font-size:1.5rem;font-weight:normal;transition:all 100ms ease-in-out;opacity:0;user-select:none;}.pdoc .attr > .headerlink{margin-left:-2.5rem;}.pdoc *:hover > .headerlink,.pdoc *:target > .attr > .headerlink{opacity:1;}.pdoc .attr{display:block;color:var(--text);margin:.5rem 0 .5rem;padding:.4rem 5rem .4rem 1rem;background-color:var(--accent);}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{white-space:pre-wrap;}.pdoc .annotation{color:var(--annotation);}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../ES.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;ES</a>

            <img src="https://loco-philippe.github.io/ES/logo_loco.png" class="logo" alt="project logo"/>

            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



        <h2>API Documentation</h2>
            <ul class="memberlist">
            <li>
                    <a class="class" href="#Observation">Observation</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Observation.__init__">Observation</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.Ilist">Ilist</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.axes">axes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.bounds">bounds</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.complet">complet</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.consistent">consistent</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.dimension">dimension</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.json">json</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.jsonFeature">jsonFeature</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.nValueObs">nValueObs</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.rate">rate</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.score">score</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.setDatation">setDatation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.setLocation">setLocation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.setProperty">setProperty</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.setResult">setResult</a>
                        </li>
                        <li>
                                <a class="variable" href="#Observation.typeObs">typeObs</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.addAttributes">addAttributes</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.addJson">addJson</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.append">append</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.appendList">appendList</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.appendObs">appendObs</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.choropleth">choropleth</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.extend">extend</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.filter">filter</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.from_bytes">from_bytes</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.from_file">from_file</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.full">full</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.iLoc">iLoc</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.indexLoc">indexLoc</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.iObsIndex">iObsIndex</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.loc">loc</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.majList">majList</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.majValue">majValue</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.plot">plot</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.sort">sort</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.to_bytes">to_bytes</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.to_csv">to_csv</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.to_dataFrame">to_dataFrame</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.to_file">to_file</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.to_json">to_json</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.to_numpy">to_numpy</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.to_xarray">to_xarray</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.view">view</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.vList">vList</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.vListName">vListName</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.vListSimple">vListSimple</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.vListValue">vListValue</a>
                        </li>
                        <li>
                                <a class="function" href="#Observation.voxel">voxel</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ObservationError">ObservationError</a>
                            <ul class="memberlist">
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section>
                    <h1 class="modulename">
<a href="./../ES.html">ES</a><wbr>.ESObservation    </h1>

                        <div class="docstring"><p>Created on Tue Aug  3 23:40:06 2021</p>

<p>@author: philippe@loco-labs.io</p>

<p>An <code>ESObservation.Observation</code> is an object representing a set of information having
spatial and temporal characteristics associated with measurable or observable
 properties.</p>

<p>The Observation Object is built around three main bricks :</p>

<ul>
<li>Ilist Object which deal with indexing,</li>
<li>ESValue Object which integrate the specificities of environmental data,</li>
<li>Tools dedicated to particular domains (<a href="https://shapely.readthedocs.io/en/stable/manual.html">Shapely</a> 
for location, TimeSlot for Datation)</li>
</ul>

<p>The <code><a href="">ES.ESObservation</a></code> module contains the <code><a href="#Observation">Observation</a></code> class.</p>

<p>Documentation is available in other pages :</p>

<ul>
<li>The concept of 'observation' is describe in 
<a href="https://github.com/loco-philippe/Environmental-Sensing/wiki/Observation">this page</a>.</li>
<li>The concept of 'indexed list' is describe in 
<a href="https://github.com/loco-philippe/Environmental-Sensing/wiki/Indexed-list">this page</a>.</li>
<li>The non-regression test are at 
<a href="https://github.com/loco-philippe/Environmental-Sensing/blob/main/python/Tests/test_observation.py">this page</a></li>
<li>The <a href="https://github.com/loco-philippe/Environmental-Sensing/tree/main/python/Examples/Observation">examples</a></li>
</ul>
</div>

                        <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Tue Aug  3 23:40:06 2021</span>

<span class="sd">@author: philippe@loco-labs.io</span>

<span class="sd">An `ESObservation.Observation` is an object representing a set of information having</span>
<span class="sd">spatial and temporal characteristics associated with measurable or observable</span>
<span class="sd"> properties.</span>
<span class="sd"> </span>
<span class="sd">The Observation Object is built around three main bricks :</span>
<span class="sd">    </span>
<span class="sd">- Ilist Object which deal with indexing,</span>
<span class="sd">- ESValue Object which integrate the specificities of environmental data,</span>
<span class="sd">- Tools dedicated to particular domains ([Shapely](https://shapely.readthedocs.io/en/stable/manual.html) </span>
<span class="sd">for location, TimeSlot for Datation)</span>

<span class="sd">The `ES.ESObservation` module contains the `Observation` class.</span>

<span class="sd">Documentation is available in other pages :</span>

<span class="sd">- The concept of &#39;observation&#39; is describe in </span>
<span class="sd">[this page](https://github.com/loco-philippe/Environmental-Sensing/wiki/Observation).</span>
<span class="sd">- The concept of &#39;indexed list&#39; is describe in </span>
<span class="sd">[this page](https://github.com/loco-philippe/Environmental-Sensing/wiki/Indexed-list).</span>
<span class="sd">- The non-regression test are at </span>
<span class="sd">[this page](https://github.com/loco-philippe/Environmental-Sensing/blob/main/python/Tests/test_observation.py)</span>
<span class="sd">- The [examples](https://github.com/loco-philippe/Environmental-Sensing/tree/main/python/Examples/Observation)</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">ESconstante</span> <span class="kn">import</span> <span class="n">ES</span><span class="p">,</span> <span class="n">_classval</span>
<span class="c1">#import ESValue</span>
<span class="kn">from</span> <span class="nn">ESValue</span> <span class="kn">import</span> <span class="n">LocationValue</span><span class="p">,</span> <span class="n">DatationValue</span><span class="p">,</span> <span class="n">PropertyValue</span><span class="p">,</span> \
    <span class="n">NamedValue</span><span class="p">,</span> <span class="n">ExternValue</span><span class="p">,</span> <span class="n">ESValue</span><span class="p">,</span> <span class="n">ESValueEncoder</span>
<span class="kn">from</span> <span class="nn">timeslot</span> <span class="kn">import</span> <span class="n">TimeSlot</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">folium</span><span class="o">,</span> <span class="nn">copy</span><span class="o">,</span> <span class="nn">csv</span><span class="o">,</span> <span class="nn">bson</span><span class="o">,</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="c1">#import os</span>
<span class="c1">#os.chdir(&#39;C:/Users/a179227/OneDrive - Alliance/perso Wx/ES standard/python ESstandard/iList&#39;)</span>
<span class="kn">from</span> <span class="nn">ilist</span> <span class="kn">import</span> <span class="n">Ilist</span><span class="p">,</span> <span class="n">CborDecoder</span>
<span class="c1">#import ilist</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">cbor2</span>

<span class="c1">#from ESValue import _EsClassValue</span>

<span class="k">class</span> <span class="nc">Observation</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An `Observation` is made up of `ES.ilist` object which describe the axes of this object.</span>

<span class="sd">    *Attributes (for @property see methods)* :</span>

<span class="sd">    - **option** : Dictionnary with options</span>
<span class="sd">    - **ilist** : Ilist object (data and axes)</span>
<span class="sd">    - **name** : textual description</span>
<span class="sd">    - **mAtt** : namedValue dictionnary (internal parameters)</span>
<span class="sd">    - **parameter** : namedValue dictionnary (external data)</span>

<span class="sd">    The methods defined in this class are :</span>

<span class="sd">    *property (getters)*</span>

<span class="sd">    - `Observation.axes`</span>
<span class="sd">    - `Observation.bounds`</span>
<span class="sd">    - `Observation.complet`</span>
<span class="sd">    - `Observation.consistent`</span>
<span class="sd">    - `Observation.dimension`</span>
<span class="sd">    - `Observation.json`</span>
<span class="sd">    - `Observation.jsonFeature`</span>
<span class="sd">    - `Observation.nValueObs`</span>
<span class="sd">    - `Observation.rate`</span>
<span class="sd">    - `Observation.score`</span>
<span class="sd">    - `Observation.setDatation`</span>
<span class="sd">    - `Observation.setLocation`</span>
<span class="sd">    - `Observation.setProperty`</span>
<span class="sd">    - `Observation.setResult`</span>
<span class="sd">    - `Observation.typeObs`</span>

<span class="sd">    *getters*</span>

<span class="sd">    - `Observation.vList`</span>
<span class="sd">    - `Observation.vListName`</span>
<span class="sd">    - `Observation.vListSimple`</span>
<span class="sd">    - `Observation.vListValue`</span>

<span class="sd">    *add value*</span>

<span class="sd">    - `Observation.addAttributes`</span>
<span class="sd">    - `Observation.addJson`</span>
<span class="sd">    - `Observation.append`</span>
<span class="sd">    - `Observation.appendList`</span>
<span class="sd">    - `Observation.appendObs`</span>

<span class="sd">    *update value*</span>

<span class="sd">    - `Observation.majList`</span>
<span class="sd">    - `Observation.majValue`</span>

<span class="sd">    *selecting*</span>

<span class="sd">    - `Observation.indexLoc`</span>
<span class="sd">    - `Observation.iLoc`</span>
<span class="sd">    - `Observation.iObsIndex`</span>
<span class="sd">    - `Observation.loc`</span>

<span class="sd">    *management*</span>

<span class="sd">    - `Observation.extend`</span>
<span class="sd">    - `Observation.filter`</span>
<span class="sd">    - `Observation.full`</span>
<span class="sd">    - `Observation.sort`</span>

<span class="sd">    *visualization*</span>

<span class="sd">    - `Observation.choropleth`</span>
<span class="sd">    - `Observation.voxel`</span>
<span class="sd">    - `Observation.plot`</span>
<span class="sd">    - `Observation.view`</span>

<span class="sd">    *exports - imports*</span>

<span class="sd">    - `Observation.from_file`</span>
<span class="sd">    - `Observation.to_csv`</span>
<span class="sd">    - `Observation.to_dataFrame`</span>
<span class="sd">    - `Observation.to_json`</span>
<span class="sd">    - `Observation.to_numpy`</span>
<span class="sd">    - `Observation.to_file`</span>
<span class="sd">    - `Observation.to_xarray`</span>
<span class="sd">    - `Observation.to_bytes`              # à voir</span>
<span class="sd">    - `Observation.from_bytes`            # à voir</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="c1">#%% constructor</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">idxref</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Several Observation creation modes :</span>

<span class="sd">        - Observation(dictESValue1, dictESValue2, ...) where dictESValue = {ESValuename : value}</span>
<span class="sd">        - Observation({ObsDict}) where ObsDict is a dictionnary with the same data as an ObsJSON</span>
<span class="sd">        - Observation(ObsJSON) where ObsJSON is a string with the JSON format</span>
<span class="sd">        - Observation(ObsBSON) where ObsBSON is a bytes with the BSON format</span>
<span class="sd">        - Observation([ESSetDatation, ESSetLocation, ESSetProperty, ESSetResult]) where ESSet is a list of ESValue :</span>
<span class="sd">            [ESValue1, ESValue2,...] or [ESValue] or ESValue</span>
<span class="sd">        - Observation(datation=ESSetDatation, location=ESSetLocation,</span>
<span class="sd">                      property=ESSetProperty, result=ESSetResult)</span>

<span class="sd">        *Note : the parameters &#39;idxref&#39; and &#39;order&#39; are used only when an ESSetResult without Index is in arguments.</span>
<span class="sd">        &#39;order&#39; indicates the order for the Index creation and &#39;idxref&#39; the linked index (0 for Datation, 1 for Location, 2 for Property).*</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">kwargs</span> <span class="o">|=</span> <span class="p">{</span><span class="s1">&#39;order&#39;</span> <span class="p">:</span> <span class="n">order</span><span class="p">,</span> <span class="s1">&#39;idxref&#39;</span> <span class="p">:</span> <span class="n">idxref</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;observation du &quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">mOption</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>        <span class="c1"># json</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">Ilist</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#self.mAtt[ES.obs_reference] = 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullVal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_resultTime</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initObs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Ilist</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ilist</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mAtt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">obs</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">ilist</span> 
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">option</span> <span class="o">|=</span> <span class="n">option</span>
        <span class="k">if</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span> 
        <span class="k">if</span> <span class="n">mAtt</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">|=</span> <span class="n">mAtt</span>
        <span class="k">return</span> <span class="n">obs</span>
    
    <span class="k">def</span> <span class="nf">_initObs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; data creation &#39;&#39;&#39;</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">args</span> <span class="o">=</span> <span class="p">[{}]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span> <span class="p">:</span>       <span class="c1"># creation à partir d&#39;un json &quot;key : [liste]&quot;</span>
                <span class="k">try</span><span class="p">:</span> <span class="n">arg</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">object_hook</span><span class="o">=</span><span class="n">CborDecoder</span><span class="p">()</span><span class="o">.</span><span class="n">codecbor</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mh">0x00</span> <span class="ow">and</span> <span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b11100000</span><span class="p">)</span> <span class="o">==</span> <span class="mb">0b10100000</span><span class="p">:</span>
                    <span class="n">dic</span><span class="o">=</span><span class="n">cbor2</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">dic</span> <span class="o">=</span> <span class="n">bson</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span> <span class="p">:</span>      <span class="c1"># creation à partir d&#39;un dict &quot;key : [liste]&quot;</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span> <span class="p">:</span> <span class="n">dic</span> <span class="o">|=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_valName</span> <span class="p">:</span> <span class="n">dic</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_valName</span><span class="p">]</span> <span class="c1">#!!!</span>
        <span class="k">if</span> <span class="n">dic</span> <span class="o">!=</span> <span class="p">{}</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">args</span> <span class="o">==</span> <span class="p">[{}]</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span> <span class="p">:</span> <span class="n">dic</span> <span class="o">|=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initDict</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">:</span>    <span class="c1"># création à partir d&#39;un jeu de valeur [[dat], [loc], [prp], [res]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_initList</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span> <span class="p">:</span>   <span class="c1"># creation uniquement d&#39;un jeu de données dat, loc, prp, res</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">arg</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">arg</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_initDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39; data creation in dict mode&#39;&#39;&#39;</span>
        <span class="n">js</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">:</span> <span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">js</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_attributes</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_attributes</span><span class="p">])</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span> <span class="n">js</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_attributes</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">dicilist</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">order</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">classES</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">classES</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="p">:</span>
                <span class="n">dicilist</span><span class="p">[</span><span class="n">classES</span><span class="p">]</span> <span class="o">=</span>  <span class="n">js</span><span class="p">[</span><span class="n">classES</span><span class="p">]</span>
                <span class="n">order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classES</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">dicilist</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;order&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">js</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">dicilist</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">dicilist</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;idxref&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="p">:</span> <span class="n">dicilist</span><span class="p">[</span><span class="s1">&#39;idxref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="s1">&#39;idxref&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;index&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="p">:</span> <span class="n">dicilist</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">Ilist</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="n">dicilist</span><span class="p">)</span>
        <span class="n">ordern</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ordern</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">swapindex</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ordern</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_initList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;data creation in list mode &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;order&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="p">:</span> <span class="n">order</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;datation&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;property&#39;</span><span class="p">]</span>
        <span class="n">ordern</span> <span class="o">=</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">order</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;idxref&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="p">:</span> <span class="n">idxref</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;idxref&#39;</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">idxref</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">idxrefn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">idxref</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
            <span class="n">keyn</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">valn</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="n">idxrefn</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">keyn</span><span class="p">,</span> <span class="n">valn</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">keyn</span><span class="p">,</span> <span class="n">valn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">Ilist</span><span class="o">.</span><span class="n">Iset</span><span class="p">(</span><span class="n">valiidx</span><span class="o">=</span><span class="n">lis</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                <span class="n">setidx</span><span class="o">=</span><span class="p">[</span><span class="n">lis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lis</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> 
                                <span class="n">order</span><span class="o">=</span><span class="n">ordern</span><span class="p">,</span> <span class="n">idxref</span><span class="o">=</span><span class="n">idxrefn</span><span class="p">,</span> <span class="n">valname</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> 
                                <span class="n">idxname</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">defaultidx</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#%% special</span>
    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Copy all the data, included ESValue&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">__geo_interface__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;dict (@property) : return the union of geometry (see shapely)&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span>
            <span class="n">collec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vListValue</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">shap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vListValue</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span> <span class="p">:</span> <span class="n">collec</span> <span class="o">=</span> <span class="n">collec</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">shap</span><span class="p">)</span>
                <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">collec</span><span class="o">.</span><span class="n">__geo_interface__</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__ior__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s index to self&#39;s index&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">|=</span> <span class="n">other</span><span class="o">.</span><span class="n">ilist</span>
        <span class="n">newindex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nameES</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">swapindex</span><span class="p">(</span><span class="n">newindex</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s index to self&#39;s index and return a new Observation&#39;&#39;&#39;</span>
        <span class="n">obres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
        <span class="n">obres</span><span class="o">.</span><span class="fm">__ior__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obres</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; return ResValue item&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s values to self&#39;s values&#39;&#39;&#39;</span>
        <span class="c1">#self.ilist += other.ilist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iadd</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ilist</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">option</span><span class="p">[</span><span class="s2">&quot;unic_index&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s values to self&#39;s values and return a new Observation&#39;&#39;&#39;</span>
        <span class="n">obres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
        <span class="n">obres</span><span class="o">.</span><span class="fm">__iadd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obres</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>

    <span class="k">def</span> <span class="nf">__to_bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">option</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">],</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;bson&#39;</span><span class="p">,</span>
                            <span class="n">json_info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_res_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">json_param</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#%% properties</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list of integer (@property)** : list of independant axes in the Observation</span>
<span class="sd">        (0 for Datation, 1 for Location, 2 for Property)&#39;&#39;&#39;</span>
        <span class="n">axes</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">axes</span> <span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">axes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list of `ES.ESValue` (@property)** : `ES.ESValue` bounding box for each axis.&#39;&#39;&#39;</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="c1">#if self.setDatation : bound[0] = self._boundingBox(DatationValue, self.setDatation)</span>
        <span class="c1">#if self.setLocation : bound[1] = self._boundingBox(LocationValue, self.setLocation)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="p">:</span> <span class="n">bound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span> <span class="n">bound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="p">:</span> <span class="n">bound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">bound</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">complet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **boolean (@property)** : True if self.ilist is complete (if the number of </span>
<span class="sd">        values is consistent with the number of index values)&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">complete</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">consistent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **boolean (@property)** : True if Observation is consistent (no duplicate index) &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **integer (@property)** : number of independant axes in the Observation&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">dimension</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **string (@property)** : JSON Observation (ObsJSON format) whit index</span>
<span class="sd">        and whitout informations&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">,</span>
                            <span class="n">json_info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_res_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">json_param</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">jsonFeature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **string (@property)** : &quot;FeatureCollection&quot; with ESSetLocation geometry&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span>
            <span class="n">geo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geo_interface__</span>
            <span class="k">if</span> <span class="n">geo</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MultiPolygon&quot;</span><span class="p">:</span> <span class="n">typ</span> <span class="o">=</span> <span class="s2">&quot;Polygon&quot;</span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">typ</span> <span class="o">=</span> <span class="s2">&quot;Point&quot;</span>
            <span class="n">lis</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">typ</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;coordinates&quot;</span><span class="p">,</span> <span class="n">geo</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geo</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">])))</span>
            <span class="n">fea</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="s2">&quot;Feature&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geo</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">])))</span>
            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">,</span><span class="n">fea</span><span class="p">))),</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nValueObs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : lenght of axes [datation, location, properety, result].&#39;&#39;&#39;</span>
        <span class="n">nvalue</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">esclass</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span>
            <span class="n">nval</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">))</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">esclass</span> <span class="p">:</span> <span class="n">nval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">nvalue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nval</span><span class="p">)</span>
        <span class="n">nvalue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setvallen</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nvalue</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **float (@property)** : ratio number measure / number measure if complete&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">rate</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **integer (@property)** : Observation type (calculated from dimension , nValueObs and idxref).</span>
<span class="sd">        The score is a codification of the number of ESValue for each axis.</span>
<span class="sd">        E.g., score=122 means one PropertyValue (1), several LocationValue (2),</span>
<span class="sd">        several DatationValue (2)&#39;&#39;&#39;</span>
        <span class="p">[</span> <span class="n">nDat</span><span class="p">,</span> <span class="n">nLoc</span><span class="p">,</span> <span class="n">nPrp</span><span class="p">,</span> <span class="n">nRes</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span>
        <span class="n">score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">nPrp</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">nLoc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">nDat</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">229</span><span class="p">);</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span> <span class="n">score</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">22</span>  <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">23</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">122</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">123</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">202</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">203</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">212</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">213</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">220</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">223</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">221</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">224</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">222</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">228</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">222</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="mi">2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxref</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">225</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">222</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="mi">1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxref</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">226</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">222</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="mi">0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxref</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">227</span>
        <span class="k">return</span> <span class="n">score</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">setDatation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : list of values in the datation axis&#39;&#39;&#39;</span>
        <span class="k">try</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)]</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">setLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : list of values in the location axis&#39;&#39;&#39;</span>
        <span class="k">try</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)]</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">setProperty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : list of values in the property axis&#39;&#39;&#39;</span>
        <span class="k">try</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)]</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">setResult</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : list of values in the result axis&#39;&#39;&#39;</span>
        <span class="k">try</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">typeObs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **string (@property)** : Observation type (calculated from the score)&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ES</span><span class="o">.</span><span class="n">obsCat</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ES</span><span class="o">.</span><span class="n">obsCat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#%% methods</span>
    <span class="k">def</span> <span class="nf">addAttributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">js</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add informations attached to `Observation`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **js** : Dict - Keys are Observation keys (dict mAtt) or users keys (dict parameter).</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">dict</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">js</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">information</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_isESAtt</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">or</span>
                                                       <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">reserved</span><span class="p">)</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">parameter</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>

    <span class="k">def</span> <span class="nf">addJson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">js</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Complete an empty `Observation` with json data.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **js** : string - ObsJSON data</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">dic</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initDict</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">prp</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a new `ES.ESValue` to Result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **dat, loc, prp** : compatible Value for an existing or new `ES.ESValue`</span>
<span class="sd">        - **res** : compatible existing or new result `ES.ESValue`</span>
<span class="sd">        - **unique** : boolean (default False), if False, duplicate index is allowed</span>
<span class="sd">        - **equal** : string (default &#39;full&#39;), if &#39;full&#39;, two ESValue are equal</span>
<span class="sd">            if all the attributes are equal, if &#39;name&#39;, two ESValue are equal if only the names are equal.</span>
<span class="sd">        - **fast** : boolean (default False) - Update whith ESValue and whithout reindex, equal=full</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **int** : last index in the result valueList (or 0 if fast).  &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fast</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">[</span><span class="n">dat</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">prp</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">_classval</span><span class="p">():</span> <span class="n">resvalue</span> <span class="o">=</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">resvalue</span> <span class="o">=</span> <span class="n">_classval</span><span class="p">()[</span><span class="n">ESValue</span><span class="o">.</span><span class="n">valClassName</span><span class="p">(</span><span class="n">res</span><span class="p">)](</span><span class="n">res</span><span class="p">)</span>
        <span class="n">datv</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
        <span class="n">locv</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
        <span class="n">prpv</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="p">(</span><span class="n">prp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">equal</span> <span class="o">==</span> <span class="s1">&#39;full&#39;</span><span class="p">:</span>
            <span class="c1">#self.ilist.append(ReesultValue(res),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resvalue</span><span class="p">,</span> <span class="p">[</span><span class="n">datv</span><span class="p">,</span> <span class="n">locv</span><span class="p">,</span> <span class="n">prpv</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">equal</span> <span class="o">==</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">datv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">datv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">locv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">locv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">prpv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">prpv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="c1">#self.ilist.append(ReesultValue(res), [datv,locv, prpv], unique=unique, fast=fast)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resvalue</span><span class="p">,</span> <span class="p">[</span><span class="n">datv</span><span class="p">,</span><span class="n">locv</span><span class="p">,</span> <span class="n">prpv</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">appendList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listDat</span><span class="p">,</span> <span class="n">listLoc</span><span class="p">,</span> <span class="n">listPrp</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a list of new `ES.ESValue` to Result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **listVal** : list of ES.ESValue compatible type</span>
<span class="sd">        - **listDat, listLoc, listPrp** : list of index or Value to define a `ES.ESValue`</span>
<span class="sd">        - **unique** : boolean (default False), if False, duplicate index is allowed</span>
<span class="sd">        - **equal** : string (default &#39;full&#39;), if &#39;full&#39;, two ESValue are equal if all the attributes are equal,</span>
<span class="sd">        if &#39;name&#39;, two ESValue are equal if only the names are equal.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listDat</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listLoc</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listPrp</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listDat</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listLoc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listPrp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="n">equal</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">appendObs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add an `Observation` as a new Result `ES.ESValue` with bounding box for the Index `ES.ESValue`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **obs** : Observation</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **int** : last index in the `Observation`</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#return self.append(obs.bounds[0], obs.bounds[1], obs.bounds[2], obs, unique=unique, equal=equal)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ExternValue</span><span class="p">(</span><span class="n">obs</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="n">equal</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">choropleth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;choropleth&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Display `Observation` on a folium.Map (only with dim=1)</span>

<span class="sd">        - **name** : String, optionnal (default &#39;choropleth&#39;) - Name of the choropleth</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **folium.Map**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coorInv</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">Choropleth</span><span class="p">(</span>
                <span class="n">geo_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonFeature</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dataFrame</span><span class="p">(</span><span class="n">numeric</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">key_on</span><span class="o">=</span><span class="s2">&quot;feature.id&quot;</span><span class="p">,</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;locran&#39;</span><span class="p">,</span> <span class="s1">&#39;Observation&#39;</span><span class="p">],</span>
                <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;OrRd&quot;</span><span class="p">,</span>
                <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                <span class="n">line_opacity</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                <span class="n">line_weight</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">legend_name</span><span class="o">=</span><span class="s2">&quot;test choropleth&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">PolyLine</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">LocationValue</span><span class="o">.</span><span class="n">vPointInv</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">LayerControl</span><span class="p">()</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">m</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classES</span><span class="p">,</span> <span class="n">listValue</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Copy axis from other `Observation` to self `Observation` (if it daesn&#39;t exist)</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **other** : object Observation to copy</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">classES</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;duplicated index&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;index lenght not equal&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">addlistidx</span><span class="p">(</span><span class="n">classES</span><span class="p">,</span> <span class="n">listValue</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">newindex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nameES</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">swapindex</span><span class="p">(</span><span class="n">newindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">filterdic</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Remove `ES.ESValue` from Result that does not match the indexes filter.</span>
<span class="sd">        The filter is a list of tests of the form : &quot;indexvalue.method(parameter) is True&quot;</span>
<span class="sd">        where keyword &quot;method : parameter&quot; are given in the dictionnary. Filters are cumulatives.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **inplace** : boolean (default False) - If True, apply filter to</span>
<span class="sd">        Observation, else return new Observation.</span>
<span class="sd">        - **filterdic** : keyword arguments (keys is a ClassES and value is a dictionnary) .</span>
<span class="sd">                          where dict value contains keyword &quot;method : parameter&quot;</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Observation** : new observation if not inplace, else None.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">setidxf</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">filterdic</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filterdic</span><span class="p">,</span>  <span class="nb">dict</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;filter is not a dictionnary&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ESclass</span><span class="p">,</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">filterdic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">dic</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span>  <span class="nb">dict</span><span class="p">)</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;filter is not a dictionnary&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ESclass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ESclass</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">test</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">setidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">_idxfilter</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="s1">&#39;setidx&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">setidxf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">setidxf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">setidx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">inplace</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setfilter</span><span class="p">(</span><span class="n">setidxf</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">newobs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">()</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">ilist</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setfilter</span><span class="p">(</span><span class="n">setidxf</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">mAtt</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">option</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="k">return</span> <span class="n">newobs</span>

    <span class="nd">@classmethod</span>    
    <span class="k">def</span> <span class="nf">from_bytes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">byt</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate `Observation` object from byte value.</span>
<span class="sd">        </span>
<span class="sd">        *Returns* : `Observation`&#39;&#39;&#39;</span>
        <span class="n">iidx</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">iidxref</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nb_el</span>   <span class="o">=</span>  <span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00001111</span>
        <span class="n">obsref</span>  <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00010000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span>
        <span class="n">code_el</span> <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b11100000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1">#ref_obs = None</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span> 
        <span class="k">if</span> <span class="n">obsref</span><span class="p">:</span> 
            <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>           
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="n">nval</span><span class="o">=-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_el</span><span class="p">):</span>
            <span class="n">tup</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_list_from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">nval</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">nval</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span>   <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">iidx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">:</span> <span class="n">iidxref</span> <span class="o">=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> 
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iidx</span><span class="p">:</span>    <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">iidx</span>
        <span class="k">if</span> <span class="n">iidxref</span><span class="p">:</span>  <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">iidxref</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="c1">#print(&#39;dic : &#39;, dic)</span>
        <span class="k">return</span> <span class="n">Observation</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate `Observation` object from file storage.</span>

<span class="sd">         *Parameters*</span>

<span class="sd">        - **file** : string - file name (with path)</span>

<span class="sd">        *Returns* : `Observation`&#39;&#39;&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">btype</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">btype</span><span class="o">==</span><span class="nb">bytes</span><span class="p">(</span><span class="s1">&#39;{&quot;&#39;</span> <span class="o">+</span><span class="n">ES</span><span class="o">.</span><span class="n">type</span><span class="o">+</span><span class="s1">&#39;&quot;: &quot;&#39;</span> <span class="o">+</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">bjson</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">bjson</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">bjson</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">full</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add empty Result `ES.ESValue` to have a &#39;complete&#39; `Observation`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **inplace** : boolean (default False) - If True, add values to</span>
<span class="sd">        Observation, else return new Observation.</span>
<span class="sd">        - **minind** : boolean (default True) - If True, independent axes are</span>
<span class="sd">        completed with fillvalue, else all axes are completed</span>
<span class="sd">        - **fillvalue** : value used to complete the Observation</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Observation** : new observation if not inplace, else None.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">fillvalue</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">fillvalue</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullVal</span> <span class="c1">#ReesultValue.nullValue()</span>
        <span class="k">if</span> <span class="n">minind</span> <span class="o">==</span> <span class="kc">True</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">newobs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">()</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">ilist</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">mAtt</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">option</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="k">return</span> <span class="n">newobs</span>

    <span class="k">def</span> <span class="nf">iLoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` values for an `ES.ilist.Ilist` index.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idat, iloc, iprp** : `ES.ilist.Ilist` index value</span>
<span class="sd">        - **json** : Boolean (default True) - Return JSON string if True</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict** : dict or JSON of each ES.ESValue (dat, loc, prp, res)  &#39;&#39;&#39;</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;iloc not available &quot;</span><span class="p">)</span>
        <span class="k">try</span> <span class="p">:</span> <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iloc</span><span class="p">([</span><span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="n">dic</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span> <span class="n">dic</span>
        <span class="n">extidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidxtoext</span><span class="p">([</span><span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">])</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">option</span><span class="p">)</span>
        <span class="k">else</span>    <span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
        <span class="k">return</span> <span class="n">dic</span>

    <span class="k">def</span> <span class="nf">indexLoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the index of a `ES.ESValue` in a `ES.ilist.Ilist` index or result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **esValue** : `ES.ESValue`,</span>
<span class="sd">        - **name** : index or result name</span>
<span class="sd">        - **string** : Boolean (default True) - Return type (JSON if True, dict if False)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict or string** : {&#39;full&#39; : indFull, &#39;name&#39; : indName, &#39;value&#39; : indValue }</span>
<span class="sd">            - indFull : integer for the first index value with name and value equality</span>
<span class="sd">            - indName : integer for the first index value with name equality</span>
<span class="sd">            - indFull : integer for the first index value with value equality  &#39;&#39;&#39;</span>
        <span class="k">if</span>   <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span><span class="p">:</span> <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="sd">&#39;&#39;&#39;if   type(esValue)== PropertyValue : lis = self.setProperty</span>
<span class="sd">        elif type(esValue)== LocationValue : lis = self.setLocation</span>
<span class="sd">        elif type(esValue)== DatationValue : lis = self.setDatation</span>
<span class="sd">        elif type(esValue)== ReesultValue   : lis = self.setResult</span>
<span class="sd">        else: return None&#39;&#39;&#39;</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;full&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">return</span> <span class="n">ind</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">string</span> <span class="p">:</span> <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ind</span>

    <span class="k">def</span> <span class="nf">iObsIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` index values for an Observation row.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **ind** : row Observation (equivalent to Result row)</span>
<span class="sd">        - **json** : Boolean (default True) - Return JSON string if True</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : index of each ES.ESValue [idat, iloc, iprp]  &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">tiidx</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valDat</span><span class="p">,</span> <span class="n">valLoc</span><span class="p">,</span> <span class="n">valPrp</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` values for a DatationValue, LocationValue, PropertyValue.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **valdat, valloc, valprp** : DatationValue, LocationValue, PropertyValue</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict** : dict or JSON of each ES.ESValue (dat, loc, prp, res)  &#39;&#39;&#39;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extidxtoi</span><span class="p">([</span><span class="n">DatationValue</span><span class="p">(</span><span class="n">valDat</span><span class="p">),</span><span class="n">LocationValue</span><span class="p">(</span><span class="n">valLoc</span><span class="p">),</span><span class="n">PropertyValue</span><span class="p">(</span><span class="n">valPrp</span><span class="p">)])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iLoc</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">majList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axename</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Modify an attribute (name or value) in an axis list.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **axename** : index or result name</span>
<span class="sd">        - **listVal** : new list of values</span>
<span class="sd">        - **name** : boolean (default True) - True for &#39;name&#39; and False for &#39;value&#39;</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span> <span class="o">=</span> <span class="n">newlistVal</span>

        <span class="sd">&#39;&#39;&#39;if ValueClass == DatationValue and self.setDatation != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setDatation, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.dat_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == LocationValue and self.setLocation != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setLocation, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.loc_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == PropertyValue and self.setProperty != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setProperty, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.prp_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == ReesultValue and self.setResult != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setResult, listVal, name)</span>
<span class="sd">            self.ilist.extval = newlistVal&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">majValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">esValue</span><span class="p">,</span> <span class="n">newEsValue</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Update the value of an existing `ES.ESValue` by a new `ES.ESValue`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **esValue** : ESValue to update</span>
<span class="sd">        - **newEsValue** : new ESValue</span>
<span class="sd">        - **name** : index or result name</span>
<span class="sd">        - **equal** : criteria used to compare ESValue (&#39;full&#39;, &#39;name&#39;, &#39;value&#39;)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Int** : index in the ESSet valueList.  &#39;&#39;&#39;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexLoc</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="p">)[</span><span class="n">equal</span><span class="p">]</span>
        <span class="k">if</span>   <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span><span class="p">:</span> <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">setClass</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="sd">&#39;&#39;&#39;index = self.indexLoc(esValue)[equal]</span>
<span class="sd">        if   type(esValue) == PropertyValue : setClass = self.setProperty</span>
<span class="sd">        elif type(esValue) == LocationValue : setClass = self.setLocation</span>
<span class="sd">        elif type(esValue) == DatationValue : setClass = self.setDatation</span>
<span class="sd">        elif type(esValue) == ReesultValue   : setClass = self.setResult</span>
<span class="sd">        else : setClass = None&#39;&#39;&#39;</span>
        <span class="k">if</span>  <span class="n">setClass</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="n">setClass</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">newEsValue</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">switch</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function visualize an `Observation` with line or colormesh.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **switch** : Boolean (default False) - Switch between x and y axis.</span>
<span class="sd">        - **line** : Boolean (default True) - Choice line or colormesh.</span>
<span class="sd">        - **sort** : Boolean (defaut True) - Sort along an axis or not.</span>
<span class="sd">        - **size** : Int (default 5) - Size of the figure to plot.</span>
<span class="sd">        - **marker** : Char (default &#39;o&#39;) - Symbol for each point.</span>
<span class="sd">        - **maxname** : String (default 20) - maximum length for string</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">obx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">numeric</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="n">maxname</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dat&#39;</span> <span class="p">:</span> <span class="n">ext</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;str&#39;</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="n">ext</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ran&#39;</span>
            <span class="k">if</span> <span class="n">switch</span> <span class="p">:</span> <span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">line</span> <span class="p">:</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
                              <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                              <span class="n">hue</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                         <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                         <span class="n">yticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                         <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span> <span class="p">:</span>
                <span class="c1">#obx = obx.set_index(prp = &quot;prptyp&quot;, loc=&quot;locstr&quot;)</span>
                <span class="n">obx</span> <span class="o">=</span> <span class="n">obx</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">prp</span> <span class="o">=</span> <span class="s2">&quot;prpstr&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;locstr&quot;</span><span class="p">)</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">sortby</span><span class="p">([</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span><span class="s2">&quot;prp&quot;</span><span class="p">]</span>
                           <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;prp&quot;</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                                       <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="c1">#obx = obx.set_index(prp = &quot;prptyp&quot;, loc=&quot;locran&quot;)</span>
                <span class="n">obx</span> <span class="o">=</span> <span class="n">obx</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">prp</span> <span class="o">=</span> <span class="s2">&quot;prpstr&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;locran&quot;</span><span class="p">)</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">sortby</span><span class="p">([</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span><span class="s2">&quot;prp&quot;</span><span class="p">]</span>
                           <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;prp&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                                  <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">yticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">[],</span> <span class="n">reindex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Modify the order of `ES.ESValue`.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **order** : list (default []) - Ordered list to follow (0:dat, 1:loc, 2:prp).</span>
<span class="sd">        - **reindex** : boolean (default True) - calculate new index values.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">order</span><span class="p">],</span> <span class="n">reindex</span><span class="o">=</span><span class="n">reindex</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">bytedict</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Export in binary format. </span>
<span class="sd">        </span>
<span class="sd">        *Returns*</span>
<span class="sd">        </span>
<span class="sd">        - **bytes** : binary representation of the `Observation`</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">bytedict</span> <span class="o">|</span> <span class="n">option</span>
        <span class="n">nb</span><span class="o">=</span><span class="mi">0</span> 
        <span class="n">il</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> 
        <span class="n">index</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">:</span> <span class="c1">#!!!!</span>
            <span class="c1">#if name in opt: nb += len(opt[name]) + 1</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> <span class="n">nb</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">+</span> <span class="n">index</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> <span class="n">nb</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">])</span>
        <span class="n">nb</span> <span class="o">+=</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span>
        <span class="n">obsref</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">])</span>
        <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="mb">0b11100000</span> <span class="o">|</span> <span class="p">(</span><span class="n">obsref</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">nb</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">obsref</span><span class="p">:</span>
            <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">]:</span> 
                <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">,</span> <span class="n">typevalue</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">lenidx</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span> 
                    <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">typevalue</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span><span class="p">:</span> 
            <span class="n">iidxref</span><span class="o">=</span><span class="p">{</span><span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">il</span><span class="o">.</span><span class="n">dicidxref</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">iidxref</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">byt</span>

    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate csv file to display `Observation` data.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **file** : string - file name (with path)</span>

<span class="sd">        *Parameters (kwargs)*</span>

<span class="sd">        - **json** : boolean (default True) - Display json for `ES.ESValue`</span>
<span class="sd">        - **name** : boolean (default True) - Display name for `ES.ESValue`</span>
<span class="sd">        - **dat**  : boolean (default True) - Display value for `ES.ESValue.DatationValue`</span>
<span class="sd">        - **loc**  : boolean (default True) - Display value for `ES.ESValue.LocationValue`</span>
<span class="sd">        - **prp**  : boolean (default True) - Display value for `ES.ESValue.PropertyValue`</span>
<span class="sd">        - **res**  : boolean (default True) - Display value for Result `ES.ESValue`</span>
<span class="sd">        - **lenres** : int (default 0) - Number of raws (all if 0)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                  <span class="s1">&#39;prp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;lenres&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_tab</span><span class="p">(</span><span class="o">**</span><span class="n">option</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lign</span> <span class="ow">in</span> <span class="n">tab</span> <span class="p">:</span> 
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">lign</span><span class="p">)</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lign</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">size</span>

    <span class="k">def</span> <span class="nf">to_dataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">_identity</span><span class="p">,</span>
                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Observation&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to pandas.DataFrame with the smallest dimension.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **info** : Boolean (default False) - Generate a specific Coords with Observation characteristics.</span>
<span class="sd">        - **numeric** : Boolean (default False) - Generate a numeric DataArray.Values.</span>
<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes.</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function to apply to the result values</span>
<span class="sd">        - **name** : String (default &#39;Observation&#39;) - Name of the Dataframe</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **pandas.DataFrame**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="n">numeric</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span>
                                  <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span>
                                  <span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate obs file to display `Observation` data.</span>

<span class="sd">         *Parameters (kwargs)*</span>

<span class="sd">        - **file** : string - file name (with path)</span>
<span class="sd">        - **kwargs** : see &#39;to_json&#39; parameters</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Integer** : file lenght (bytes)  &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;encoded&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;json_res_index&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="o">**</span><span class="n">option</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="n">lendata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lendata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lendata</span>

    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Export in Bson or Json format.</span>

<span class="sd">        *Parameters (optional, default value in option attribute)*</span>

<span class="sd">        - **encoded**   : boolean - choice for return format (string/bytes if True, dict else)</span>
<span class="sd">        - **encode_format**  : string - choice for return format (bson, json, cbor)</span>
<span class="sd">        - **json_res_index** : Boolean - include index for Result</span>
<span class="sd">        - **json_param**     : Boolean - include ESObs Parameter</span>
<span class="sd">        - **json_info**      : Boolean - include ESObs Information with all information</span>
<span class="sd">        - **json_info_type** : Boolean - include in ESObs Information the type of ESObs</span>
<span class="sd">        - **json_info_nval** : Boolean - include in ESObs Information the lenght of ESObs</span>
<span class="sd">        - **json_info_box**  : Boolean - include in ESObs Information the bounding box</span>
<span class="sd">        - **json_info_other**: Boolean - include in ESObs Information the other information</span>
<span class="sd">        - **codif** : dict (default ES.codeb). Numerical value for string in CBOR encoder</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **string or dict** : Json string or dict        &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">option2</span> <span class="o">=</span> <span class="n">option</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;encoded&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="c1">#option2 = option | {&#39;encoded&#39;: option[&#39;bjson_bson&#39;]}</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ES</span><span class="o">.</span><span class="n">type</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span> <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span><span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jsonAtt</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderIsDefault</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span> <span class="n">dic</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;if self._indexIsDefault(dic): </span>
<span class="sd">            if &#39;index&#39; in dic: dic.pop(&#39;index&#39;)</span>
<span class="sd">            if &#39;default index&#39; in dic: dic.pop(&#39;default index&#39;)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_param&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">!=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span><span class="p">:</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="n">js2</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">]:</span> <span class="n">js2</span><span class="p">[</span><span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">js2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">js2</span> <span class="o">=</span> <span class="n">dic</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">js2</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bson</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">js2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cbor&#39;</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">cbor2</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">js2</span><span class="p">,</span> <span class="n">datetime_as_timestamp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                               <span class="n">timezone</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">,</span> <span class="n">canonical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dic</span>

    <span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to Numpy array.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes, &#39;flat&#39; : one dimension</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function to apply to the result values</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Numpy array**    &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_xarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Observation&#39;</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to DataArray.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **info** : Boolean (default False) - Generate a specific Coords with Observation characteristics.</span>
<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes, &#39;flat&#39; : one dimension</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function applied to each Result `ES.ESValue`</span>
<span class="sd">        - **numeric** : Boolean (default False) - Generate a numeric DataArray.Values.</span>
<span class="sd">        - **name** : String (default &#39;Observation&#39;) - Name of the xArray</span>
<span class="sd">        - **maxname** : String (default 20) - maximum length for string</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **xarray.DataArray**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;Observation not consistent&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;Observation empty&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="s1">&#39;axe&#39;</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">))</span>
        <span class="n">ilf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">)</span>
        <span class="n">ilf</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="c1">#xList = self._xlist_old(maxname=maxname)</span>
        <span class="n">xList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xlist</span><span class="p">(</span><span class="n">ilf</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="n">maxname</span><span class="p">)</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">xattrs</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;info&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_info_type</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">json_info_nval</span>  <span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_info_box</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">json_info_other</span> <span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;information&quot;</span><span class="p">]}</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xCoord</span><span class="p">(</span><span class="n">xList</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">ilf</span><span class="o">.</span><span class="n">idxref</span><span class="p">,</span> <span class="n">numeric</span><span class="p">)</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">ilf</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">ax</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ilf</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">ilf</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">axe</span><span class="p">]</span> <span class="k">for</span> <span class="n">axe</span> <span class="ow">in</span> <span class="n">ilf</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">numeric</span> <span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">ilf</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">ilf</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">to_float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">ilf</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">ilf</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1">#if numeric : data = ilf._tonumpy(ilf.extval, func = ReesultValue.to_float).reshape(ilf.axeslen)</span>
        <span class="c1">#else : data = ilf._tonumpy(ilf.extval, func=func, **kwargs).reshape(ilf.axeslen)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span> <span class="p">:</span> <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate tabular list to display `Observation` data.</span>

<span class="sd">        *Parameters (kwargs)*</span>

<span class="sd">        - **json** : boolean (default True) - Display json for `ES.ESValue`</span>
<span class="sd">        - **name** : boolean (default True) - Display name for `ES.ESValue`</span>
<span class="sd">        - **dat**  : boolean (default True) - Display value for `ES.ESValue.DatationValue`</span>
<span class="sd">        - **loc**  : boolean (default True) - Display value for `ES.ESValue.LocationValue`</span>
<span class="sd">        - **prp**  : boolean (default True) - Display value for `ES.ESValue.PropertyValue`</span>
<span class="sd">        - **lenres** : Integer (default : 0) - Number of raws (all if 0)</span>
<span class="sd">        - **width** : Integer (default 15) - Number of characters displayed for each attribute.</span>
<span class="sd">        - **tabulate params** : default &#39;tablefmt&#39;: &#39;simple&#39;, &#39;numalign&#39;: &#39;left&#39;, &#39;stralign&#39;: &#39;left&#39;,</span>
<span class="sd">                   &#39;floatfmt&#39;: &#39;.3f&#39; - See tabulate module</span>

<span class="sd">        *Returns* : None &#39;&#39;&#39;</span>
        <span class="n">opttab</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;prp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;lenres&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">optview</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tablefmt&#39;</span><span class="p">:</span> <span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="s1">&#39;numalign&#39;</span><span class="p">:</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="s1">&#39;stralign&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;floatfmt&#39;</span><span class="p">:</span> <span class="s1">&#39;.2f&#39;</span><span class="p">}</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">opttab</span> <span class="o">|</span> <span class="n">optview</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_tab</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">option</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">opttab</span><span class="p">})</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span>
        <span class="n">tab2</span> <span class="o">=</span> <span class="p">[[</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="n">width</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span> <span class="k">else</span> <span class="n">x</span><span class="p">)(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">lig</span><span class="p">]</span> <span class="k">for</span> <span class="n">lig</span> <span class="ow">in</span> <span class="n">tab</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s1">&#39;firstrow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">option</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">optview</span><span class="p">}))</span>

    <span class="k">def</span> <span class="nf">vList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">_identity</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function applied to each `ES.ESValue`</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the values      &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">idxname</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
            <span class="k">else</span> <span class="p">:</span>              <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idxname</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>
            <span class="k">else</span> <span class="p">:</span>              <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>

    <span class="k">def</span> <span class="nf">vListName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value name for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the value name      &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">idxname</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vName</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">idxname</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">))]</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idxname</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vName</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">idxname</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>

    <span class="k">def</span> <span class="nf">vListSimple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of simple value (see `ES.ESValue` vSimple method) for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the simple value      &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="n">idxname</span><span class="p">,</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">vSimple</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">vListValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value (see `ES.ESValue` getValue method) for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the values      &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="n">idxname</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">getValue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">voxel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Visualize Result `ES.ESValue` in a cube with voxels.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **sort** : Boolean (default False) - Sort along axis.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">obc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sort</span> <span class="p">:</span> <span class="n">obc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">obc</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
        <span class="c1">#obx = obc.to_xarray(numeric = False, func=ReesultValue.isNotNull)</span>
        <span class="n">obx</span> <span class="o">=</span> <span class="n">obc</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">numeric</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ESValue</span><span class="o">.</span><span class="n">isNotNull</span><span class="p">)</span>
        <span class="n">obp</span> <span class="o">=</span> <span class="n">obx</span> <span class="c1">#&gt;=0</span>
        <span class="n">obp</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;locran&#39;</span><span class="p">,</span> <span class="n">dat</span><span class="o">=</span><span class="s1">&#39;datran&#39;</span><span class="p">,</span> <span class="n">prp</span><span class="o">=</span><span class="s1">&#39;prpran&#39;</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">voxels</span><span class="p">(</span><span class="n">obp</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;dat (index)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;loc (index)&#39;</span><span class="p">,</span> <span class="n">zlabel</span><span class="o">=</span><span class="s1">&#39;prp (index)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#%% internal</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_boundingBox</span><span class="p">(</span><span class="n">listValue</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; return a `ES.ESValue.ESValue` object with bounds values&#39;&#39;&#39;</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">listValue</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">listValue</span><span class="p">:</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">boxUnion</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">box</span>

    <span class="sd">&quot;&quot;&quot;@staticmethod </span>
<span class="sd">    def _indexIsDefault(dic):</span>
<span class="sd">        return (&#39;index&#39; in dic and &#39;default index&#39; in dic and dic[&#39;index&#39;]==[dic[&#39;default index&#39;]]) or \</span>
<span class="sd">               (not &#39;index&#39; in dic and &#39;default index&#39; in dic) or \</span>
<span class="sd">               (&#39;index&#39; in dic and len(dic[&#39;index&#39;][0]) &lt;= 1)&quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Create json dict with info datas&#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info_type&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="n">dcinf</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoType</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info_nval&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="n">dcinf</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoNval</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info_box&quot;</span><span class="p">]</span>  <span class="p">:</span> <span class="n">dcinf</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoBox</span><span class="p">(</span><span class="o">**</span><span class="n">option</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info_other&quot;</span><span class="p">]:</span> <span class="n">dcinf</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoOther</span><span class="p">()</span>
        <span class="n">ldel</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dcinf</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;null&quot;</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">)</span>   <span class="p">:</span> <span class="n">ldel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullCoor</span>         <span class="p">:</span> <span class="n">ldel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ldel</span> <span class="p">:</span>         <span class="k">del</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dcinf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>    <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">ES</span><span class="o">.</span><span class="n">information</span> <span class="p">:</span> <span class="n">dcinf</span> <span class="p">}</span>
        <span class="sd">&#39;&#39;&#39;if len(dcinf) != 0 : dcinf = {ES.information : dcinf }</span>
<span class="sd">        if option[&quot;encoded&quot;] :</span>
<span class="sd">            if len(dcinf) == 0 :    return &quot;&quot;</span>
<span class="sd">            else :                  return json.dumps(dcinf)</span>
<span class="sd">        else: return dcinf&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">_infoBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">option</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add box informations&#39;s key-value to dict dcinf&#39;&#39;&#39;</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">:</span>
            <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_box</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
            <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">geo_box</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">)</span><span class="o">.</span><span class="n">__geo_interface__</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_box</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">:</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span>
            <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;encode_format&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
                <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_box</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">bound</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                     <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">bound</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_box</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dcinf</span>

    <span class="k">def</span> <span class="nf">_infoNval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add valueList lenght to dict dcinf&#39;&#39;&#39;</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">json_nval</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dcinf</span>

    <span class="k">def</span> <span class="nf">_infoOther</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s information key-value to dict dcinf&#39;&#39;&#39;</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_complet</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">complet</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_score</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_mRate</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_dim</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_axes</span><span class="p">]</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">return</span> <span class="n">dcinf</span>

    <span class="k">def</span> <span class="nf">_infoType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add information&#39;s key-value to dict dcinf&#39;&#39;&#39;</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">json_type_obs</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeObs</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">json_type</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">multi</span> <span class="o">+</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">json_type</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span>            <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dcinf</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_isESAtt</span><span class="p">(</span><span class="n">esClass</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;identify if &#39;key&#39; is included in &#39;esClass&#39;</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **esClass** : string for an ESClass attribute</span>
<span class="sd">        - **key** : string to search</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Boolean**        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">mTypeAtt</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_jsonAtt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">option</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; generate a dict with mAtt attributes&#39;&#39;&#39;</span>
        <span class="n">att</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">mTypeAtt</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullValues</span> <span class="p">:</span> <span class="n">att</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">att</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">att</span>


    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">_list_from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">,</span> <span class="n">nv</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">lis</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">code_el</span> <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b11100000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span>
        <span class="n">unique</span>  <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00010000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span>        
        <span class="n">code_ES</span> <span class="o">=</span>  <span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00001111</span>
        <span class="c1">#if byt[0:1] == struct.pack(&#39;&lt;B&#39;, 0b11000000):</span>
        <span class="k">if</span> <span class="n">code_el</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">unique</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nv</span><span class="p">):</span>
                <span class="n">lis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">nv</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">code_el</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">unique</span><span class="p">:</span>
            <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">code_ES</span><span class="p">):</span>
                <span class="n">dic</span><span class="p">[</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">code_ES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">,</span>    <span class="kc">True</span><span class="p">)</span>
        <span class="n">nameES</span>  <span class="o">=</span> <span class="n">code_ES</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">namevalue</span>
        <span class="n">mini</span>    <span class="o">=</span> <span class="n">code_ES</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">minivalue</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">nval</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">unique</span><span class="p">:</span> 
            <span class="n">nval</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">code_el</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">],</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_value</span><span class="p">]]:</span>
            <span class="n">code_el</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nval</span><span class="p">):</span>
            <span class="n">esVal</span> <span class="o">=</span> <span class="n">_classval</span><span class="p">()[</span><span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">code_el</span><span class="p">]]()</span>
            <span class="k">if</span> <span class="n">nameES</span> <span class="ow">and</span> <span class="n">mini</span><span class="p">:</span> 
                <span class="n">n</span> <span class="o">=</span> <span class="n">esVal</span><span class="o">.</span><span class="n">_from_strBytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="n">ES</span><span class="o">.</span><span class="n">miniStr</span><span class="p">],</span> <span class="n">simple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">nameES</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mini</span><span class="p">:</span> 
                <span class="n">n</span> <span class="o">=</span> <span class="n">esVal</span><span class="o">.</span><span class="n">_from_strBytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">simple</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">code_el</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]:</span> 
                <span class="n">n</span> <span class="o">=</span> <span class="n">esVal</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">ES</span><span class="o">.</span><span class="n">invProp</span><span class="p">[</span><span class="n">code_ES</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">n</span> <span class="o">=</span> <span class="n">esVal</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">mini</span><span class="p">)</span>
            <span class="n">lis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">esVal</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="n">n</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">code_el</span><span class="p">],</span> <span class="n">nameES</span><span class="p">)</span>  

    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">_list_to_bytes</span><span class="p">(</span><span class="n">eslist</span><span class="p">,</span> <span class="n">classES</span><span class="p">,</span> <span class="n">typevalue</span><span class="p">):</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eslist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> 
        <span class="n">arg</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">prop</span><span class="p">:</span>        
            <span class="n">arg</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">prop</span><span class="p">[</span><span class="n">typevalue</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">codeEl</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_value</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">codevalue</span><span class="p">:</span>   
            <span class="n">arg</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">codevalue</span><span class="p">[</span><span class="n">typevalue</span><span class="p">]</span>
            <span class="n">codeEl</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">classES</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">]:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;typevalue not consistent&quot;</span><span class="p">)</span>
        <span class="n">mini</span> <span class="o">=</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">codevalue</span> <span class="ow">and</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">minivalue</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">codevalue</span> <span class="ow">and</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">namevalue</span>        
        <span class="k">if</span> <span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> 
            <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="mb">0b11000000</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">:</span> 
            <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="nb">len</span><span class="p">(</span><span class="n">eslist</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">codeEl</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">unique</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">arg</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">unique</span> <span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">eslist</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">mini</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">_to_strBytes</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mini</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mini</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">_to_strBytes</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mini</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">classES</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">typevalue</span><span class="p">)</span> 
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>        
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
                <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">mini</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">byt</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_majList</span><span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; update value or name in a list of `ES.ESValue` &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="p">:</span>   <span class="k">return</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majListName</span> <span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>      <span class="k">return</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majListValue</span><span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_majListName</span><span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; update name in a list of `ES.ESValue` &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;inconsistent length of the lists : &quot;</span> <span class="o">+</span>
                                   <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; and &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span><span class="n">newlistVal</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">listVal</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_majListValue</span><span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; update value in a list of `ES.ESValue` &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">)</span> <span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span><span class="n">newlistVal</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">listVal</span>

    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">_orderIsDefault</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">order</span> <span class="ow">in</span> <span class="p">[[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">],</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">],</span>
                         <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">],</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">_to_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; data preparation for view or csv export&#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                  <span class="s1">&#39;prp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;lenres&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">json</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">prp</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">lenres</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">resList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;datation&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;dat name&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dat</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;dat instant&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;loc name&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">loc</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;loc coor x&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">loc</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;loc coor y&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;property&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;prop name&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prp</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;prop type&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;res name&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">res</span> <span class="p">:</span>  <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;res value&#39;</span><span class="p">)</span>
        <span class="n">tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lenres</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">lenres</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lenres</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">)))</span> <span class="p">:</span>
            <span class="n">resList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">idat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">idat</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">idat</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dat</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">idat</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">vSimple</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">iloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iloc</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iloc</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">loc</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iloc</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">vSimple</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">loc</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iloc</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">vSimple</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">iprp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iprp</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iprp</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">prp</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iprp</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">simple</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">res</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resList</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tab</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_xCoord</span><span class="p">(</span><span class="n">xList</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">idxref</span><span class="p">,</span> <span class="n">numeric</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39; Coords generation for Xarray&#39;&#39;&#39;</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">xList</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;res&#39;</span> <span class="p">:</span>
                <span class="n">axe</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">idxref</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">nax</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]]]]</span>
                <span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">axe</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]])</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;loclon&#39;</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;loclat&#39;</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">numeric</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;loc&#39;</span> <span class="ow">in</span> <span class="n">coord</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;locran&#39;</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;dat&#39;</span> <span class="ow">in</span> <span class="n">coord</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datins&#39;</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;prp&#39;</span> <span class="ow">in</span> <span class="n">coord</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prpran&#39;</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">coord</span>

    <span class="sd">&quot;&quot;&quot;def _xlist_old(self, maxname=0):</span>
<span class="sd">        &#39;&#39;&#39;list generation for Xarray&#39;&#39;&#39;</span>
<span class="sd">        xList = {}</span>
<span class="sd">        if self.setLocation != None and len(self.setLocation) &gt; 1:</span>
<span class="sd">            xList[&#39;loc&#39;]    = self.ilist._tonumpy(self.setLocation)</span>
<span class="sd">            xList[&#39;locstr&#39;] = self.ilist._tonumpy(self.setLocation, func = LocationValue.json)</span>
<span class="sd">            xList[&#39;loclon&#39;] = self.ilist._tonumpy(self.setLocation, func = LocationValue.vPointX)</span>
<span class="sd">            xList[&#39;loclat&#39;] = self.ilist._tonumpy(self.setLocation, func = LocationValue.vPointY)</span>
<span class="sd">            xList[&#39;locnam&#39;] = self.ilist._tonumpy(self.setLocation, func = LocationValue.vName)</span>
<span class="sd">            xList[&#39;locran&#39;] = np.arange(len(xList[&#39;loc&#39;]))</span>
<span class="sd">        if self.setDatation != None and len(self.setDatation) &gt; 1:</span>
<span class="sd">            xList[&#39;dat&#39;]    = self.ilist._tonumpy(self.setDatation)</span>
<span class="sd">            xList[&#39;datstr&#39;] = self.ilist._tonumpy(self.setDatation, func = DatationValue.json)</span>
<span class="sd">            xList[&#39;datins&#39;] = self.ilist._tonumpy(self.setDatation, func = DatationValue.vSimple)</span>
<span class="sd">            xList[&#39;datnam&#39;] = self.ilist._tonumpy(self.setDatation, func = DatationValue.vName)</span>
<span class="sd">            xList[&#39;datran&#39;] = np.arange(len(xList[&#39;dat&#39;]))</span>
<span class="sd">        if self.setProperty != None and len(self.setProperty) &gt; 1:</span>
<span class="sd">            xList[&#39;prp&#39;]    = self.ilist._tonumpy(self.setProperty)</span>
<span class="sd">            xList[&#39;prpstr&#39;] = self.ilist._tonumpy(self.setProperty, func = PropertyValue.json)</span>
<span class="sd">            xList[&#39;prptyp&#39;] = self.ilist._tonumpy(self.setProperty, func = PropertyValue.vSimple)</span>
<span class="sd">            xList[&#39;prpnam&#39;] = self.ilist._tonumpy(self.setProperty, func = PropertyValue.vName)</span>
<span class="sd">            xList[&#39;prpran&#39;] = np.arange(len(xList[&#39;prp&#39;]))</span>
<span class="sd">        if maxname &gt; 0 :</span>
<span class="sd">            for key,lis in xList.items() :</span>
<span class="sd">                if key[3:6] in [&#39;str&#39;, &#39;nam&#39;, &#39;typ&#39;]:</span>
<span class="sd">                    for i in range(len(lis)) : lis[i] = lis[i][0:maxname]</span>
<span class="sd">        return xList&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">_xlist</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;list generation for Xarray&#39;&#39;&#39;</span>
        <span class="n">xList</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">setLocation</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">setname</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">setLocation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;locstr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="o">.</span><span class="n">json</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;loclon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="o">.</span><span class="n">vPointX</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;loclat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="o">.</span><span class="n">vPointY</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;locnam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="o">.</span><span class="n">vName</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;locran&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xList</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]))</span>
        <span class="n">setDatation</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">setname</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">setDatation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setDatation</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datstr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="o">.</span><span class="n">json</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="o">.</span><span class="n">vSimple</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datnam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="o">.</span><span class="n">vName</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datran&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xList</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]))</span>
        <span class="n">setProperty</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">setname</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">setProperty</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setProperty</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prpstr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="o">.</span><span class="n">json</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prptyp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="o">.</span><span class="n">vSimple</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prpnam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="o">.</span><span class="n">vName</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prpran&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">maxname</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">lis</span> <span class="ow">in</span> <span class="n">xList</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;nam&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">))</span> <span class="p">:</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">maxname</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">xList</span>

<span class="k">class</span> <span class="nc">ObservationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">pass</span>

<span class="sd">&#39;&#39;&#39;_classValue: dict = {        </span>
<span class="sd">        ES.obs_clsName: Observation,</span>
<span class="sd">        ES.dat_clsName: DatationValue,</span>
<span class="sd">        ES.loc_clsName: LocationValue,</span>
<span class="sd">        ES.prp_clsName: PropertyValue,</span>
<span class="sd">        ES.ext_clsName: ExternValue,</span>
<span class="sd">        ES.nam_clsName: NamedValue,</span>
<span class="sd">        ES.ili_clsName: Ilist,</span>
<span class="sd">        #ES.coo_clsName: coordinate,</span>
<span class="sd">        ES.tim_clsName: datetime.datetime,</span>
<span class="sd">        ES.slo_clsName: TimeSlot}        &#39;&#39;&#39;</span>                             
</pre></div>

        </details>

            </section>
                <section id="Observation">
                                <div class="attr class">
        <a class="headerlink" href="#Observation">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">Observation</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Observation</span> <span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An `Observation` is made up of `ES.ilist` object which describe the axes of this object.</span>

<span class="sd">    *Attributes (for @property see methods)* :</span>

<span class="sd">    - **option** : Dictionnary with options</span>
<span class="sd">    - **ilist** : Ilist object (data and axes)</span>
<span class="sd">    - **name** : textual description</span>
<span class="sd">    - **mAtt** : namedValue dictionnary (internal parameters)</span>
<span class="sd">    - **parameter** : namedValue dictionnary (external data)</span>

<span class="sd">    The methods defined in this class are :</span>

<span class="sd">    *property (getters)*</span>

<span class="sd">    - `Observation.axes`</span>
<span class="sd">    - `Observation.bounds`</span>
<span class="sd">    - `Observation.complet`</span>
<span class="sd">    - `Observation.consistent`</span>
<span class="sd">    - `Observation.dimension`</span>
<span class="sd">    - `Observation.json`</span>
<span class="sd">    - `Observation.jsonFeature`</span>
<span class="sd">    - `Observation.nValueObs`</span>
<span class="sd">    - `Observation.rate`</span>
<span class="sd">    - `Observation.score`</span>
<span class="sd">    - `Observation.setDatation`</span>
<span class="sd">    - `Observation.setLocation`</span>
<span class="sd">    - `Observation.setProperty`</span>
<span class="sd">    - `Observation.setResult`</span>
<span class="sd">    - `Observation.typeObs`</span>

<span class="sd">    *getters*</span>

<span class="sd">    - `Observation.vList`</span>
<span class="sd">    - `Observation.vListName`</span>
<span class="sd">    - `Observation.vListSimple`</span>
<span class="sd">    - `Observation.vListValue`</span>

<span class="sd">    *add value*</span>

<span class="sd">    - `Observation.addAttributes`</span>
<span class="sd">    - `Observation.addJson`</span>
<span class="sd">    - `Observation.append`</span>
<span class="sd">    - `Observation.appendList`</span>
<span class="sd">    - `Observation.appendObs`</span>

<span class="sd">    *update value*</span>

<span class="sd">    - `Observation.majList`</span>
<span class="sd">    - `Observation.majValue`</span>

<span class="sd">    *selecting*</span>

<span class="sd">    - `Observation.indexLoc`</span>
<span class="sd">    - `Observation.iLoc`</span>
<span class="sd">    - `Observation.iObsIndex`</span>
<span class="sd">    - `Observation.loc`</span>

<span class="sd">    *management*</span>

<span class="sd">    - `Observation.extend`</span>
<span class="sd">    - `Observation.filter`</span>
<span class="sd">    - `Observation.full`</span>
<span class="sd">    - `Observation.sort`</span>

<span class="sd">    *visualization*</span>

<span class="sd">    - `Observation.choropleth`</span>
<span class="sd">    - `Observation.voxel`</span>
<span class="sd">    - `Observation.plot`</span>
<span class="sd">    - `Observation.view`</span>

<span class="sd">    *exports - imports*</span>

<span class="sd">    - `Observation.from_file`</span>
<span class="sd">    - `Observation.to_csv`</span>
<span class="sd">    - `Observation.to_dataFrame`</span>
<span class="sd">    - `Observation.to_json`</span>
<span class="sd">    - `Observation.to_numpy`</span>
<span class="sd">    - `Observation.to_file`</span>
<span class="sd">    - `Observation.to_xarray`</span>
<span class="sd">    - `Observation.to_bytes`              # à voir</span>
<span class="sd">    - `Observation.from_bytes`            # à voir</span>

<span class="sd">    &quot;&quot;&quot;</span>

<span class="c1">#%% constructor</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">idxref</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Several Observation creation modes :</span>

<span class="sd">        - Observation(dictESValue1, dictESValue2, ...) where dictESValue = {ESValuename : value}</span>
<span class="sd">        - Observation({ObsDict}) where ObsDict is a dictionnary with the same data as an ObsJSON</span>
<span class="sd">        - Observation(ObsJSON) where ObsJSON is a string with the JSON format</span>
<span class="sd">        - Observation(ObsBSON) where ObsBSON is a bytes with the BSON format</span>
<span class="sd">        - Observation([ESSetDatation, ESSetLocation, ESSetProperty, ESSetResult]) where ESSet is a list of ESValue :</span>
<span class="sd">            [ESValue1, ESValue2,...] or [ESValue] or ESValue</span>
<span class="sd">        - Observation(datation=ESSetDatation, location=ESSetLocation,</span>
<span class="sd">                      property=ESSetProperty, result=ESSetResult)</span>

<span class="sd">        *Note : the parameters &#39;idxref&#39; and &#39;order&#39; are used only when an ESSetResult without Index is in arguments.</span>
<span class="sd">        &#39;order&#39; indicates the order for the Index creation and &#39;idxref&#39; the linked index (0 for Datation, 1 for Location, 2 for Property).*</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">kwargs</span> <span class="o">|=</span> <span class="p">{</span><span class="s1">&#39;order&#39;</span> <span class="p">:</span> <span class="n">order</span><span class="p">,</span> <span class="s1">&#39;idxref&#39;</span> <span class="p">:</span> <span class="n">idxref</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;observation du &quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">mOption</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>        <span class="c1"># json</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">Ilist</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#self.mAtt[ES.obs_reference] = 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullVal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_resultTime</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initObs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Ilist</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ilist</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mAtt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">obs</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">ilist</span> 
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">option</span> <span class="o">|=</span> <span class="n">option</span>
        <span class="k">if</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span> 
        <span class="k">if</span> <span class="n">mAtt</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">|=</span> <span class="n">mAtt</span>
        <span class="k">return</span> <span class="n">obs</span>
    
    <span class="k">def</span> <span class="nf">_initObs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; data creation &#39;&#39;&#39;</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">:</span> <span class="n">args</span> <span class="o">=</span> <span class="p">[{}]</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span> <span class="p">:</span>       <span class="c1"># creation à partir d&#39;un json &quot;key : [liste]&quot;</span>
                <span class="k">try</span><span class="p">:</span> <span class="n">arg</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="n">object_hook</span><span class="o">=</span><span class="n">CborDecoder</span><span class="p">()</span><span class="o">.</span><span class="n">codecbor</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span> <span class="k">pass</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">arg</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mh">0x00</span> <span class="ow">and</span> <span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b11100000</span><span class="p">)</span> <span class="o">==</span> <span class="mb">0b10100000</span><span class="p">:</span>
                    <span class="n">dic</span><span class="o">=</span><span class="n">cbor2</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">dic</span> <span class="o">=</span> <span class="n">bson</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span> <span class="p">:</span>      <span class="c1"># creation à partir d&#39;un dict &quot;key : [liste]&quot;</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
                    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span> <span class="p">:</span> <span class="n">dic</span> <span class="o">|=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_valName</span> <span class="p">:</span> <span class="n">dic</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_valName</span><span class="p">]</span> <span class="c1">#!!!</span>
        <span class="k">if</span> <span class="n">dic</span> <span class="o">!=</span> <span class="p">{}</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">args</span> <span class="o">==</span> <span class="p">[{}]</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span> <span class="p">:</span> <span class="n">dic</span> <span class="o">|=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span><span class="p">}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_initDict</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">args</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="p">:</span>    <span class="c1"># création à partir d&#39;un jeu de valeur [[dat], [loc], [prp], [res]]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_initList</span><span class="p">(</span><span class="n">arg</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span> <span class="p">:</span>   <span class="c1"># creation uniquement d&#39;un jeu de données dat, loc, prp, res</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">arg</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">arg</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_initDict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dic</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39; data creation in dict mode&#39;&#39;&#39;</span>
        <span class="n">js</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">:</span> <span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">js</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_attributes</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_attributes</span><span class="p">])</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span> <span class="n">js</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_attributes</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span> <span class="k">return</span>
        <span class="n">dicilist</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">order</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">classES</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">classES</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="p">:</span>
                <span class="n">dicilist</span><span class="p">[</span><span class="n">classES</span><span class="p">]</span> <span class="o">=</span>  <span class="n">js</span><span class="p">[</span><span class="n">classES</span><span class="p">]</span>
                <span class="n">order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">classES</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">dicilist</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;order&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">js</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">dicilist</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">dicilist</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;idxref&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="p">:</span> <span class="n">dicilist</span><span class="p">[</span><span class="s1">&#39;idxref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="s1">&#39;idxref&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;index&#39;</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="p">:</span> <span class="n">dicilist</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">js</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">Ilist</span><span class="o">.</span><span class="n">from_obj</span><span class="p">(</span><span class="n">dicilist</span><span class="p">)</span>
        <span class="n">ordern</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ordern</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">swapindex</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ordern</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addAttributes</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_initList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;data creation in list mode &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;order&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="p">:</span> <span class="n">order</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;datation&#39;</span><span class="p">,</span> <span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="s1">&#39;property&#39;</span><span class="p">]</span>
        <span class="n">ordern</span> <span class="o">=</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">order</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;idxref&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="p">:</span> <span class="n">idxref</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;idxref&#39;</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">idxref</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">idxrefn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">idxref</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
            <span class="n">keyn</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">valn</span> <span class="o">=</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="n">idxrefn</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">keyn</span><span class="p">,</span> <span class="n">valn</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">keyn</span><span class="p">,</span> <span class="n">valn</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">Ilist</span><span class="o">.</span><span class="n">Iset</span><span class="p">(</span><span class="n">valiidx</span><span class="o">=</span><span class="n">lis</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                <span class="n">setidx</span><span class="o">=</span><span class="p">[</span><span class="n">lis</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lis</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lis</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> 
                                <span class="n">order</span><span class="o">=</span><span class="n">ordern</span><span class="p">,</span> <span class="n">idxref</span><span class="o">=</span><span class="n">idxrefn</span><span class="p">,</span> <span class="n">valname</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> 
                                <span class="n">idxname</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">defaultidx</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#%% special</span>
    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Copy all the data, included ESValue&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">__geo_interface__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;dict (@property) : return the union of geometry (see shapely)&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span>
            <span class="n">collec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vListValue</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">first</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">shap</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vListValue</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">first</span> <span class="p">:</span> <span class="n">collec</span> <span class="o">=</span> <span class="n">collec</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">shap</span><span class="p">)</span>
                <span class="n">first</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">collec</span><span class="o">.</span><span class="n">__geo_interface__</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="s2">&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__ior__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s index to self&#39;s index&#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">|=</span> <span class="n">other</span><span class="o">.</span><span class="n">ilist</span>
        <span class="n">newindex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nameES</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">swapindex</span><span class="p">(</span><span class="n">newindex</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s index to self&#39;s index and return a new Observation&#39;&#39;&#39;</span>
        <span class="n">obres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
        <span class="n">obres</span><span class="o">.</span><span class="fm">__ior__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obres</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; return ResValue item&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s values to self&#39;s values&#39;&#39;&#39;</span>
        <span class="c1">#self.ilist += other.ilist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iadd</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">ilist</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">option</span><span class="p">[</span><span class="s2">&quot;unic_index&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s values to self&#39;s values and return a new Observation&#39;&#39;&#39;</span>
        <span class="n">obres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__copy__</span><span class="p">()</span>
        <span class="n">obres</span><span class="o">.</span><span class="fm">__iadd__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obres</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">+</span> <span class="s1">&#39;[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]&#39;</span>

    <span class="k">def</span> <span class="nf">__to_bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">option</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">],</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;bson&#39;</span><span class="p">,</span>
                            <span class="n">json_info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_res_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">json_param</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#%% properties</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list of integer (@property)** : list of independant axes in the Observation</span>
<span class="sd">        (0 for Datation, 1 for Location, 2 for Property)&#39;&#39;&#39;</span>
        <span class="n">axes</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">axes</span> <span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">:</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">axes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list of `ES.ESValue` (@property)** : `ES.ESValue` bounding box for each axis.&#39;&#39;&#39;</span>
        <span class="n">bound</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="c1">#if self.setDatation : bound[0] = self._boundingBox(DatationValue, self.setDatation)</span>
        <span class="c1">#if self.setLocation : bound[1] = self._boundingBox(LocationValue, self.setLocation)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="p">:</span> <span class="n">bound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span> <span class="n">bound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="p">:</span> <span class="n">bound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">bound</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">complet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **boolean (@property)** : True if self.ilist is complete (if the number of </span>
<span class="sd">        values is consistent with the number of index values)&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">complete</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">consistent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **boolean (@property)** : True if Observation is consistent (no duplicate index) &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **integer (@property)** : number of independant axes in the Observation&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">dimension</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">json</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **string (@property)** : JSON Observation (ObsJSON format) whit index</span>
<span class="sd">        and whitout informations&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">,</span>
                            <span class="n">json_info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_res_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">json_param</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">jsonFeature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **string (@property)** : &quot;FeatureCollection&quot; with ESSetLocation geometry&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span>
            <span class="n">geo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__geo_interface__</span>
            <span class="k">if</span> <span class="n">geo</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;MultiPolygon&quot;</span><span class="p">:</span> <span class="n">typ</span> <span class="o">=</span> <span class="s2">&quot;Polygon&quot;</span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">typ</span> <span class="o">=</span> <span class="s2">&quot;Point&quot;</span>
            <span class="n">lis</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="n">typ</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;coordinates&quot;</span><span class="p">,</span> <span class="n">geo</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">])))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geo</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">])))</span>
            <span class="n">fea</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="s2">&quot;Feature&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">,</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">geo</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">])))</span>
            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="nb">dict</span><span class="p">(((</span><span class="s2">&quot;type&quot;</span><span class="p">,</span><span class="s2">&quot;FeatureCollection&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;features&quot;</span><span class="p">,</span><span class="n">fea</span><span class="p">))),</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nValueObs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : lenght of axes [datation, location, properety, result].&#39;&#39;&#39;</span>
        <span class="n">nvalue</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">esclass</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="p">:</span>
            <span class="n">nval</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">))</span> <span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">esclass</span> <span class="p">:</span> <span class="n">nval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">nvalue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nval</span><span class="p">)</span>
        <span class="n">nvalue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setvallen</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nvalue</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **float (@property)** : ratio number measure / number measure if complete&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">rate</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **integer (@property)** : Observation type (calculated from dimension , nValueObs and idxref).</span>
<span class="sd">        The score is a codification of the number of ESValue for each axis.</span>
<span class="sd">        E.g., score=122 means one PropertyValue (1), several LocationValue (2),</span>
<span class="sd">        several DatationValue (2)&#39;&#39;&#39;</span>
        <span class="p">[</span> <span class="n">nDat</span><span class="p">,</span> <span class="n">nLoc</span><span class="p">,</span> <span class="n">nPrp</span><span class="p">,</span> <span class="n">nRes</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span>
        <span class="n">score</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">nPrp</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">nLoc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">nDat</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">229</span><span class="p">);</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">==</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span> <span class="n">score</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">22</span>  <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">23</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">122</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">123</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">202</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">203</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">212</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">213</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">220</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">223</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">221</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">224</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">222</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">228</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">222</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="mi">2</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxref</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">225</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">222</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="mi">1</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxref</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">226</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="mi">222</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="mi">0</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxref</span> <span class="o">==</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>	<span class="n">score</span> <span class="o">=</span> <span class="mi">227</span>
        <span class="k">return</span> <span class="n">score</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">setDatation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : list of values in the datation axis&#39;&#39;&#39;</span>
        <span class="k">try</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)]</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">setLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : list of values in the location axis&#39;&#39;&#39;</span>
        <span class="k">try</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)]</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">setProperty</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : list of values in the property axis&#39;&#39;&#39;</span>
        <span class="k">try</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)]</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">setResult</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **list (@property)** : list of values in the result axis&#39;&#39;&#39;</span>
        <span class="k">try</span> <span class="p">:</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">typeObs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        **string (@property)** : Observation type (calculated from the score)&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ES</span><span class="o">.</span><span class="n">obsCat</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ES</span><span class="o">.</span><span class="n">obsCat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="c1">#%% methods</span>
    <span class="k">def</span> <span class="nf">addAttributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">js</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add informations attached to `Observation`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **js** : Dict - Keys are Observation keys (dict mAtt) or users keys (dict parameter).</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">dict</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">js</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">information</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_isESAtt</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">or</span>
                                                       <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">reserved</span><span class="p">)</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">parameter</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>

    <span class="k">def</span> <span class="nf">addJson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">js</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Complete an empty `Observation` with json data.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **js** : string - ObsJSON data</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">dic</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initDict</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">prp</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a new `ES.ESValue` to Result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **dat, loc, prp** : compatible Value for an existing or new `ES.ESValue`</span>
<span class="sd">        - **res** : compatible existing or new result `ES.ESValue`</span>
<span class="sd">        - **unique** : boolean (default False), if False, duplicate index is allowed</span>
<span class="sd">        - **equal** : string (default &#39;full&#39;), if &#39;full&#39;, two ESValue are equal</span>
<span class="sd">            if all the attributes are equal, if &#39;name&#39;, two ESValue are equal if only the names are equal.</span>
<span class="sd">        - **fast** : boolean (default False) - Update whith ESValue and whithout reindex, equal=full</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **int** : last index in the result valueList (or 0 if fast).  &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fast</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">[</span><span class="n">dat</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">prp</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">_classval</span><span class="p">():</span> <span class="n">resvalue</span> <span class="o">=</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">resvalue</span> <span class="o">=</span> <span class="n">_classval</span><span class="p">()[</span><span class="n">ESValue</span><span class="o">.</span><span class="n">valClassName</span><span class="p">(</span><span class="n">res</span><span class="p">)](</span><span class="n">res</span><span class="p">)</span>
        <span class="n">datv</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
        <span class="n">locv</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
        <span class="n">prpv</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="p">(</span><span class="n">prp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">equal</span> <span class="o">==</span> <span class="s1">&#39;full&#39;</span><span class="p">:</span>
            <span class="c1">#self.ilist.append(ReesultValue(res),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resvalue</span><span class="p">,</span> <span class="p">[</span><span class="n">datv</span><span class="p">,</span> <span class="n">locv</span><span class="p">,</span> <span class="n">prpv</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">equal</span> <span class="o">==</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">datv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">datv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">locv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">locv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">prpv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">prpv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="c1">#self.ilist.append(ReesultValue(res), [datv,locv, prpv], unique=unique, fast=fast)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resvalue</span><span class="p">,</span> <span class="p">[</span><span class="n">datv</span><span class="p">,</span><span class="n">locv</span><span class="p">,</span> <span class="n">prpv</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">appendList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listDat</span><span class="p">,</span> <span class="n">listLoc</span><span class="p">,</span> <span class="n">listPrp</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a list of new `ES.ESValue` to Result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **listVal** : list of ES.ESValue compatible type</span>
<span class="sd">        - **listDat, listLoc, listPrp** : list of index or Value to define a `ES.ESValue`</span>
<span class="sd">        - **unique** : boolean (default False), if False, duplicate index is allowed</span>
<span class="sd">        - **equal** : string (default &#39;full&#39;), if &#39;full&#39;, two ESValue are equal if all the attributes are equal,</span>
<span class="sd">        if &#39;name&#39;, two ESValue are equal if only the names are equal.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listDat</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listLoc</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listPrp</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listDat</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listLoc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listPrp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="n">equal</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">appendObs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add an `Observation` as a new Result `ES.ESValue` with bounding box for the Index `ES.ESValue`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **obs** : Observation</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **int** : last index in the `Observation`</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#return self.append(obs.bounds[0], obs.bounds[1], obs.bounds[2], obs, unique=unique, equal=equal)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ExternValue</span><span class="p">(</span><span class="n">obs</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="n">equal</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">choropleth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;choropleth&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Display `Observation` on a folium.Map (only with dim=1)</span>

<span class="sd">        - **name** : String, optionnal (default &#39;choropleth&#39;) - Name of the choropleth</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **folium.Map**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coorInv</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">Choropleth</span><span class="p">(</span>
                <span class="n">geo_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonFeature</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dataFrame</span><span class="p">(</span><span class="n">numeric</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">key_on</span><span class="o">=</span><span class="s2">&quot;feature.id&quot;</span><span class="p">,</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;locran&#39;</span><span class="p">,</span> <span class="s1">&#39;Observation&#39;</span><span class="p">],</span>
                <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;OrRd&quot;</span><span class="p">,</span>
                <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                <span class="n">line_opacity</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                <span class="n">line_weight</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">legend_name</span><span class="o">=</span><span class="s2">&quot;test choropleth&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">PolyLine</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">LocationValue</span><span class="o">.</span><span class="n">vPointInv</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">LayerControl</span><span class="p">()</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">m</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classES</span><span class="p">,</span> <span class="n">listValue</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Copy axis from other `Observation` to self `Observation` (if it daesn&#39;t exist)</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **other** : object Observation to copy</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">classES</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;duplicated index&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;index lenght not equal&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">addlistidx</span><span class="p">(</span><span class="n">classES</span><span class="p">,</span> <span class="n">listValue</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">newindex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nameES</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">swapindex</span><span class="p">(</span><span class="n">newindex</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">filterdic</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Remove `ES.ESValue` from Result that does not match the indexes filter.</span>
<span class="sd">        The filter is a list of tests of the form : &quot;indexvalue.method(parameter) is True&quot;</span>
<span class="sd">        where keyword &quot;method : parameter&quot; are given in the dictionnary. Filters are cumulatives.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **inplace** : boolean (default False) - If True, apply filter to</span>
<span class="sd">        Observation, else return new Observation.</span>
<span class="sd">        - **filterdic** : keyword arguments (keys is a ClassES and value is a dictionnary) .</span>
<span class="sd">                          where dict value contains keyword &quot;method : parameter&quot;</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Observation** : new observation if not inplace, else None.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">setidxf</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">filterdic</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filterdic</span><span class="p">,</span>  <span class="nb">dict</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;filter is not a dictionnary&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ESclass</span><span class="p">,</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">filterdic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">dic</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span>  <span class="nb">dict</span><span class="p">)</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;filter is not a dictionnary&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ESclass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ESclass</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">test</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">setidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">_idxfilter</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="s1">&#39;setidx&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">setidxf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">setidxf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">setidx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">inplace</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setfilter</span><span class="p">(</span><span class="n">setidxf</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">newobs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">()</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">ilist</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setfilter</span><span class="p">(</span><span class="n">setidxf</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">mAtt</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">option</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="k">return</span> <span class="n">newobs</span>

    <span class="nd">@classmethod</span>    
    <span class="k">def</span> <span class="nf">from_bytes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">byt</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate `Observation` object from byte value.</span>
<span class="sd">        </span>
<span class="sd">        *Returns* : `Observation`&#39;&#39;&#39;</span>
        <span class="n">iidx</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">iidxref</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nb_el</span>   <span class="o">=</span>  <span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00001111</span>
        <span class="n">obsref</span>  <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00010000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span>
        <span class="n">code_el</span> <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b11100000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1">#ref_obs = None</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span> 
        <span class="k">if</span> <span class="n">obsref</span><span class="p">:</span> 
            <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>           
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="n">nval</span><span class="o">=-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_el</span><span class="p">):</span>
            <span class="n">tup</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_list_from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">nval</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">nval</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span>   <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">iidx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">:</span> <span class="n">iidxref</span> <span class="o">=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> 
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iidx</span><span class="p">:</span>    <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">iidx</span>
        <span class="k">if</span> <span class="n">iidxref</span><span class="p">:</span>  <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">iidxref</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="c1">#print(&#39;dic : &#39;, dic)</span>
        <span class="k">return</span> <span class="n">Observation</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate `Observation` object from file storage.</span>

<span class="sd">         *Parameters*</span>

<span class="sd">        - **file** : string - file name (with path)</span>

<span class="sd">        *Returns* : `Observation`&#39;&#39;&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">btype</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">btype</span><span class="o">==</span><span class="nb">bytes</span><span class="p">(</span><span class="s1">&#39;{&quot;&#39;</span> <span class="o">+</span><span class="n">ES</span><span class="o">.</span><span class="n">type</span><span class="o">+</span><span class="s1">&#39;&quot;: &quot;&#39;</span> <span class="o">+</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">bjson</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">bjson</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">bjson</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">full</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add empty Result `ES.ESValue` to have a &#39;complete&#39; `Observation`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **inplace** : boolean (default False) - If True, add values to</span>
<span class="sd">        Observation, else return new Observation.</span>
<span class="sd">        - **minind** : boolean (default True) - If True, independent axes are</span>
<span class="sd">        completed with fillvalue, else all axes are completed</span>
<span class="sd">        - **fillvalue** : value used to complete the Observation</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Observation** : new observation if not inplace, else None.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">fillvalue</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">fillvalue</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullVal</span> <span class="c1">#ReesultValue.nullValue()</span>
        <span class="k">if</span> <span class="n">minind</span> <span class="o">==</span> <span class="kc">True</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">newobs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">()</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">ilist</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">mAtt</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">option</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="k">return</span> <span class="n">newobs</span>

    <span class="k">def</span> <span class="nf">iLoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` values for an `ES.ilist.Ilist` index.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idat, iloc, iprp** : `ES.ilist.Ilist` index value</span>
<span class="sd">        - **json** : Boolean (default True) - Return JSON string if True</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict** : dict or JSON of each ES.ESValue (dat, loc, prp, res)  &#39;&#39;&#39;</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;iloc not available &quot;</span><span class="p">)</span>
        <span class="k">try</span> <span class="p">:</span> <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iloc</span><span class="p">([</span><span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="n">dic</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span> <span class="n">dic</span>
        <span class="n">extidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidxtoext</span><span class="p">([</span><span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">])</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">option</span><span class="p">)</span>
        <span class="k">else</span>    <span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
        <span class="k">return</span> <span class="n">dic</span>

    <span class="k">def</span> <span class="nf">indexLoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the index of a `ES.ESValue` in a `ES.ilist.Ilist` index or result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **esValue** : `ES.ESValue`,</span>
<span class="sd">        - **name** : index or result name</span>
<span class="sd">        - **string** : Boolean (default True) - Return type (JSON if True, dict if False)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict or string** : {&#39;full&#39; : indFull, &#39;name&#39; : indName, &#39;value&#39; : indValue }</span>
<span class="sd">            - indFull : integer for the first index value with name and value equality</span>
<span class="sd">            - indName : integer for the first index value with name equality</span>
<span class="sd">            - indFull : integer for the first index value with value equality  &#39;&#39;&#39;</span>
        <span class="k">if</span>   <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span><span class="p">:</span> <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="sd">&#39;&#39;&#39;if   type(esValue)== PropertyValue : lis = self.setProperty</span>
<span class="sd">        elif type(esValue)== LocationValue : lis = self.setLocation</span>
<span class="sd">        elif type(esValue)== DatationValue : lis = self.setDatation</span>
<span class="sd">        elif type(esValue)== ReesultValue   : lis = self.setResult</span>
<span class="sd">        else: return None&#39;&#39;&#39;</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;full&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">return</span> <span class="n">ind</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">string</span> <span class="p">:</span> <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ind</span>

    <span class="k">def</span> <span class="nf">iObsIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` index values for an Observation row.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **ind** : row Observation (equivalent to Result row)</span>
<span class="sd">        - **json** : Boolean (default True) - Return JSON string if True</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : index of each ES.ESValue [idat, iloc, iprp]  &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">tiidx</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valDat</span><span class="p">,</span> <span class="n">valLoc</span><span class="p">,</span> <span class="n">valPrp</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` values for a DatationValue, LocationValue, PropertyValue.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **valdat, valloc, valprp** : DatationValue, LocationValue, PropertyValue</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict** : dict or JSON of each ES.ESValue (dat, loc, prp, res)  &#39;&#39;&#39;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extidxtoi</span><span class="p">([</span><span class="n">DatationValue</span><span class="p">(</span><span class="n">valDat</span><span class="p">),</span><span class="n">LocationValue</span><span class="p">(</span><span class="n">valLoc</span><span class="p">),</span><span class="n">PropertyValue</span><span class="p">(</span><span class="n">valPrp</span><span class="p">)])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iLoc</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">majList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axename</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Modify an attribute (name or value) in an axis list.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **axename** : index or result name</span>
<span class="sd">        - **listVal** : new list of values</span>
<span class="sd">        - **name** : boolean (default True) - True for &#39;name&#39; and False for &#39;value&#39;</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span> <span class="o">=</span> <span class="n">newlistVal</span>

        <span class="sd">&#39;&#39;&#39;if ValueClass == DatationValue and self.setDatation != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setDatation, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.dat_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == LocationValue and self.setLocation != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setLocation, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.loc_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == PropertyValue and self.setProperty != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setProperty, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.prp_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == ReesultValue and self.setResult != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setResult, listVal, name)</span>
<span class="sd">            self.ilist.extval = newlistVal&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">majValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">esValue</span><span class="p">,</span> <span class="n">newEsValue</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Update the value of an existing `ES.ESValue` by a new `ES.ESValue`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **esValue** : ESValue to update</span>
<span class="sd">        - **newEsValue** : new ESValue</span>
<span class="sd">        - **name** : index or result name</span>
<span class="sd">        - **equal** : criteria used to compare ESValue (&#39;full&#39;, &#39;name&#39;, &#39;value&#39;)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Int** : index in the ESSet valueList.  &#39;&#39;&#39;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexLoc</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="p">)[</span><span class="n">equal</span><span class="p">]</span>
        <span class="k">if</span>   <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span><span class="p">:</span> <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">setClass</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="sd">&#39;&#39;&#39;index = self.indexLoc(esValue)[equal]</span>
<span class="sd">        if   type(esValue) == PropertyValue : setClass = self.setProperty</span>
<span class="sd">        elif type(esValue) == LocationValue : setClass = self.setLocation</span>
<span class="sd">        elif type(esValue) == DatationValue : setClass = self.setDatation</span>
<span class="sd">        elif type(esValue) == ReesultValue   : setClass = self.setResult</span>
<span class="sd">        else : setClass = None&#39;&#39;&#39;</span>
        <span class="k">if</span>  <span class="n">setClass</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="n">setClass</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">newEsValue</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span>

    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">switch</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function visualize an `Observation` with line or colormesh.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **switch** : Boolean (default False) - Switch between x and y axis.</span>
<span class="sd">        - **line** : Boolean (default True) - Choice line or colormesh.</span>
<span class="sd">        - **sort** : Boolean (defaut True) - Sort along an axis or not.</span>
<span class="sd">        - **size** : Int (default 5) - Size of the figure to plot.</span>
<span class="sd">        - **marker** : Char (default &#39;o&#39;) - Symbol for each point.</span>
<span class="sd">        - **maxname** : String (default 20) - maximum length for string</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">obx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">numeric</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="n">maxname</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dat&#39;</span> <span class="p">:</span> <span class="n">ext</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;str&#39;</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="n">ext</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ran&#39;</span>
            <span class="k">if</span> <span class="n">switch</span> <span class="p">:</span> <span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">line</span> <span class="p">:</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
                              <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                              <span class="n">hue</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                         <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                         <span class="n">yticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                         <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span> <span class="p">:</span>
                <span class="c1">#obx = obx.set_index(prp = &quot;prptyp&quot;, loc=&quot;locstr&quot;)</span>
                <span class="n">obx</span> <span class="o">=</span> <span class="n">obx</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">prp</span> <span class="o">=</span> <span class="s2">&quot;prpstr&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;locstr&quot;</span><span class="p">)</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">sortby</span><span class="p">([</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span><span class="s2">&quot;prp&quot;</span><span class="p">]</span>
                           <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;prp&quot;</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                                       <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="c1">#obx = obx.set_index(prp = &quot;prptyp&quot;, loc=&quot;locran&quot;)</span>
                <span class="n">obx</span> <span class="o">=</span> <span class="n">obx</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">prp</span> <span class="o">=</span> <span class="s2">&quot;prpstr&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;locran&quot;</span><span class="p">)</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">sortby</span><span class="p">([</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span><span class="s2">&quot;prp&quot;</span><span class="p">]</span>
                           <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;prp&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                                  <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">yticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">[],</span> <span class="n">reindex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Modify the order of `ES.ESValue`.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **order** : list (default []) - Ordered list to follow (0:dat, 1:loc, 2:prp).</span>
<span class="sd">        - **reindex** : boolean (default True) - calculate new index values.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">order</span><span class="p">],</span> <span class="n">reindex</span><span class="o">=</span><span class="n">reindex</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">bytedict</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Export in binary format. </span>
<span class="sd">        </span>
<span class="sd">        *Returns*</span>
<span class="sd">        </span>
<span class="sd">        - **bytes** : binary representation of the `Observation`</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">bytedict</span> <span class="o">|</span> <span class="n">option</span>
        <span class="n">nb</span><span class="o">=</span><span class="mi">0</span> 
        <span class="n">il</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> 
        <span class="n">index</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">:</span> <span class="c1">#!!!!</span>
            <span class="c1">#if name in opt: nb += len(opt[name]) + 1</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> <span class="n">nb</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">+</span> <span class="n">index</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> <span class="n">nb</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">])</span>
        <span class="n">nb</span> <span class="o">+=</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span>
        <span class="n">obsref</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">])</span>
        <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="mb">0b11100000</span> <span class="o">|</span> <span class="p">(</span><span class="n">obsref</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">nb</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">obsref</span><span class="p">:</span>
            <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">]:</span> 
                <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">,</span> <span class="n">typevalue</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">lenidx</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span> 
                    <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">typevalue</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span><span class="p">:</span> 
            <span class="n">iidxref</span><span class="o">=</span><span class="p">{</span><span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">il</span><span class="o">.</span><span class="n">dicidxref</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">iidxref</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">byt</span>

    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate csv file to display `Observation` data.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **file** : string - file name (with path)</span>

<span class="sd">        *Parameters (kwargs)*</span>

<span class="sd">        - **json** : boolean (default True) - Display json for `ES.ESValue`</span>
<span class="sd">        - **name** : boolean (default True) - Display name for `ES.ESValue`</span>
<span class="sd">        - **dat**  : boolean (default True) - Display value for `ES.ESValue.DatationValue`</span>
<span class="sd">        - **loc**  : boolean (default True) - Display value for `ES.ESValue.LocationValue`</span>
<span class="sd">        - **prp**  : boolean (default True) - Display value for `ES.ESValue.PropertyValue`</span>
<span class="sd">        - **res**  : boolean (default True) - Display value for Result `ES.ESValue`</span>
<span class="sd">        - **lenres** : int (default 0) - Number of raws (all if 0)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                  <span class="s1">&#39;prp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;lenres&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_tab</span><span class="p">(</span><span class="o">**</span><span class="n">option</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lign</span> <span class="ow">in</span> <span class="n">tab</span> <span class="p">:</span> 
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">lign</span><span class="p">)</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lign</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">size</span>

    <span class="k">def</span> <span class="nf">to_dataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">_identity</span><span class="p">,</span>
                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Observation&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to pandas.DataFrame with the smallest dimension.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **info** : Boolean (default False) - Generate a specific Coords with Observation characteristics.</span>
<span class="sd">        - **numeric** : Boolean (default False) - Generate a numeric DataArray.Values.</span>
<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes.</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function to apply to the result values</span>
<span class="sd">        - **name** : String (default &#39;Observation&#39;) - Name of the Dataframe</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **pandas.DataFrame**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="n">numeric</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span>
                                  <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span>
                                  <span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate obs file to display `Observation` data.</span>

<span class="sd">         *Parameters (kwargs)*</span>

<span class="sd">        - **file** : string - file name (with path)</span>
<span class="sd">        - **kwargs** : see &#39;to_json&#39; parameters</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Integer** : file lenght (bytes)  &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;encoded&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;json_res_index&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="o">**</span><span class="n">option</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="n">lendata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lendata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lendata</span>

    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Export in Bson or Json format.</span>

<span class="sd">        *Parameters (optional, default value in option attribute)*</span>

<span class="sd">        - **encoded**   : boolean - choice for return format (string/bytes if True, dict else)</span>
<span class="sd">        - **encode_format**  : string - choice for return format (bson, json, cbor)</span>
<span class="sd">        - **json_res_index** : Boolean - include index for Result</span>
<span class="sd">        - **json_param**     : Boolean - include ESObs Parameter</span>
<span class="sd">        - **json_info**      : Boolean - include ESObs Information with all information</span>
<span class="sd">        - **json_info_type** : Boolean - include in ESObs Information the type of ESObs</span>
<span class="sd">        - **json_info_nval** : Boolean - include in ESObs Information the lenght of ESObs</span>
<span class="sd">        - **json_info_box**  : Boolean - include in ESObs Information the bounding box</span>
<span class="sd">        - **json_info_other**: Boolean - include in ESObs Information the other information</span>
<span class="sd">        - **codif** : dict (default ES.codeb). Numerical value for string in CBOR encoder</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **string or dict** : Json string or dict        &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">option2</span> <span class="o">=</span> <span class="n">option</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;encoded&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="c1">#option2 = option | {&#39;encoded&#39;: option[&#39;bjson_bson&#39;]}</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ES</span><span class="o">.</span><span class="n">type</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span> <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span><span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jsonAtt</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderIsDefault</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span> <span class="n">dic</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;if self._indexIsDefault(dic): </span>
<span class="sd">            if &#39;index&#39; in dic: dic.pop(&#39;index&#39;)</span>
<span class="sd">            if &#39;default index&#39; in dic: dic.pop(&#39;default index&#39;)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_param&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">!=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span><span class="p">:</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="n">js2</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">]:</span> <span class="n">js2</span><span class="p">[</span><span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">js2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">js2</span> <span class="o">=</span> <span class="n">dic</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">js2</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bson</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">js2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cbor&#39;</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">cbor2</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">js2</span><span class="p">,</span> <span class="n">datetime_as_timestamp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                               <span class="n">timezone</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">,</span> <span class="n">canonical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dic</span>

    <span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to Numpy array.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes, &#39;flat&#39; : one dimension</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function to apply to the result values</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Numpy array**    &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_xarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Observation&#39;</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to DataArray.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **info** : Boolean (default False) - Generate a specific Coords with Observation characteristics.</span>
<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes, &#39;flat&#39; : one dimension</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function applied to each Result `ES.ESValue`</span>
<span class="sd">        - **numeric** : Boolean (default False) - Generate a numeric DataArray.Values.</span>
<span class="sd">        - **name** : String (default &#39;Observation&#39;) - Name of the xArray</span>
<span class="sd">        - **maxname** : String (default 20) - maximum length for string</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **xarray.DataArray**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;Observation not consistent&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;Observation empty&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="s1">&#39;axe&#39;</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">))</span>
        <span class="n">ilf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">)</span>
        <span class="n">ilf</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="c1">#xList = self._xlist_old(maxname=maxname)</span>
        <span class="n">xList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xlist</span><span class="p">(</span><span class="n">ilf</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="n">maxname</span><span class="p">)</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">xattrs</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;info&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_info_type</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">json_info_nval</span>  <span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_info_box</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">json_info_other</span> <span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;information&quot;</span><span class="p">]}</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xCoord</span><span class="p">(</span><span class="n">xList</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">ilf</span><span class="o">.</span><span class="n">idxref</span><span class="p">,</span> <span class="n">numeric</span><span class="p">)</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">ilf</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">ax</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ilf</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">ilf</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">axe</span><span class="p">]</span> <span class="k">for</span> <span class="n">axe</span> <span class="ow">in</span> <span class="n">ilf</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">numeric</span> <span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">ilf</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">ilf</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">to_float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">ilf</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">ilf</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1">#if numeric : data = ilf._tonumpy(ilf.extval, func = ReesultValue.to_float).reshape(ilf.axeslen)</span>
        <span class="c1">#else : data = ilf._tonumpy(ilf.extval, func=func, **kwargs).reshape(ilf.axeslen)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span> <span class="p">:</span> <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate tabular list to display `Observation` data.</span>

<span class="sd">        *Parameters (kwargs)*</span>

<span class="sd">        - **json** : boolean (default True) - Display json for `ES.ESValue`</span>
<span class="sd">        - **name** : boolean (default True) - Display name for `ES.ESValue`</span>
<span class="sd">        - **dat**  : boolean (default True) - Display value for `ES.ESValue.DatationValue`</span>
<span class="sd">        - **loc**  : boolean (default True) - Display value for `ES.ESValue.LocationValue`</span>
<span class="sd">        - **prp**  : boolean (default True) - Display value for `ES.ESValue.PropertyValue`</span>
<span class="sd">        - **lenres** : Integer (default : 0) - Number of raws (all if 0)</span>
<span class="sd">        - **width** : Integer (default 15) - Number of characters displayed for each attribute.</span>
<span class="sd">        - **tabulate params** : default &#39;tablefmt&#39;: &#39;simple&#39;, &#39;numalign&#39;: &#39;left&#39;, &#39;stralign&#39;: &#39;left&#39;,</span>
<span class="sd">                   &#39;floatfmt&#39;: &#39;.3f&#39; - See tabulate module</span>

<span class="sd">        *Returns* : None &#39;&#39;&#39;</span>
        <span class="n">opttab</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;prp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;lenres&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">optview</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tablefmt&#39;</span><span class="p">:</span> <span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="s1">&#39;numalign&#39;</span><span class="p">:</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="s1">&#39;stralign&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;floatfmt&#39;</span><span class="p">:</span> <span class="s1">&#39;.2f&#39;</span><span class="p">}</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">opttab</span> <span class="o">|</span> <span class="n">optview</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_tab</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">option</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">opttab</span><span class="p">})</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span>
        <span class="n">tab2</span> <span class="o">=</span> <span class="p">[[</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="n">width</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span> <span class="k">else</span> <span class="n">x</span><span class="p">)(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">lig</span><span class="p">]</span> <span class="k">for</span> <span class="n">lig</span> <span class="ow">in</span> <span class="n">tab</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s1">&#39;firstrow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">option</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">optview</span><span class="p">}))</span>

    <span class="k">def</span> <span class="nf">vList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">_identity</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function applied to each `ES.ESValue`</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the values      &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">idxname</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
            <span class="k">else</span> <span class="p">:</span>              <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idxname</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>
            <span class="k">else</span> <span class="p">:</span>              <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>

    <span class="k">def</span> <span class="nf">vListName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value name for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the value name      &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">idxname</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vName</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">idxname</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">))]</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idxname</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vName</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">idxname</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>

    <span class="k">def</span> <span class="nf">vListSimple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of simple value (see `ES.ESValue` vSimple method) for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the simple value      &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="n">idxname</span><span class="p">,</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">vSimple</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">vListValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value (see `ES.ESValue` getValue method) for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the values      &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="n">idxname</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">getValue</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">voxel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Visualize Result `ES.ESValue` in a cube with voxels.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **sort** : Boolean (default False) - Sort along axis.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">obc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sort</span> <span class="p">:</span> <span class="n">obc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">obc</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
        <span class="c1">#obx = obc.to_xarray(numeric = False, func=ReesultValue.isNotNull)</span>
        <span class="n">obx</span> <span class="o">=</span> <span class="n">obc</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">numeric</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ESValue</span><span class="o">.</span><span class="n">isNotNull</span><span class="p">)</span>
        <span class="n">obp</span> <span class="o">=</span> <span class="n">obx</span> <span class="c1">#&gt;=0</span>
        <span class="n">obp</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;locran&#39;</span><span class="p">,</span> <span class="n">dat</span><span class="o">=</span><span class="s1">&#39;datran&#39;</span><span class="p">,</span> <span class="n">prp</span><span class="o">=</span><span class="s1">&#39;prpran&#39;</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">voxels</span><span class="p">(</span><span class="n">obp</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;dat (index)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;loc (index)&#39;</span><span class="p">,</span> <span class="n">zlabel</span><span class="o">=</span><span class="s1">&#39;prp (index)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#%% internal</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_boundingBox</span><span class="p">(</span><span class="n">listValue</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; return a `ES.ESValue.ESValue` object with bounds values&#39;&#39;&#39;</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">listValue</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">listValue</span><span class="p">:</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">boxUnion</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">box</span>

    <span class="sd">&quot;&quot;&quot;@staticmethod </span>
<span class="sd">    def _indexIsDefault(dic):</span>
<span class="sd">        return (&#39;index&#39; in dic and &#39;default index&#39; in dic and dic[&#39;index&#39;]==[dic[&#39;default index&#39;]]) or \</span>
<span class="sd">               (not &#39;index&#39; in dic and &#39;default index&#39; in dic) or \</span>
<span class="sd">               (&#39;index&#39; in dic and len(dic[&#39;index&#39;][0]) &lt;= 1)&quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Create json dict with info datas&#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info_type&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="n">dcinf</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoType</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info_nval&quot;</span><span class="p">]</span> <span class="p">:</span> <span class="n">dcinf</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoNval</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info_box&quot;</span><span class="p">]</span>  <span class="p">:</span> <span class="n">dcinf</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoBox</span><span class="p">(</span><span class="o">**</span><span class="n">option</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info&quot;</span><span class="p">]</span> <span class="ow">or</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_info_other&quot;</span><span class="p">]:</span> <span class="n">dcinf</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_infoOther</span><span class="p">()</span>
        <span class="n">ldel</span> <span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dcinf</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span> <span class="ow">and</span> <span class="p">(</span><span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;null&quot;</span> <span class="ow">or</span> <span class="n">v</span> <span class="o">==</span><span class="s1">&#39;&#39;</span><span class="p">)</span>   <span class="p">:</span> <span class="n">ldel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span> <span class="ow">and</span> <span class="n">v</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullCoor</span>         <span class="p">:</span> <span class="n">ldel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ldel</span> <span class="p">:</span>         <span class="k">del</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dcinf</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>    <span class="k">return</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">ES</span><span class="o">.</span><span class="n">information</span> <span class="p">:</span> <span class="n">dcinf</span> <span class="p">}</span>
        <span class="sd">&#39;&#39;&#39;if len(dcinf) != 0 : dcinf = {ES.information : dcinf }</span>
<span class="sd">        if option[&quot;encoded&quot;] :</span>
<span class="sd">            if len(dcinf) == 0 :    return &quot;&quot;</span>
<span class="sd">            else :                  return json.dumps(dcinf)</span>
<span class="sd">        else: return dcinf&#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">_infoBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">option</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add box informations&#39;s key-value to dict dcinf&#39;&#39;&#39;</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">:</span>
            <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_box</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
            <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">geo_box</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">)</span><span class="o">.</span><span class="n">__geo_interface__</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_box</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">:</span>
            <span class="n">bound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_boundingBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span>
            <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;encode_format&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
                <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_box</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">bound</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                                     <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">bound</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
            <span class="k">else</span> <span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_box</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">bound</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dcinf</span>

    <span class="k">def</span> <span class="nf">_infoNval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add valueList lenght to dict dcinf&#39;&#39;&#39;</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">json_nval</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dcinf</span>

    <span class="k">def</span> <span class="nf">_infoOther</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add other&#39;s information key-value to dict dcinf&#39;&#39;&#39;</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_complet</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">complet</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_score</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">score</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_mRate</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rate</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_dim</span><span class="p">]</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_axes</span><span class="p">]</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">return</span> <span class="n">dcinf</span>

    <span class="k">def</span> <span class="nf">_infoType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Add information&#39;s key-value to dict dcinf&#39;&#39;&#39;</span>
        <span class="n">dcinf</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">json_type_obs</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">typeObs</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">if</span>   <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">json_type</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">multi</span> <span class="o">+</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">dcinf</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">json_type</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span>            <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dcinf</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_isESAtt</span><span class="p">(</span><span class="n">esClass</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;identify if &#39;key&#39; is included in &#39;esClass&#39;</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **esClass** : string for an ESClass attribute</span>
<span class="sd">        - **key** : string to search</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Boolean**        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">mTypeAtt</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_jsonAtt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">option</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; generate a dict with mAtt attributes&#39;&#39;&#39;</span>
        <span class="n">att</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">mTypeAtt</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullValues</span> <span class="p">:</span> <span class="n">att</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">else</span><span class="p">:</span> <span class="n">att</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">return</span> <span class="n">att</span>


    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">_list_from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">,</span> <span class="n">nv</span><span class="o">=-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">lis</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">code_el</span> <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b11100000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span>
        <span class="n">unique</span>  <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00010000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span>        
        <span class="n">code_ES</span> <span class="o">=</span>  <span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00001111</span>
        <span class="c1">#if byt[0:1] == struct.pack(&#39;&lt;B&#39;, 0b11000000):</span>
        <span class="k">if</span> <span class="n">code_el</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">unique</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nv</span><span class="p">):</span>
                <span class="n">lis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">nv</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>  
        <span class="k">if</span> <span class="n">code_el</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">unique</span><span class="p">:</span>
            <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">code_ES</span><span class="p">):</span>
                <span class="n">dic</span><span class="p">[</span><span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">code_ES</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dic</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">,</span>    <span class="kc">True</span><span class="p">)</span>
        <span class="n">nameES</span>  <span class="o">=</span> <span class="n">code_ES</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">namevalue</span>
        <span class="n">mini</span>    <span class="o">=</span> <span class="n">code_ES</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">minivalue</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">nval</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">unique</span><span class="p">:</span> 
            <span class="n">nval</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">code_el</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">],</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_value</span><span class="p">]]:</span>
            <span class="n">code_el</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nval</span><span class="p">):</span>
            <span class="n">esVal</span> <span class="o">=</span> <span class="n">_classval</span><span class="p">()[</span><span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">code_el</span><span class="p">]]()</span>
            <span class="k">if</span> <span class="n">nameES</span> <span class="ow">and</span> <span class="n">mini</span><span class="p">:</span> 
                <span class="n">n</span> <span class="o">=</span> <span class="n">esVal</span><span class="o">.</span><span class="n">_from_strBytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:</span><span class="n">idx</span><span class="o">+</span><span class="n">ES</span><span class="o">.</span><span class="n">miniStr</span><span class="p">],</span> <span class="n">simple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">nameES</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mini</span><span class="p">:</span> 
                <span class="n">n</span> <span class="o">=</span> <span class="n">esVal</span><span class="o">.</span><span class="n">_from_strBytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">simple</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">code_el</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]:</span> 
                <span class="n">n</span> <span class="o">=</span> <span class="n">esVal</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">ES</span><span class="o">.</span><span class="n">invProp</span><span class="p">[</span><span class="n">code_ES</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">n</span> <span class="o">=</span> <span class="n">esVal</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">mini</span><span class="p">)</span>
            <span class="n">lis</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">esVal</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="n">n</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">lis</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">code_el</span><span class="p">],</span> <span class="n">nameES</span><span class="p">)</span>  

    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">_list_to_bytes</span><span class="p">(</span><span class="n">eslist</span><span class="p">,</span> <span class="n">classES</span><span class="p">,</span> <span class="n">typevalue</span><span class="p">):</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">eslist</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> 
        <span class="n">arg</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">prop</span><span class="p">:</span>        
            <span class="n">arg</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">prop</span><span class="p">[</span><span class="n">typevalue</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">codeEl</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_value</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">codevalue</span><span class="p">:</span>   
            <span class="n">arg</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">codevalue</span><span class="p">[</span><span class="n">typevalue</span><span class="p">]</span>
            <span class="n">codeEl</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">classES</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">]:</span> <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;typevalue not consistent&quot;</span><span class="p">)</span>
        <span class="n">mini</span> <span class="o">=</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">codevalue</span> <span class="ow">and</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">minivalue</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">codevalue</span> <span class="ow">and</span> <span class="n">arg</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">namevalue</span>        
        <span class="k">if</span> <span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> 
            <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="mb">0b11000000</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">:</span> 
            <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="nb">len</span><span class="p">(</span><span class="n">eslist</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">codeEl</span> <span class="o">&lt;&lt;</span> <span class="mi">5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">unique</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">arg</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">unique</span> <span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">eslist</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">and</span> <span class="n">mini</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">_to_strBytes</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mini</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">mini</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">_to_strBytes</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mini</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">classES</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">typevalue</span><span class="p">)</span> 
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>        
        <span class="k">elif</span> <span class="n">typevalue</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
                <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">eslist</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="n">val</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="n">mini</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">byt</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_majList</span><span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; update value or name in a list of `ES.ESValue` &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="p">:</span>   <span class="k">return</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majListName</span> <span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span>      <span class="k">return</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majListValue</span><span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_majListName</span><span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; update name in a list of `ES.ESValue` &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;inconsistent length of the lists : &quot;</span> <span class="o">+</span>
                                   <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; and &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">)))</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span><span class="n">newlistVal</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">listVal</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_majListValue</span><span class="p">(</span><span class="n">listVal</span><span class="p">,</span> <span class="n">newlistVal</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; update value in a list of `ES.ESValue` &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">newlistVal</span><span class="p">)</span> <span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">])(</span><span class="n">newlistVal</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">listVal</span>

    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">_orderIsDefault</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">order</span> <span class="ow">in</span> <span class="p">[[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">],</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">],</span>
                         <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">],</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">]]</span>

    <span class="k">def</span> <span class="nf">_to_tab</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; data preparation for view or csv export&#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                  <span class="s1">&#39;prp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;lenres&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">json</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">prp</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">lenres</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">option</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">==</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">resList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;datation&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;dat name&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dat</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;dat instant&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;loc name&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">loc</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;loc coor x&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">loc</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;loc coor y&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;property&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;prop name&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">prp</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;prop type&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;result&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;res name&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">res</span> <span class="p">:</span>  <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;res value&#39;</span><span class="p">)</span>
        <span class="n">tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resList</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lenres</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">lenres</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">lenres</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">)))</span> <span class="p">:</span>
            <span class="n">resList</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">idat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">idat</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">idat</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dat</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">idat</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">vSimple</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">iloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iloc</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iloc</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">loc</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iloc</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">vSimple</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">loc</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iloc</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">vSimple</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="n">iprp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iprp</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iprp</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">prp</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">iprp</span><span class="p">][</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">simple</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encode_format</span><span class="o">=</span><span class="s1">&#39;json&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">name</span> <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">res</span>  <span class="p">:</span> <span class="n">resList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            <span class="n">tab</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resList</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tab</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_xCoord</span><span class="p">(</span><span class="n">xList</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">idxref</span><span class="p">,</span> <span class="n">numeric</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39; Coords generation for Xarray&#39;&#39;&#39;</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">xList</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;res&#39;</span> <span class="p">:</span>
                <span class="n">axe</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">idxref</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">nax</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]]]]</span>
                <span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">axe</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">attrs</span><span class="p">[</span><span class="n">key</span><span class="p">[:</span><span class="mi">3</span><span class="p">]])</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;loclon&#39;</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;loclat&#39;</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">val</span><span class="p">,</span> <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">numeric</span> <span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;loc&#39;</span> <span class="ow">in</span> <span class="n">coord</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;locran&#39;</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;dat&#39;</span> <span class="ow">in</span> <span class="n">coord</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datins&#39;</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="s1">&#39;prp&#39;</span> <span class="ow">in</span> <span class="n">coord</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="p">:</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prpran&#39;</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">coord</span>

    <span class="sd">&quot;&quot;&quot;def _xlist_old(self, maxname=0):</span>
<span class="sd">        &#39;&#39;&#39;list generation for Xarray&#39;&#39;&#39;</span>
<span class="sd">        xList = {}</span>
<span class="sd">        if self.setLocation != None and len(self.setLocation) &gt; 1:</span>
<span class="sd">            xList[&#39;loc&#39;]    = self.ilist._tonumpy(self.setLocation)</span>
<span class="sd">            xList[&#39;locstr&#39;] = self.ilist._tonumpy(self.setLocation, func = LocationValue.json)</span>
<span class="sd">            xList[&#39;loclon&#39;] = self.ilist._tonumpy(self.setLocation, func = LocationValue.vPointX)</span>
<span class="sd">            xList[&#39;loclat&#39;] = self.ilist._tonumpy(self.setLocation, func = LocationValue.vPointY)</span>
<span class="sd">            xList[&#39;locnam&#39;] = self.ilist._tonumpy(self.setLocation, func = LocationValue.vName)</span>
<span class="sd">            xList[&#39;locran&#39;] = np.arange(len(xList[&#39;loc&#39;]))</span>
<span class="sd">        if self.setDatation != None and len(self.setDatation) &gt; 1:</span>
<span class="sd">            xList[&#39;dat&#39;]    = self.ilist._tonumpy(self.setDatation)</span>
<span class="sd">            xList[&#39;datstr&#39;] = self.ilist._tonumpy(self.setDatation, func = DatationValue.json)</span>
<span class="sd">            xList[&#39;datins&#39;] = self.ilist._tonumpy(self.setDatation, func = DatationValue.vSimple)</span>
<span class="sd">            xList[&#39;datnam&#39;] = self.ilist._tonumpy(self.setDatation, func = DatationValue.vName)</span>
<span class="sd">            xList[&#39;datran&#39;] = np.arange(len(xList[&#39;dat&#39;]))</span>
<span class="sd">        if self.setProperty != None and len(self.setProperty) &gt; 1:</span>
<span class="sd">            xList[&#39;prp&#39;]    = self.ilist._tonumpy(self.setProperty)</span>
<span class="sd">            xList[&#39;prpstr&#39;] = self.ilist._tonumpy(self.setProperty, func = PropertyValue.json)</span>
<span class="sd">            xList[&#39;prptyp&#39;] = self.ilist._tonumpy(self.setProperty, func = PropertyValue.vSimple)</span>
<span class="sd">            xList[&#39;prpnam&#39;] = self.ilist._tonumpy(self.setProperty, func = PropertyValue.vName)</span>
<span class="sd">            xList[&#39;prpran&#39;] = np.arange(len(xList[&#39;prp&#39;]))</span>
<span class="sd">        if maxname &gt; 0 :</span>
<span class="sd">            for key,lis in xList.items() :</span>
<span class="sd">                if key[3:6] in [&#39;str&#39;, &#39;nam&#39;, &#39;typ&#39;]:</span>
<span class="sd">                    for i in range(len(lis)) : lis[i] = lis[i][0:maxname]</span>
<span class="sd">        return xList&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span> 
    <span class="k">def</span> <span class="nf">_xlist</span><span class="p">(</span><span class="n">il</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;list generation for Xarray&#39;&#39;&#39;</span>
        <span class="n">xList</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">setLocation</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">setname</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">setLocation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;locstr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="o">.</span><span class="n">json</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;loclon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="o">.</span><span class="n">vPointX</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;loclat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="o">.</span><span class="n">vPointY</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;locnam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="o">.</span><span class="n">vName</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;locran&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xList</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]))</span>
        <span class="n">setDatation</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">setname</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">setDatation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setDatation</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datstr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="o">.</span><span class="n">json</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datins&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="o">.</span><span class="n">vSimple</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datnam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="o">.</span><span class="n">vName</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;datran&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xList</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]))</span>
        <span class="n">setProperty</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">setname</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">setProperty</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setProperty</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prpstr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="o">.</span><span class="n">json</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prptyp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="o">.</span><span class="n">vSimple</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prpnam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">il</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="o">.</span><span class="n">vName</span><span class="p">)</span>
            <span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prpran&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xList</span><span class="p">[</span><span class="s1">&#39;prp&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">maxname</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">lis</span> <span class="ow">in</span> <span class="n">xList</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="s1">&#39;nam&#39;</span><span class="p">,</span> <span class="s1">&#39;typ&#39;</span><span class="p">]:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">))</span> <span class="p">:</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="n">maxname</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">xList</span>
</pre></div>

        </details>

            <div class="docstring"><p>An <code><a href="#Observation">Observation</a></code> is made up of <code><a href="ilist.html">ES.ilist</a></code> object which describe the axes of this object.</p>

<p><em>Attributes (for @property see methods)</em> :</p>

<ul>
<li><strong>option</strong> : Dictionnary with options</li>
<li><strong>ilist</strong> : Ilist object (data and axes)</li>
<li><strong>name</strong> : textual description</li>
<li><strong>mAtt</strong> : namedValue dictionnary (internal parameters)</li>
<li><strong>parameter</strong> : namedValue dictionnary (external data)</li>
</ul>

<p>The methods defined in this class are :</p>

<p><em>property (getters)</em></p>

<ul>
<li><code><a href="#Observation.axes">Observation.axes</a></code></li>
<li><code><a href="#Observation.bounds">Observation.bounds</a></code></li>
<li><code><a href="#Observation.complet">Observation.complet</a></code></li>
<li><code><a href="#Observation.consistent">Observation.consistent</a></code></li>
<li><code><a href="#Observation.dimension">Observation.dimension</a></code></li>
<li><code><a href="#Observation.json">Observation.json</a></code></li>
<li><code><a href="#Observation.jsonFeature">Observation.jsonFeature</a></code></li>
<li><code><a href="#Observation.nValueObs">Observation.nValueObs</a></code></li>
<li><code><a href="#Observation.rate">Observation.rate</a></code></li>
<li><code><a href="#Observation.score">Observation.score</a></code></li>
<li><code><a href="#Observation.setDatation">Observation.setDatation</a></code></li>
<li><code><a href="#Observation.setLocation">Observation.setLocation</a></code></li>
<li><code><a href="#Observation.setProperty">Observation.setProperty</a></code></li>
<li><code><a href="#Observation.setResult">Observation.setResult</a></code></li>
<li><code><a href="#Observation.typeObs">Observation.typeObs</a></code></li>
</ul>

<p><em>getters</em></p>

<ul>
<li><code><a href="#Observation.vList">Observation.vList</a></code></li>
<li><code><a href="#Observation.vListName">Observation.vListName</a></code></li>
<li><code><a href="#Observation.vListSimple">Observation.vListSimple</a></code></li>
<li><code><a href="#Observation.vListValue">Observation.vListValue</a></code></li>
</ul>

<p><em>add value</em></p>

<ul>
<li><code><a href="#Observation.addAttributes">Observation.addAttributes</a></code></li>
<li><code><a href="#Observation.addJson">Observation.addJson</a></code></li>
<li><code><a href="#Observation.append">Observation.append</a></code></li>
<li><code><a href="#Observation.appendList">Observation.appendList</a></code></li>
<li><code><a href="#Observation.appendObs">Observation.appendObs</a></code></li>
</ul>

<p><em>update value</em></p>

<ul>
<li><code><a href="#Observation.majList">Observation.majList</a></code></li>
<li><code><a href="#Observation.majValue">Observation.majValue</a></code></li>
</ul>

<p><em>selecting</em></p>

<ul>
<li><code><a href="#Observation.indexLoc">Observation.indexLoc</a></code></li>
<li><code><a href="#Observation.iLoc">Observation.iLoc</a></code></li>
<li><code><a href="#Observation.iObsIndex">Observation.iObsIndex</a></code></li>
<li><code><a href="#Observation.loc">Observation.loc</a></code></li>
</ul>

<p><em>management</em></p>

<ul>
<li><code><a href="#Observation.extend">Observation.extend</a></code></li>
<li><code><a href="#Observation.filter">Observation.filter</a></code></li>
<li><code><a href="#Observation.full">Observation.full</a></code></li>
<li><code><a href="#Observation.sort">Observation.sort</a></code></li>
</ul>

<p><em>visualization</em></p>

<ul>
<li><code><a href="#Observation.choropleth">Observation.choropleth</a></code></li>
<li><code><a href="#Observation.voxel">Observation.voxel</a></code></li>
<li><code><a href="#Observation.plot">Observation.plot</a></code></li>
<li><code><a href="#Observation.view">Observation.view</a></code></li>
</ul>

<p><em>exports - imports</em></p>

<ul>
<li><code><a href="#Observation.from_file">Observation.from_file</a></code></li>
<li><code><a href="#Observation.to_csv">Observation.to_csv</a></code></li>
<li><code><a href="#Observation.to_dataFrame">Observation.to_dataFrame</a></code></li>
<li><code><a href="#Observation.to_json">Observation.to_json</a></code></li>
<li><code><a href="#Observation.to_numpy">Observation.to_numpy</a></code></li>
<li><code><a href="#Observation.to_file">Observation.to_file</a></code></li>
<li><code><a href="#Observation.to_xarray">Observation.to_xarray</a></code></li>
<li><code><a href="#Observation.to_bytes">Observation.to_bytes</a></code>              # à voir</li>
<li><code><a href="#Observation.from_bytes">Observation.from_bytes</a></code>            # à voir</li>
</ul>
</div>


                            <div id="Observation.__init__" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.__init__">#&nbsp;&nbsp</a>

        
            <span class="name">Observation</span><span class="signature">(*args, order=[], idxref={}, **kwargs)</span>
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">idxref</span> <span class="o">=</span> <span class="p">{},</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Several Observation creation modes :</span>

<span class="sd">        - Observation(dictESValue1, dictESValue2, ...) where dictESValue = {ESValuename : value}</span>
<span class="sd">        - Observation({ObsDict}) where ObsDict is a dictionnary with the same data as an ObsJSON</span>
<span class="sd">        - Observation(ObsJSON) where ObsJSON is a string with the JSON format</span>
<span class="sd">        - Observation(ObsBSON) where ObsBSON is a bytes with the BSON format</span>
<span class="sd">        - Observation([ESSetDatation, ESSetLocation, ESSetProperty, ESSetResult]) where ESSet is a list of ESValue :</span>
<span class="sd">            [ESValue1, ESValue2,...] or [ESValue] or ESValue</span>
<span class="sd">        - Observation(datation=ESSetDatation, location=ESSetLocation,</span>
<span class="sd">                      property=ESSetProperty, result=ESSetResult)</span>

<span class="sd">        *Note : the parameters &#39;idxref&#39; and &#39;order&#39; are used only when an ESSetResult without Index is in arguments.</span>
<span class="sd">        &#39;order&#39; indicates the order for the Index creation and &#39;idxref&#39; the linked index (0 for Datation, 1 for Location, 2 for Property).*</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">kwargs</span> <span class="o">|=</span> <span class="p">{</span><span class="s1">&#39;order&#39;</span> <span class="p">:</span> <span class="n">order</span><span class="p">,</span> <span class="s1">&#39;idxref&#39;</span> <span class="p">:</span> <span class="n">idxref</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;observation du &quot;</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">mOption</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>        <span class="c1"># json</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">Ilist</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1">#self.mAtt[ES.obs_reference] = 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullVal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_resultTime</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initObs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Several Observation creation modes :</p>

<ul>
<li>Observation(dictESValue1, dictESValue2, ...) where dictESValue = {ESValuename : value}</li>
<li>Observation({ObsDict}) where ObsDict is a dictionnary with the same data as an ObsJSON</li>
<li>Observation(ObsJSON) where ObsJSON is a string with the JSON format</li>
<li>Observation(ObsBSON) where ObsBSON is a bytes with the BSON format</li>
<li>Observation([ESSetDatation, ESSetLocation, ESSetProperty, ESSetResult]) where ESSet is a list of ESValue :
[ESValue1, ESValue2,...] or [ESValue] or ESValue</li>
<li>Observation(datation=ESSetDatation, location=ESSetLocation,
          property=ESSetProperty, result=ESSetResult)</li>
</ul>

<p><em>Note : the parameters 'idxref' and 'order' are used only when an ESSetResult without Index is in arguments.
'order' indicates the order for the Index creation and 'idxref' the linked index (0 for Datation, 1 for Location, 2 for Property).</em></p>
</div>


                            </div>
                            <div id="Observation.Ilist" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.Ilist">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">Ilist</span><span class="signature">(cls, ilist, name=&#39;&#39;, option=None, parameter=None, mAtt=None)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">Ilist</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">ilist</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mAtt</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">()</span>
        <span class="n">obs</span><span class="o">.</span><span class="n">ilist</span> <span class="o">=</span> <span class="n">ilist</span> 
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">option</span> <span class="o">|=</span> <span class="n">option</span>
        <span class="k">if</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span> 
        <span class="k">if</span> <span class="n">mAtt</span><span class="p">:</span> <span class="n">obs</span><span class="o">.</span><span class="n">mAtt</span> <span class="o">|=</span> <span class="n">mAtt</span>
        <span class="k">return</span> <span class="n">obs</span>
</pre></div>

        </details>

    

                            </div>
                            <div id="Observation.axes" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.axes">#&nbsp;&nbsp</a>

        <span class="name">axes</span>
    </div>

    
            <div class="docstring"><p><strong>list of integer (@property)</strong> : list of independant axes in the Observation
(0 for Datation, 1 for Location, 2 for Property)</p>
</div>


                            </div>
                            <div id="Observation.bounds" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.bounds">#&nbsp;&nbsp</a>

        <span class="name">bounds</span>
    </div>

    
            <div class="docstring"><p><strong>list of <code><a href="ESValue.html">ES.ESValue</a></code> (@property)</strong> : <code><a href="ESValue.html">ES.ESValue</a></code> bounding box for each axis.</p>
</div>


                            </div>
                            <div id="Observation.complet" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.complet">#&nbsp;&nbsp</a>

        <span class="name">complet</span>
    </div>

    
            <div class="docstring"><p><strong>boolean (@property)</strong> : True if self.ilist is complete (if the number of 
values is consistent with the number of index values)</p>
</div>


                            </div>
                            <div id="Observation.consistent" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.consistent">#&nbsp;&nbsp</a>

        <span class="name">consistent</span>
    </div>

    
            <div class="docstring"><p><strong>boolean (@property)</strong> : True if Observation is consistent (no duplicate index)</p>
</div>


                            </div>
                            <div id="Observation.dimension" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.dimension">#&nbsp;&nbsp</a>

        <span class="name">dimension</span>
    </div>

    
            <div class="docstring"><p><strong>integer (@property)</strong> : number of independant axes in the Observation</p>
</div>


                            </div>
                            <div id="Observation.json" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.json">#&nbsp;&nbsp</a>

        <span class="name">json</span>
    </div>

    
            <div class="docstring"><p><strong>string (@property)</strong> : JSON Observation (ObsJSON format) whit index
and whitout informations</p>
</div>


                            </div>
                            <div id="Observation.jsonFeature" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.jsonFeature">#&nbsp;&nbsp</a>

        <span class="name">jsonFeature</span>
    </div>

    
            <div class="docstring"><p><strong>string (@property)</strong> : "FeatureCollection" with ESSetLocation geometry</p>
</div>


                            </div>
                            <div id="Observation.nValueObs" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.nValueObs">#&nbsp;&nbsp</a>

        <span class="name">nValueObs</span>
    </div>

    
            <div class="docstring"><p><strong>list (@property)</strong> : lenght of axes [datation, location, properety, result].</p>
</div>


                            </div>
                            <div id="Observation.rate" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.rate">#&nbsp;&nbsp</a>

        <span class="name">rate</span>
    </div>

    
            <div class="docstring"><p><strong>float (@property)</strong> : ratio number measure / number measure if complete</p>
</div>


                            </div>
                            <div id="Observation.score" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.score">#&nbsp;&nbsp</a>

        <span class="name">score</span>
    </div>

    
            <div class="docstring"><p><strong>integer (@property)</strong> : Observation type (calculated from dimension , nValueObs and idxref).
The score is a codification of the number of ESValue for each axis.
E.g., score=122 means one PropertyValue (1), several LocationValue (2),
several DatationValue (2)</p>
</div>


                            </div>
                            <div id="Observation.setDatation" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.setDatation">#&nbsp;&nbsp</a>

        <span class="name">setDatation</span>
    </div>

    
            <div class="docstring"><p><strong>list (@property)</strong> : list of values in the datation axis</p>
</div>


                            </div>
                            <div id="Observation.setLocation" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.setLocation">#&nbsp;&nbsp</a>

        <span class="name">setLocation</span>
    </div>

    
            <div class="docstring"><p><strong>list (@property)</strong> : list of values in the location axis</p>
</div>


                            </div>
                            <div id="Observation.setProperty" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.setProperty">#&nbsp;&nbsp</a>

        <span class="name">setProperty</span>
    </div>

    
            <div class="docstring"><p><strong>list (@property)</strong> : list of values in the property axis</p>
</div>


                            </div>
                            <div id="Observation.setResult" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.setResult">#&nbsp;&nbsp</a>

        <span class="name">setResult</span>
    </div>

    
            <div class="docstring"><p><strong>list (@property)</strong> : list of values in the result axis</p>
</div>


                            </div>
                            <div id="Observation.typeObs" class="classattr">
                                            <div class="attr variable"><a class="headerlink" href="#Observation.typeObs">#&nbsp;&nbsp</a>

        <span class="name">typeObs</span>
    </div>

    
            <div class="docstring"><p><strong>string (@property)</strong> : Observation type (calculated from the score)</p>
</div>


                            </div>
                            <div id="Observation.addAttributes" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.addAttributes">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">addAttributes</span><span class="signature">(self, js)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">addAttributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">js</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add informations attached to `Observation`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **js** : Dict - Keys are Observation keys (dict mAtt) or users keys (dict parameter).</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">js</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">dict</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">js</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">information</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_isESAtt</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="ow">or</span>
                                                       <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">reserved</span><span class="p">)</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">parameter</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add informations attached to <code><a href="#Observation">Observation</a></code></p>

<p><em>Parameters</em></p>

<ul>
<li><strong>js</strong> : Dict - Keys are Observation keys (dict mAtt) or users keys (dict parameter).</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.addJson" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.addJson">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">addJson</span><span class="signature">(self, js)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">addJson</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">js</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Complete an empty `Observation` with json data.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **js** : string - ObsJSON data</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span> <span class="n">dic</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">js</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span> <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initDict</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Complete an empty <code><a href="#Observation">Observation</a></code> with json data.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>js</strong> : string - ObsJSON data</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.append" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.append">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">append</span><span class="signature">(self, dat, loc, prp, res, unique=False, equal=&#39;full&#39;, fast=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">prp</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a new `ES.ESValue` to Result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **dat, loc, prp** : compatible Value for an existing or new `ES.ESValue`</span>
<span class="sd">        - **res** : compatible existing or new result `ES.ESValue`</span>
<span class="sd">        - **unique** : boolean (default False), if False, duplicate index is allowed</span>
<span class="sd">        - **equal** : string (default &#39;full&#39;), if &#39;full&#39;, two ESValue are equal</span>
<span class="sd">            if all the attributes are equal, if &#39;name&#39;, two ESValue are equal if only the names are equal.</span>
<span class="sd">        - **fast** : boolean (default False) - Update whith ESValue and whithout reindex, equal=full</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **int** : last index in the result valueList (or 0 if fast).  &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">fast</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="p">[</span><span class="n">dat</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">prp</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">_classval</span><span class="p">():</span> <span class="n">resvalue</span> <span class="o">=</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">resvalue</span> <span class="o">=</span> <span class="n">_classval</span><span class="p">()[</span><span class="n">ESValue</span><span class="o">.</span><span class="n">valClassName</span><span class="p">(</span><span class="n">res</span><span class="p">)](</span><span class="n">res</span><span class="p">)</span>
        <span class="n">datv</span> <span class="o">=</span> <span class="n">DatationValue</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
        <span class="n">locv</span> <span class="o">=</span> <span class="n">LocationValue</span><span class="p">(</span><span class="n">loc</span><span class="p">)</span>
        <span class="n">prpv</span> <span class="o">=</span> <span class="n">PropertyValue</span><span class="p">(</span><span class="n">prp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">equal</span> <span class="o">==</span> <span class="s1">&#39;full&#39;</span><span class="p">:</span>
            <span class="c1">#self.ilist.append(ReesultValue(res),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resvalue</span><span class="p">,</span> <span class="p">[</span><span class="n">datv</span><span class="p">,</span> <span class="n">locv</span><span class="p">,</span> <span class="n">prpv</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">equal</span> <span class="o">==</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">datv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">datv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">locv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">locv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">prpv</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">prpv</span> <span class="o">=</span> <span class="n">val</span>
                    <span class="k">break</span>
            <span class="c1">#self.ilist.append(ReesultValue(res), [datv,locv, prpv], unique=unique, fast=fast)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resvalue</span><span class="p">,</span> <span class="p">[</span><span class="n">datv</span><span class="p">,</span><span class="n">locv</span><span class="p">,</span> <span class="n">prpv</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">fast</span><span class="o">=</span><span class="n">fast</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a new <code><a href="ESValue.html">ES.ESValue</a></code> to Result</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>dat, loc, prp</strong> : compatible Value for an existing or new <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>res</strong> : compatible existing or new result <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>unique</strong> : boolean (default False), if False, duplicate index is allowed</li>
<li><strong>equal</strong> : string (default 'full'), if 'full', two ESValue are equal
if all the attributes are equal, if 'name', two ESValue are equal if only the names are equal.</li>
<li><strong>fast</strong> : boolean (default False) - Update whith ESValue and whithout reindex, equal=full</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>int</strong> : last index in the result valueList (or 0 if fast).</li>
</ul>
</div>


                            </div>
                            <div id="Observation.appendList" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.appendList">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">appendList</span><span class="signature">(self, listDat, listLoc, listPrp, listVal, unique=False, equal=&#39;full&#39;)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">appendList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listDat</span><span class="p">,</span> <span class="n">listLoc</span><span class="p">,</span> <span class="n">listPrp</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add a list of new `ES.ESValue` to Result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **listVal** : list of ES.ESValue compatible type</span>
<span class="sd">        - **listDat, listLoc, listPrp** : list of index or Value to define a `ES.ESValue`</span>
<span class="sd">        - **unique** : boolean (default False), if False, duplicate index is allowed</span>
<span class="sd">        - **equal** : string (default &#39;full&#39;), if &#39;full&#39;, two ESValue are equal if all the attributes are equal,</span>
<span class="sd">        if &#39;name&#39;, two ESValue are equal if only the names are equal.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listDat</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listLoc</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">listPrp</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listVal</span><span class="p">))</span> <span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listDat</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listLoc</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listPrp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">listVal</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="n">equal</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add a list of new <code><a href="ESValue.html">ES.ESValue</a></code> to Result</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>listVal</strong> : list of <a href="ESValue.html">ES.ESValue</a> compatible type</li>
<li><strong>listDat, listLoc, listPrp</strong> : list of index or Value to define a <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>unique</strong> : boolean (default False), if False, duplicate index is allowed</li>
<li><strong>equal</strong> : string (default 'full'), if 'full', two ESValue are equal if all the attributes are equal,
if 'name', two ESValue are equal if only the names are equal.</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.appendObs" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.appendObs">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">appendObs</span><span class="signature">(self, obs, unique=False, equal=&#39;full&#39;)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">appendObs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">unique</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add an `Observation` as a new Result `ES.ESValue` with bounding box for the Index `ES.ESValue`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **obs** : Observation</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **int** : last index in the `Observation`</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">#return self.append(obs.bounds[0], obs.bounds[1], obs.bounds[2], obs, unique=unique, equal=equal)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">obs</span><span class="o">.</span><span class="n">bounds</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">ExternValue</span><span class="p">(</span><span class="n">obs</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="n">unique</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="n">equal</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add an <code><a href="#Observation">Observation</a></code> as a new Result <code><a href="ESValue.html">ES.ESValue</a></code> with bounding box for the Index <code><a href="ESValue.html">ES.ESValue</a></code></p>

<p><em>Parameters</em></p>

<ul>
<li><strong>obs</strong> : Observation</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>int</strong> : last index in the <code><a href="#Observation">Observation</a></code></li>
</ul>
</div>


                            </div>
                            <div id="Observation.choropleth" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.choropleth">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">choropleth</span><span class="signature">(self, name=&#39;choropleth&#39;)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">choropleth</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;choropleth&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Display `Observation` on a folium.Map (only with dim=1)</span>

<span class="sd">        - **name** : String, optionnal (default &#39;choropleth&#39;) - Name of the choropleth</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **folium.Map**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimension</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
            <span class="n">m</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">coorInv</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">Choropleth</span><span class="p">(</span>
                <span class="n">geo_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">jsonFeature</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dataFrame</span><span class="p">(</span><span class="n">numeric</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
                <span class="n">key_on</span><span class="o">=</span><span class="s2">&quot;feature.id&quot;</span><span class="p">,</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;locran&#39;</span><span class="p">,</span> <span class="s1">&#39;Observation&#39;</span><span class="p">],</span>
                <span class="n">fill_color</span><span class="o">=</span><span class="s2">&quot;OrRd&quot;</span><span class="p">,</span>
                <span class="n">fill_opacity</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span>
                <span class="n">line_opacity</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
                <span class="n">line_weight</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                <span class="n">legend_name</span><span class="o">=</span><span class="s2">&quot;test choropleth&quot;</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">PolyLine</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">LocationValue</span><span class="o">.</span><span class="n">vPointInv</span><span class="p">)</span>
            <span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="n">folium</span><span class="o">.</span><span class="n">LayerControl</span><span class="p">()</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">m</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>

        </details>

            <div class="docstring"><p>Display <code><a href="#Observation">Observation</a></code> on a folium.Map (only with dim=1)</p>

<ul>
<li><strong>name</strong> : String, optionnal (default 'choropleth') - Name of the choropleth</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>folium.Map</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.extend" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.extend">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">extend</span><span class="signature">(self, classES, listValue, index)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">classES</span><span class="p">,</span> <span class="n">listValue</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Copy axis from other `Observation` to self `Observation` (if it daesn&#39;t exist)</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **other** : object Observation to copy</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">classES</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;duplicated index&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;index lenght not equal&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">addlistidx</span><span class="p">(</span><span class="n">classES</span><span class="p">,</span> <span class="n">listValue</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">newindex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">nameES</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span> <span class="ow">in</span> <span class="n">nameES</span><span class="p">:</span> <span class="n">newindex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nameES</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">swapindex</span><span class="p">(</span><span class="n">newindex</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Copy axis from other <code><a href="#Observation">Observation</a></code> to self <code><a href="#Observation">Observation</a></code> (if it daesn't exist)</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>other</strong> : object Observation to copy</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.filter" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.filter">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">filter</span><span class="signature">(self, inplace=False, **filterdic)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">filterdic</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Remove `ES.ESValue` from Result that does not match the indexes filter.</span>
<span class="sd">        The filter is a list of tests of the form : &quot;indexvalue.method(parameter) is True&quot;</span>
<span class="sd">        where keyword &quot;method : parameter&quot; are given in the dictionnary. Filters are cumulatives.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **inplace** : boolean (default False) - If True, apply filter to</span>
<span class="sd">        Observation, else return new Observation.</span>
<span class="sd">        - **filterdic** : keyword arguments (keys is a ClassES and value is a dictionnary) .</span>
<span class="sd">                          where dict value contains keyword &quot;method : parameter&quot;</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Observation** : new observation if not inplace, else None.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">setidxf</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">filterdic</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filterdic</span><span class="p">,</span>  <span class="nb">dict</span><span class="p">)</span> <span class="p">:</span>
            <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;filter is not a dictionnary&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ESclass</span><span class="p">,</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">filterdic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">dic</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">,</span>  <span class="nb">dict</span><span class="p">)</span> <span class="p">:</span>
                <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;filter is not a dictionnary&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ESclass</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ES</span><span class="o">.</span><span class="n">esObsClass</span> <span class="p">:</span> <span class="k">continue</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ESclass</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">test</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">setidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">_idxfilter</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="s1">&#39;setidx&#39;</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                <span class="n">setidxf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">setidxf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">setidx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">inplace</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setfilter</span><span class="p">(</span><span class="n">setidxf</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">newobs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">()</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">ilist</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setfilter</span><span class="p">(</span><span class="n">setidxf</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">mAtt</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">option</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="k">return</span> <span class="n">newobs</span>
</pre></div>

        </details>

            <div class="docstring"><p>Remove <code><a href="ESValue.html">ES.ESValue</a></code> from Result that does not match the indexes filter.
The filter is a list of tests of the form : "indexvalue.method(parameter) is True"
where keyword "method : parameter" are given in the dictionnary. Filters are cumulatives.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>inplace</strong> : boolean (default False) - If True, apply filter to
Observation, else return new Observation.</li>
<li><strong>filterdic</strong> : keyword arguments (keys is a ClassES and value is a dictionnary) .
              where dict value contains keyword "method : parameter"</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>Observation</strong> : new observation if not inplace, else None.</li>
</ul>
</div>


                            </div>
                            <div id="Observation.from_bytes" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.from_bytes">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_bytes</span><span class="signature">(cls, byt)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="nd">@classmethod</span>    
    <span class="k">def</span> <span class="nf">from_bytes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">byt</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate `Observation` object from byte value.</span>
<span class="sd">        </span>
<span class="sd">        *Returns* : `Observation`&#39;&#39;&#39;</span>
        <span class="n">iidx</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">iidxref</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nb_el</span>   <span class="o">=</span>  <span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00001111</span>
        <span class="n">obsref</span>  <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b00010000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">4</span>
        <span class="n">code_el</span> <span class="o">=</span> <span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&amp;</span> <span class="mb">0b11100000</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">5</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="c1">#ref_obs = None</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{}</span> 
        <span class="k">if</span> <span class="n">obsref</span><span class="p">:</span> 
            <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">]</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span><span class="n">byt</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>           
            <span class="n">idx</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="n">nval</span><span class="o">=-</span><span class="mi">1</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_el</span><span class="p">):</span>
            <span class="n">tup</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_list_from_bytes</span><span class="p">(</span><span class="n">byt</span><span class="p">[</span><span class="n">idx</span><span class="p">:],</span> <span class="n">nval</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span> <span class="n">nval</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span>   <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">:</span> <span class="n">iidx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">:</span> <span class="n">iidxref</span> <span class="o">=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">=</span> <span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">tup</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span> 
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span> <span class="n">dic</span><span class="p">[</span><span class="n">tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">tup</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">iidx</span><span class="p">:</span>    <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">]</span><span class="o">=</span><span class="n">iidx</span>
        <span class="k">if</span> <span class="n">iidxref</span><span class="p">:</span>  <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">invcodeb</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">iidxref</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="c1">#print(&#39;dic : &#39;, dic)</span>
        <span class="k">return</span> <span class="n">Observation</span><span class="p">(</span><span class="n">dic</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate <code><a href="#Observation">Observation</a></code> object from byte value.</p>

<p><em>Returns</em> : <code><a href="#Observation">Observation</a></code></p>
</div>


                            </div>
                            <div id="Observation.from_file" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.from_file">#&nbsp;&nbsp</a>

                <div class="decorator">@classmethod</div>

            <span class="def">def</span>
            <span class="name">from_file</span><span class="signature">(cls, file)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate `Observation` object from file storage.</span>

<span class="sd">         *Parameters*</span>

<span class="sd">        - **file** : string - file name (with path)</span>

<span class="sd">        *Returns* : `Observation`&#39;&#39;&#39;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">btype</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">btype</span><span class="o">==</span><span class="nb">bytes</span><span class="p">(</span><span class="s1">&#39;{&quot;&#39;</span> <span class="o">+</span><span class="n">ES</span><span class="o">.</span><span class="n">type</span><span class="o">+</span><span class="s1">&#39;&quot;: &quot;&#39;</span> <span class="o">+</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span> <span class="o">+</span><span class="s1">&#39;&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">bjson</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">bjson</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">bjson</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate <code><a href="#Observation">Observation</a></code> object from file storage.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>file</strong> : string - file name (with path)</li>
</ul>

<p><em>Returns</em> : <code><a href="#Observation">Observation</a></code></p>
</div>


                            </div>
                            <div id="Observation.full" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.full">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">full</span><span class="signature">(self, minind=True, fillvalue=None, inplace=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">full</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">minind</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add empty Result `ES.ESValue` to have a &#39;complete&#39; `Observation`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **inplace** : boolean (default False) - If True, add values to</span>
<span class="sd">        Observation, else return new Observation.</span>
<span class="sd">        - **minind** : boolean (default True) - If True, independent axes are</span>
<span class="sd">        completed with fillvalue, else all axes are completed</span>
<span class="sd">        - **fillvalue** : value used to complete the Observation</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Observation** : new observation if not inplace, else None.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">fillvalue</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="n">fillvalue</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullVal</span> <span class="c1">#ReesultValue.nullValue()</span>
        <span class="k">if</span> <span class="n">minind</span> <span class="o">==</span> <span class="kc">True</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inplace</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">newobs</span> <span class="o">=</span> <span class="n">Observation</span><span class="p">()</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">ilist</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">inplace</span><span class="p">)</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">mAtt</span>      <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">newobs</span><span class="o">.</span><span class="n">option</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span>
        <span class="k">return</span> <span class="n">newobs</span>
</pre></div>

        </details>

            <div class="docstring"><p>Add empty Result <code><a href="ESValue.html">ES.ESValue</a></code> to have a 'complete' <code><a href="#Observation">Observation</a></code></p>

<p><em>Parameters</em></p>

<ul>
<li><strong>inplace</strong> : boolean (default False) - If True, add values to
Observation, else return new Observation.</li>
<li><strong>minind</strong> : boolean (default True) - If True, independent axes are
completed with fillvalue, else all axes are completed</li>
<li><strong>fillvalue</strong> : value used to complete the Observation</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>Observation</strong> : new observation if not inplace, else None.</li>
</ul>
</div>


                            </div>
                            <div id="Observation.iLoc" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.iLoc">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">iLoc</span><span class="signature">(self, idat, iloc, iprp, json=True)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">iLoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` values for an `ES.ilist.Ilist` index.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idat, iloc, iprp** : `ES.ilist.Ilist` index value</span>
<span class="sd">        - **json** : Boolean (default True) - Return JSON string if True</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict** : dict or JSON of each ES.ESValue (dat, loc, prp, res)  &#39;&#39;&#39;</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span> <span class="o">!=</span> <span class="mi">3</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;iloc not available &quot;</span><span class="p">)</span>
        <span class="k">try</span> <span class="p">:</span> <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iloc</span><span class="p">([</span><span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">])</span>
        <span class="k">except</span> <span class="p">:</span> <span class="k">return</span> <span class="n">dic</span>
        <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">:</span> <span class="k">return</span> <span class="n">dic</span>
        <span class="n">extidx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">iidxtoext</span><span class="p">([</span><span class="n">idat</span><span class="p">,</span> <span class="n">iloc</span><span class="p">,</span> <span class="n">iprp</span><span class="p">])</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">extidx</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">json</span> <span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">option</span><span class="p">)</span>
        <span class="k">else</span>    <span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>
        <span class="k">return</span> <span class="n">dic</span>
</pre></div>

        </details>

            <div class="docstring"><p>Return the <code><a href="ESValue.html">ES.ESValue</a></code> values for an <code><a href="ilist.html#Ilist">ES.ilist.Ilist</a></code> index.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>idat, iloc, iprp</strong> : <code><a href="ilist.html#Ilist">ES.ilist.Ilist</a></code> index value</li>
<li><strong>json</strong> : Boolean (default True) - Return JSON string if True</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>dict</strong> : dict or JSON of each <a href="ESValue.html">ES.ESValue</a> (dat, loc, prp, res)</li>
</ul>
</div>


                            </div>
                            <div id="Observation.indexLoc" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.indexLoc">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">indexLoc</span><span class="signature">(self, esValue, name, string=True)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">indexLoc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the index of a `ES.ESValue` in a `ES.ilist.Ilist` index or result</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **esValue** : `ES.ESValue`,</span>
<span class="sd">        - **name** : index or result name</span>
<span class="sd">        - **string** : Boolean (default True) - Return type (JSON if True, dict if False)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict or string** : {&#39;full&#39; : indFull, &#39;name&#39; : indName, &#39;value&#39; : indValue }</span>
<span class="sd">            - indFull : integer for the first index value with name and value equality</span>
<span class="sd">            - indName : integer for the first index value with name equality</span>
<span class="sd">            - indFull : integer for the first index value with value equality  &#39;&#39;&#39;</span>
        <span class="k">if</span>   <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">:</span>     <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span><span class="p">:</span> <span class="n">lis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
        <span class="sd">&#39;&#39;&#39;if   type(esValue)== PropertyValue : lis = self.setProperty</span>
<span class="sd">        elif type(esValue)== LocationValue : lis = self.setLocation</span>
<span class="sd">        elif type(esValue)== DatationValue : lis = self.setDatation</span>
<span class="sd">        elif type(esValue)== ReesultValue   : lis = self.setResult</span>
<span class="sd">        else: return None&#39;&#39;&#39;</span>
        <span class="n">ind</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;full&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lis</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;full&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="k">return</span> <span class="n">ind</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="k">if</span> <span class="n">lis</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">isEqual</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="ow">and</span> <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">ind</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">string</span> <span class="p">:</span> <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">ind</span>
</pre></div>

        </details>

            <div class="docstring"><p>Return the index of a <code><a href="ESValue.html">ES.ESValue</a></code> in a <code><a href="ilist.html#Ilist">ES.ilist.Ilist</a></code> index or result</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>esValue</strong> : <code><a href="ESValue.html">ES.ESValue</a></code>,</li>
<li><strong>name</strong> : index or result name</li>
<li><strong>string</strong> : Boolean (default True) - Return type (JSON if True, dict if False)</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>dict or string</strong> : {'full' : indFull, 'name' : indName, 'value' : indValue }
<ul>
<li>indFull : integer for the first index value with name and value equality</li>
<li>indName : integer for the first index value with name equality</li>
<li>indFull : integer for the first index value with value equality</li>
</ul></li>
</ul>
</div>


                            </div>
                            <div id="Observation.iObsIndex" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.iObsIndex">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">iObsIndex</span><span class="signature">(self, ind)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">iObsIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` index values for an Observation row.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **ind** : row Observation (equivalent to Result row)</span>
<span class="sd">        - **json** : Boolean (default True) - Return JSON string if True</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : index of each ES.ESValue [idat, iloc, iprp]  &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">tiidx</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
</pre></div>

        </details>

            <div class="docstring"><p>Return the <code><a href="ESValue.html">ES.ESValue</a></code> index values for an Observation row.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>ind</strong> : row Observation (equivalent to Result row)</li>
<li><strong>json</strong> : Boolean (default True) - Return JSON string if True</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>list</strong> : index of each <a href="ESValue.html">ES.ESValue</a> [idat, iloc, iprp]</li>
</ul>
</div>


                            </div>
                            <div id="Observation.loc" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.loc">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">loc</span><span class="signature">(self, valDat, valLoc, valPrp, json=True)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">valDat</span><span class="p">,</span> <span class="n">valLoc</span><span class="p">,</span> <span class="n">valPrp</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the `ES.ESValue` values for a DatationValue, LocationValue, PropertyValue.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **valdat, valloc, valprp** : DatationValue, LocationValue, PropertyValue</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **dict** : dict or JSON of each ES.ESValue (dat, loc, prp, res)  &#39;&#39;&#39;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extidxtoi</span><span class="p">([</span><span class="n">DatationValue</span><span class="p">(</span><span class="n">valDat</span><span class="p">),</span><span class="n">LocationValue</span><span class="p">(</span><span class="n">valLoc</span><span class="p">),</span><span class="n">PropertyValue</span><span class="p">(</span><span class="n">valPrp</span><span class="p">)])</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">iLoc</span><span class="p">(</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">index</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>

        </details>

            <div class="docstring"><p>Return the <code><a href="ESValue.html">ES.ESValue</a></code> values for a DatationValue, LocationValue, PropertyValue.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>valdat, valloc, valprp</strong> : DatationValue, LocationValue, PropertyValue</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>dict</strong> : dict or JSON of each <a href="ESValue.html">ES.ESValue</a> (dat, loc, prp, res)</li>
</ul>
</div>


                            </div>
                            <div id="Observation.majList" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.majList">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">majList</span><span class="signature">(self, axename, listVal, name=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">majList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axename</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Modify an attribute (name or value) in an axis list.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **axename** : index or result name</span>
<span class="sd">        - **listVal** : new list of values</span>
<span class="sd">        - **name** : boolean (default True) - True for &#39;name&#39; and False for &#39;value&#39;</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">)]</span> <span class="o">=</span> <span class="n">newlistVal</span>
        <span class="k">elif</span> <span class="n">axename</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span> <span class="o">!=</span> <span class="kc">None</span> <span class="p">:</span>
            <span class="n">newlistVal</span> <span class="o">=</span> <span class="n">Observation</span><span class="o">.</span><span class="n">_majList</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setResult</span><span class="p">,</span> <span class="n">listVal</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span> <span class="o">=</span> <span class="n">newlistVal</span>

        <span class="sd">&#39;&#39;&#39;if ValueClass == DatationValue and self.setDatation != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setDatation, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.dat_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == LocationValue and self.setLocation != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setLocation, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.loc_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == PropertyValue and self.setProperty != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setProperty, listVal, name)</span>
<span class="sd">            self.ilist.setidx[self.ilist.idxname.index(ES.prp_classES)] = newlistVal</span>
<span class="sd">        elif ValueClass == ReesultValue and self.setResult != None :</span>
<span class="sd">            newlistVal = Observation._majList(self.setResult, listVal, name)</span>
<span class="sd">            self.ilist.extval = newlistVal&#39;&#39;&#39;</span>
</pre></div>

        </details>

            <div class="docstring"><p>Modify an attribute (name or value) in an axis list.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>axename</strong> : index or result name</li>
<li><strong>listVal</strong> : new list of values</li>
<li><strong>name</strong> : boolean (default True) - True for 'name' and False for 'value'</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.majValue" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.majValue">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">majValue</span><span class="signature">(self, esValue, newEsValue, name, equal=&#39;full&#39;)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">majValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">esValue</span><span class="p">,</span> <span class="n">newEsValue</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">equal</span><span class="o">=</span><span class="s2">&quot;full&quot;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Update the value of an existing `ES.ESValue` by a new `ES.ESValue`</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **esValue** : ESValue to update</span>
<span class="sd">        - **newEsValue** : new ESValue</span>
<span class="sd">        - **name** : index or result name</span>
<span class="sd">        - **equal** : criteria used to compare ESValue (&#39;full&#39;, &#39;name&#39;, &#39;value&#39;)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Int** : index in the ESSet valueList.  &#39;&#39;&#39;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexLoc</span><span class="p">(</span><span class="n">esValue</span><span class="p">,</span> <span class="n">name</span><span class="p">)[</span><span class="n">equal</span><span class="p">]</span>
        <span class="k">if</span>   <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">prp_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setProperty</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">loc_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">dat_classES</span><span class="p">:</span>     <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setDatation</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">valname</span><span class="p">:</span> <span class="n">setClass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">setResult</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">setClass</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="sd">&#39;&#39;&#39;index = self.indexLoc(esValue)[equal]</span>
<span class="sd">        if   type(esValue) == PropertyValue : setClass = self.setProperty</span>
<span class="sd">        elif type(esValue) == LocationValue : setClass = self.setLocation</span>
<span class="sd">        elif type(esValue) == DatationValue : setClass = self.setDatation</span>
<span class="sd">        elif type(esValue) == ReesultValue   : setClass = self.setResult</span>
<span class="sd">        else : setClass = None&#39;&#39;&#39;</span>
        <span class="k">if</span>  <span class="n">setClass</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">index</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span> <span class="n">setClass</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">newEsValue</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">index</span>
</pre></div>

        </details>

            <div class="docstring"><p>Update the value of an existing <code><a href="ESValue.html">ES.ESValue</a></code> by a new <code><a href="ESValue.html">ES.ESValue</a></code></p>

<p><em>Parameters</em></p>

<ul>
<li><strong>esValue</strong> : ESValue to update</li>
<li><strong>newEsValue</strong> : new ESValue</li>
<li><strong>name</strong> : index or result name</li>
<li><strong>equal</strong> : criteria used to compare ESValue ('full', 'name', 'value')</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>Int</strong> : index in the ESSet valueList.</li>
</ul>
</div>


                            </div>
                            <div id="Observation.plot" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.plot">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">plot</span><span class="signature">(
    self,
    switch=False,
    line=True,
    sort=True,
    size=5,
    marker=&#39;o&#39;,
    maxname=20
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">switch</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">line</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">sort</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
             <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function visualize an `Observation` with line or colormesh.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **switch** : Boolean (default False) - Switch between x and y axis.</span>
<span class="sd">        - **line** : Boolean (default True) - Choice line or colormesh.</span>
<span class="sd">        - **sort** : Boolean (defaut True) - Sort along an axis or not.</span>
<span class="sd">        - **size** : Int (default 5) - Size of the figure to plot.</span>
<span class="sd">        - **marker** : Char (default &#39;o&#39;) - Symbol for each point.</span>
<span class="sd">        - **maxname** : String (default 20) - maximum length for string</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**  &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">obx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">numeric</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="n">maxname</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dat&#39;</span> <span class="p">:</span> <span class="n">ext</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;str&#39;</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">dtype</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="n">ext</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ran&#39;</span>
            <span class="k">if</span> <span class="n">switch</span> <span class="p">:</span> <span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="k">if</span> <span class="n">line</span> <span class="p">:</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span>
                              <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                              <span class="n">hue</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span> <span class="p">:</span>
                    <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">y</span><span class="o">=</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                         <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                         <span class="n">yticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">+</span><span class="n">ext</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                         <span class="n">size</span> <span class="o">=</span> <span class="n">size</span><span class="p">)</span>
                <span class="k">except</span> <span class="p">:</span>
                    <span class="n">obx</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">line</span> <span class="p">:</span>
                <span class="c1">#obx = obx.set_index(prp = &quot;prptyp&quot;, loc=&quot;locstr&quot;)</span>
                <span class="n">obx</span> <span class="o">=</span> <span class="n">obx</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">prp</span> <span class="o">=</span> <span class="s2">&quot;prpstr&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;locstr&quot;</span><span class="p">)</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">sortby</span><span class="p">([</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span><span class="s2">&quot;prp&quot;</span><span class="p">]</span>
                           <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;prp&quot;</span><span class="p">,</span> <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span>
                                       <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">else</span> <span class="p">:</span>
                <span class="c1">#obx = obx.set_index(prp = &quot;prptyp&quot;, loc=&quot;locran&quot;)</span>
                <span class="n">obx</span> <span class="o">=</span> <span class="n">obx</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">prp</span> <span class="o">=</span> <span class="s2">&quot;prpstr&quot;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;locran&quot;</span><span class="p">)</span>
                <span class="n">obx</span><span class="o">.</span><span class="n">sortby</span><span class="p">([</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span><span class="s2">&quot;prp&quot;</span><span class="p">]</span>
                           <span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;loc&quot;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s2">&quot;prp&quot;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span>
                                  <span class="n">xticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;dat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">yticks</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">obx</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;loc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>This function visualize an <code><a href="#Observation">Observation</a></code> with line or colormesh.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>switch</strong> : Boolean (default False) - Switch between x and y axis.</li>
<li><strong>line</strong> : Boolean (default True) - Choice line or colormesh.</li>
<li><strong>sort</strong> : Boolean (defaut True) - Sort along an axis or not.</li>
<li><strong>size</strong> : Int (default 5) - Size of the figure to plot.</li>
<li><strong>marker</strong> : Char (default 'o') - Symbol for each point.</li>
<li><strong>maxname</strong> : String (default 20) - maximum length for string</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.sort" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.sort">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">sort</span><span class="signature">(self, order=[], reindex=True)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">[],</span> <span class="n">reindex</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Modify the order of `ES.ESValue`.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **order** : list (default []) - Ordered list to follow (0:dat, 1:loc, 2:prp).</span>
<span class="sd">        - **reindex** : boolean (default True) - calculate new index values.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">order</span><span class="p">],</span> <span class="n">reindex</span><span class="o">=</span><span class="n">reindex</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Modify the order of <code><a href="ESValue.html">ES.ESValue</a></code>.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>order</strong> : list (default []) - Ordered list to follow (0:dat, 1:loc, 2:prp).</li>
<li><strong>reindex</strong> : boolean (default True) - calculate new index values.</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.to_bytes" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.to_bytes">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_bytes</span><span class="signature">(
    self,
    option={&#39;datation&#39;: [&#39;namemini&#39;, &#39;value&#39;], &#39;location&#39;: [&#39;namemini&#39;, &#39;value&#39;], &#39;property&#39;: [&#39;valuemini&#39;], &#39;result&#39;: [&#39;namemini&#39;, &#39;sfloat&#39;], -1: [&#39;namemini&#39;, &#39;value&#39;]}
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">to_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">bytedict</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Export in binary format. </span>
<span class="sd">        </span>
<span class="sd">        *Returns*</span>
<span class="sd">        </span>
<span class="sd">        - **bytes** : binary representation of the `Observation`</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">bytedict</span> <span class="o">|</span> <span class="n">option</span>
        <span class="n">nb</span><span class="o">=</span><span class="mi">0</span> 
        <span class="n">il</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span> 
        <span class="n">index</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">:</span> <span class="c1">#!!!!</span>
            <span class="c1">#if name in opt: nb += len(opt[name]) + 1</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> <span class="n">nb</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">+</span> <span class="n">index</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> <span class="n">nb</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">])</span>
        <span class="n">nb</span> <span class="o">+=</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span>
        <span class="n">obsref</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">])</span>
        <span class="n">byt</span> <span class="o">=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;B&#39;</span><span class="p">,</span> <span class="mb">0b11100000</span> <span class="o">|</span> <span class="p">(</span><span class="n">obsref</span> <span class="o">&lt;&lt;</span> <span class="mi">4</span><span class="p">)</span> <span class="o">|</span> <span class="n">nb</span><span class="p">)</span> 
        <span class="k">if</span> <span class="n">obsref</span><span class="p">:</span>
            <span class="n">byt</span> <span class="o">+=</span> <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&lt;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_reference</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span> 
            <span class="k">for</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">]:</span> 
                <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">il</span><span class="o">.</span><span class="n">valname</span><span class="p">,</span> <span class="n">typevalue</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">lenidx</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">typevalue</span> <span class="ow">in</span> <span class="n">opt</span><span class="p">[</span><span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">]]:</span> 
                    <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">il</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">typevalue</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span><span class="p">:</span> <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">il</span><span class="o">.</span><span class="n">iidx</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">il</span><span class="o">.</span><span class="n">complete</span><span class="p">:</span> 
            <span class="n">iidxref</span><span class="o">=</span><span class="p">{</span><span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">codeb</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">il</span><span class="o">.</span><span class="n">dicidxref</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="n">byt</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_list_to_bytes</span><span class="p">(</span><span class="n">iidxref</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ES</span><span class="o">.</span><span class="n">idxref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">byt</span>
</pre></div>

        </details>

            <div class="docstring"><p>Export in binary format. </p>

<p><em>Returns</em></p>

<ul>
<li><strong>bytes</strong> : binary representation of the <code><a href="#Observation">Observation</a></code></li>
</ul>
</div>


                            </div>
                            <div id="Observation.to_csv" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.to_csv">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_csv</span><span class="signature">(self, file, **kwargs)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate csv file to display `Observation` data.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **file** : string - file name (with path)</span>

<span class="sd">        *Parameters (kwargs)*</span>

<span class="sd">        - **json** : boolean (default True) - Display json for `ES.ESValue`</span>
<span class="sd">        - **name** : boolean (default True) - Display name for `ES.ESValue`</span>
<span class="sd">        - **dat**  : boolean (default True) - Display value for `ES.ESValue.DatationValue`</span>
<span class="sd">        - **loc**  : boolean (default True) - Display value for `ES.ESValue.LocationValue`</span>
<span class="sd">        - **prp**  : boolean (default True) - Display value for `ES.ESValue.PropertyValue`</span>
<span class="sd">        - **res**  : boolean (default True) - Display value for Result `ES.ESValue`</span>
<span class="sd">        - **lenres** : int (default 0) - Number of raws (all if 0)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**        &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                  <span class="s1">&#39;prp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;lenres&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_tab</span><span class="p">(</span><span class="o">**</span><span class="n">option</span><span class="p">)</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csvfile</span><span class="p">:</span>
            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">csvfile</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lign</span> <span class="ow">in</span> <span class="n">tab</span> <span class="p">:</span> 
                <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">lign</span><span class="p">)</span>
                <span class="n">size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lign</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">size</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate csv file to display <code><a href="#Observation">Observation</a></code> data.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>file</strong> : string - file name (with path)</li>
</ul>

<p><em>Parameters (kwargs)</em></p>

<ul>
<li><strong>json</strong> : boolean (default True) - Display json for <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>name</strong> : boolean (default True) - Display name for <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>dat</strong>  : boolean (default True) - Display value for <code><a href="ESValue.html#DatationValue">ES.ESValue.DatationValue</a></code></li>
<li><strong>loc</strong>  : boolean (default True) - Display value for <code><a href="ESValue.html#LocationValue">ES.ESValue.LocationValue</a></code></li>
<li><strong>prp</strong>  : boolean (default True) - Display value for <code><a href="ESValue.html#PropertyValue">ES.ESValue.PropertyValue</a></code></li>
<li><strong>res</strong>  : boolean (default True) - Display value for Result <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>lenres</strong> : int (default 0) - Number of raws (all if 0)</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.to_dataFrame" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.to_dataFrame">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_dataFrame</span><span class="signature">(
    self,
    info=False,
    numeric=False,
    ind=&#39;axe&#39;,
    fillvalue=&#39;?&#39;,
    func=&lt;bound method Es._identity of &lt;ESconstante.Es object at 0x0000020C1DCADEE0&gt;&gt;,
    name=&#39;Observation&#39;
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">to_dataFrame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">_identity</span><span class="p">,</span>
                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Observation&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to pandas.DataFrame with the smallest dimension.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **info** : Boolean (default False) - Generate a specific Coords with Observation characteristics.</span>
<span class="sd">        - **numeric** : Boolean (default False) - Generate a numeric DataArray.Values.</span>
<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes.</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function to apply to the result values</span>
<span class="sd">        - **name** : String (default &#39;Observation&#39;) - Name of the Dataframe</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **pandas.DataFrame**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">info</span><span class="o">=</span><span class="n">info</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="n">numeric</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span>
                                  <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span>
                                  <span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="kc">None</span>
</pre></div>

        </details>

            <div class="docstring"><p>Convert <code><a href="#Observation">Observation</a></code> to pandas.DataFrame with the smallest dimension.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>info</strong> : Boolean (default False) - Generate a specific Coords with Observation characteristics.</li>
<li><strong>numeric</strong> : Boolean (default False) - Generate a numeric DataArray.Values.</li>
<li><strong>ind</strong> : String (default 'axe') - 'axe' only independant axes, 'all' : all the axes.</li>
<li><strong>fillvalue</strong> : Object (default '?') used to complete result</li>
<li><strong>func</strong> : String (default function identity) - Name of the function to apply to the result values</li>
<li><strong>name</strong> : String (default 'Observation') - Name of the Dataframe</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>pandas.DataFrame</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.to_file" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.to_file">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_file</span><span class="signature">(self, file, **kwargs)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">to_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate obs file to display `Observation` data.</span>

<span class="sd">         *Parameters (kwargs)*</span>

<span class="sd">        - **file** : string - file name (with path)</span>
<span class="sd">        - **kwargs** : see &#39;to_json&#39; parameters</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Integer** : file lenght (bytes)  &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">kwargs</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;encoded&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;json_res_index&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="o">**</span><span class="n">option</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="n">lendata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lendata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;UTF-8&#39;</span><span class="p">))</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">lendata</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate obs file to display <code><a href="#Observation">Observation</a></code> data.</p>

<p><em>Parameters (kwargs)</em></p>

<ul>
<li><strong>file</strong> : string - file name (with path)</li>
<li><strong>kwargs</strong> : see 'to_json' parameters</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>Integer</strong> : file lenght (bytes)</li>
</ul>
</div>


                            </div>
                            <div id="Observation.to_json" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.to_json">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_json</span><span class="signature">(self, **kwargs)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Export in Bson or Json format.</span>

<span class="sd">        *Parameters (optional, default value in option attribute)*</span>

<span class="sd">        - **encoded**   : boolean - choice for return format (string/bytes if True, dict else)</span>
<span class="sd">        - **encode_format**  : string - choice for return format (bson, json, cbor)</span>
<span class="sd">        - **json_res_index** : Boolean - include index for Result</span>
<span class="sd">        - **json_param**     : Boolean - include ESObs Parameter</span>
<span class="sd">        - **json_info**      : Boolean - include ESObs Information with all information</span>
<span class="sd">        - **json_info_type** : Boolean - include in ESObs Information the type of ESObs</span>
<span class="sd">        - **json_info_nval** : Boolean - include in ESObs Information the lenght of ESObs</span>
<span class="sd">        - **json_info_box**  : Boolean - include in ESObs Information the bounding box</span>
<span class="sd">        - **json_info_other**: Boolean - include in ESObs Information the other information</span>
<span class="sd">        - **codif** : dict (default ES.codeb). Numerical value for string in CBOR encoder</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **string or dict** : Json string or dict        &#39;&#39;&#39;</span>
        <span class="n">option</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">option</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">option2</span> <span class="o">=</span> <span class="n">option</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;encoded&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="c1">#option2 = option | {&#39;encoded&#39;: option[&#39;bjson_bson&#39;]}</span>
        <span class="n">dic</span> <span class="o">=</span> <span class="p">{</span> <span class="n">ES</span><span class="o">.</span><span class="n">type</span> <span class="p">:</span> <span class="n">ES</span><span class="o">.</span><span class="n">obs_classES</span> <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span><span class="p">:</span> <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mAtt</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">obs_id</span><span class="p">]</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jsonAtt</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">json</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orderIsDefault</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="s1">&#39;order&#39;</span><span class="p">]):</span> <span class="n">dic</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;order&#39;</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;if self._indexIsDefault(dic): </span>
<span class="sd">            if &#39;index&#39; in dic: dic.pop(&#39;index&#39;)</span>
<span class="sd">            if &#39;default index&#39; in dic: dic.pop(&#39;default index&#39;)&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s2">&quot;json_param&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">!=</span> <span class="n">ES</span><span class="o">.</span><span class="n">nullAtt</span><span class="p">:</span>
            <span class="n">dic</span><span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">parameter</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span>
        <span class="n">dic</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info</span><span class="p">(</span><span class="o">**</span><span class="n">option2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="n">js2</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">]:</span> <span class="n">js2</span><span class="p">[</span><span class="n">option</span><span class="p">[</span><span class="s1">&#39;codif&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="k">else</span><span class="p">:</span> <span class="n">js2</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span> <span class="n">js2</span> <span class="o">=</span> <span class="n">dic</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">js2</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="n">ESValueEncoder</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bson&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bson</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">js2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encoded&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;encode_format&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cbor&#39;</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">cbor2</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">js2</span><span class="p">,</span> <span class="n">datetime_as_timestamp</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                               <span class="n">timezone</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">,</span> <span class="n">canonical</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dic</span>
</pre></div>

        </details>

            <div class="docstring"><p>Export in Bson or Json format.</p>

<p><em>Parameters (optional, default value in option attribute)</em></p>

<ul>
<li><strong>encoded</strong>   : boolean - choice for return format (string/bytes if True, dict else)</li>
<li><strong>encode_format</strong>  : string - choice for return format (bson, json, cbor)</li>
<li><strong>json_res_index</strong> : Boolean - include index for Result</li>
<li><strong>json_param</strong>     : Boolean - include ESObs Parameter</li>
<li><strong>json_info</strong>      : Boolean - include ESObs Information with all information</li>
<li><strong>json_info_type</strong> : Boolean - include in ESObs Information the type of ESObs</li>
<li><strong>json_info_nval</strong> : Boolean - include in ESObs Information the lenght of ESObs</li>
<li><strong>json_info_box</strong>  : Boolean - include in ESObs Information the bounding box</li>
<li><strong>json_info_other</strong>: Boolean - include in ESObs Information the other information</li>
<li><strong>codif</strong> : dict (default ES.codeb). Numerical value for string in CBOR encoder</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>string or dict</strong> : Json string or dict</li>
</ul>
</div>


                            </div>
                            <div id="Observation.to_numpy" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.to_numpy">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_numpy</span><span class="signature">(self, func=None, ind=&#39;axe&#39;, fillvalue=None, **kwargs)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">to_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to Numpy array.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes, &#39;flat&#39; : one dimension</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function to apply to the result values</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **Numpy array**    &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Convert <code><a href="#Observation">Observation</a></code> to Numpy array.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>ind</strong> : String (default 'axe') - 'axe' only independant axes, 'all' : all the axes, 'flat' : one dimension</li>
<li><strong>fillvalue</strong> : Object (default '?') used to complete result</li>
<li><strong>func</strong> : String (default function identity) - Name of the function to apply to the result values</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>Numpy array</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.to_xarray" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.to_xarray">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">to_xarray</span><span class="signature">(
    self,
    info=False,
    numeric=False,
    ind=&#39;axe&#39;,
    fillvalue=None,
    name=&#39;Observation&#39;,
    maxname=20,
    func=None,
    **kwargs
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">to_xarray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">info</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">numeric</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ind</span><span class="o">=</span><span class="s1">&#39;axe&#39;</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Observation&#39;</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Convert `Observation` to DataArray.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **info** : Boolean (default False) - Generate a specific Coords with Observation characteristics.</span>
<span class="sd">        - **ind** : String (default &#39;axe&#39;) - &#39;axe&#39; only independant axes, &#39;all&#39; : all the axes, &#39;flat&#39; : one dimension</span>
<span class="sd">        - **fillvalue** : Object (default &#39;?&#39;) used to complete result</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function applied to each Result `ES.ESValue`</span>
<span class="sd">        - **numeric** : Boolean (default False) - Generate a numeric DataArray.Values.</span>
<span class="sd">        - **name** : String (default &#39;Observation&#39;) - Name of the xArray</span>
<span class="sd">        - **maxname** : String (default 20) - maximum length for string</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **xarray.DataArray**        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;Observation not consistent&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span> <span class="p">:</span> <span class="k">raise</span> <span class="n">ObservationError</span><span class="p">(</span><span class="s2">&quot;Observation empty&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ind</span> <span class="o">==</span> <span class="s1">&#39;axe&#39;</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">lenidx</span><span class="p">))</span>
        <span class="n">ilf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="n">fillvalue</span><span class="p">)</span>
        <span class="n">ilf</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="c1">#xList = self._xlist_old(maxname=maxname)</span>
        <span class="n">xList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xlist</span><span class="p">(</span><span class="n">ilf</span><span class="p">,</span> <span class="n">maxname</span><span class="o">=</span><span class="n">maxname</span><span class="p">)</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">ES</span><span class="o">.</span><span class="n">xattrs</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;info&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_info</span><span class="p">(</span><span class="n">encoded</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_info_type</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">json_info_nval</span>  <span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">json_info_box</span> <span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">json_info_other</span> <span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s2">&quot;information&quot;</span><span class="p">]}</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xCoord</span><span class="p">(</span><span class="n">xList</span><span class="p">,</span> <span class="n">attrs</span><span class="p">,</span> <span class="n">ilf</span><span class="o">.</span><span class="n">idxref</span><span class="p">,</span> <span class="n">numeric</span><span class="p">)</span>
        <span class="n">dims</span> <span class="o">=</span> <span class="p">[</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">ilf</span><span class="o">.</span><span class="n">idxname</span><span class="p">[</span><span class="n">ax</span><span class="p">]]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">ilf</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="n">ilf</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">axe</span><span class="p">]</span> <span class="k">for</span> <span class="n">axe</span> <span class="ow">in</span> <span class="n">ilf</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">numeric</span> <span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">ilf</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">ilf</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">to_float</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="n">data</span> <span class="o">=</span> <span class="n">ilf</span><span class="o">.</span><span class="n">_tonumpy</span><span class="p">(</span><span class="n">ilf</span><span class="o">.</span><span class="n">extval</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">func</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>
        <span class="c1">#if numeric : data = ilf._tonumpy(ilf.extval, func = ReesultValue.to_float).reshape(ilf.axeslen)</span>
        <span class="c1">#else : data = ilf._tonumpy(ilf.extval, func=func, **kwargs).reshape(ilf.axeslen)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">info</span> <span class="p">:</span> <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span> <span class="p">:</span> <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Convert <code><a href="#Observation">Observation</a></code> to DataArray.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>info</strong> : Boolean (default False) - Generate a specific Coords with Observation characteristics.</li>
<li><strong>ind</strong> : String (default 'axe') - 'axe' only independant axes, 'all' : all the axes, 'flat' : one dimension</li>
<li><strong>fillvalue</strong> : Object (default '?') used to complete result</li>
<li><strong>func</strong> : String (default function identity) - Name of the function applied to each Result <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>numeric</strong> : Boolean (default False) - Generate a numeric DataArray.Values.</li>
<li><strong>name</strong> : String (default 'Observation') - Name of the xArray</li>
<li><strong>maxname</strong> : String (default 20) - maximum length for string</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>xarray.DataArray</strong></li>
</ul>
</div>


                            </div>
                            <div id="Observation.view" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.view">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">view</span><span class="signature">(self, **kwargs)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate tabular list to display `Observation` data.</span>

<span class="sd">        *Parameters (kwargs)*</span>

<span class="sd">        - **json** : boolean (default True) - Display json for `ES.ESValue`</span>
<span class="sd">        - **name** : boolean (default True) - Display name for `ES.ESValue`</span>
<span class="sd">        - **dat**  : boolean (default True) - Display value for `ES.ESValue.DatationValue`</span>
<span class="sd">        - **loc**  : boolean (default True) - Display value for `ES.ESValue.LocationValue`</span>
<span class="sd">        - **prp**  : boolean (default True) - Display value for `ES.ESValue.PropertyValue`</span>
<span class="sd">        - **lenres** : Integer (default : 0) - Number of raws (all if 0)</span>
<span class="sd">        - **width** : Integer (default 15) - Number of characters displayed for each attribute.</span>
<span class="sd">        - **tabulate params** : default &#39;tablefmt&#39;: &#39;simple&#39;, &#39;numalign&#39;: &#39;left&#39;, &#39;stralign&#39;: &#39;left&#39;,</span>
<span class="sd">                   &#39;floatfmt&#39;: &#39;.3f&#39; - See tabulate module</span>

<span class="sd">        *Returns* : None &#39;&#39;&#39;</span>
        <span class="n">opttab</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;dat&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;loc&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;prp&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;lenres&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="n">optview</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;tablefmt&#39;</span><span class="p">:</span> <span class="s1">&#39;simple&#39;</span><span class="p">,</span> <span class="s1">&#39;numalign&#39;</span><span class="p">:</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span> <span class="s1">&#39;stralign&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;floatfmt&#39;</span><span class="p">:</span> <span class="s1">&#39;.2f&#39;</span><span class="p">}</span>
        <span class="n">option</span> <span class="o">=</span> <span class="n">opttab</span> <span class="o">|</span> <span class="n">optview</span> <span class="o">|</span> <span class="n">kwargs</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_to_tab</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">option</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">opttab</span><span class="p">})</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">({</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span> <span class="o">|</span> <span class="n">kwargs</span><span class="p">)[</span><span class="s1">&#39;width&#39;</span><span class="p">]</span>
        <span class="n">tab2</span> <span class="o">=</span> <span class="p">[[</span> <span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="n">width</span><span class="p">]</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span> <span class="k">else</span> <span class="n">x</span><span class="p">)(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">lig</span><span class="p">]</span> <span class="k">for</span> <span class="n">lig</span> <span class="ow">in</span> <span class="n">tab</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tabulate</span><span class="p">(</span><span class="n">tab2</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s1">&#39;firstrow&#39;</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">option</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">optview</span><span class="p">}))</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate tabular list to display <code><a href="#Observation">Observation</a></code> data.</p>

<p><em>Parameters (kwargs)</em></p>

<ul>
<li><strong>json</strong> : boolean (default True) - Display json for <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>name</strong> : boolean (default True) - Display name for <code><a href="ESValue.html">ES.ESValue</a></code></li>
<li><strong>dat</strong>  : boolean (default True) - Display value for <code><a href="ESValue.html#DatationValue">ES.ESValue.DatationValue</a></code></li>
<li><strong>loc</strong>  : boolean (default True) - Display value for <code><a href="ESValue.html#LocationValue">ES.ESValue.LocationValue</a></code></li>
<li><strong>prp</strong>  : boolean (default True) - Display value for <code><a href="ESValue.html#PropertyValue">ES.ESValue.PropertyValue</a></code></li>
<li><strong>lenres</strong> : Integer (default : 0) - Number of raws (all if 0)</li>
<li><strong>width</strong> : Integer (default 15) - Number of characters displayed for each attribute.</li>
<li><strong>tabulate params</strong> : default 'tablefmt': 'simple', 'numalign': 'left', 'stralign': 'left',
       'floatfmt': '.3f' - See tabulate module</li>
</ul>

<p><em>Returns</em> : None</p>
</div>


                            </div>
                            <div id="Observation.vList" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.vList">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">vList</span><span class="signature">(
    self,
    idxname,
    func=&lt;bound method Es._identity of &lt;ESconstante.Es object at 0x0000020C1DCADEE0&gt;&gt;
)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">vList</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ES</span><span class="o">.</span><span class="n">_identity</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>
<span class="sd">        - **func** : String (default function identity) - Name of the function applied to each `ES.ESValue`</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the values      &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">idxname</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="p">:</span>
            <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))]</span>
            <span class="k">else</span> <span class="p">:</span>              <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">]</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idxname</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">func</span> <span class="o">==</span> <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="k">return</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>
            <span class="k">else</span> <span class="p">:</span>              <span class="k">return</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate a list of value for an axis.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>idxname</strong> : string - Name of the axis (datation, location, property, result)</li>
<li><strong>func</strong> : String (default function identity) - Name of the function applied to each <code><a href="ESValue.html">ES.ESValue</a></code></li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>list</strong> : list of the values</li>
</ul>
</div>


                            </div>
                            <div id="Observation.vListName" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.vListName">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">vListName</span><span class="signature">(self, idxname)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">vListName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value name for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the value name      &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">idxname</span> <span class="o">==</span> <span class="n">ES</span><span class="o">.</span><span class="n">res_classES</span> <span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vName</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">idxname</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">extval</span><span class="p">))]</span>
        <span class="k">else</span> <span class="p">:</span>
            <span class="n">ind</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxname</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">idxname</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">setidx</span><span class="p">[</span><span class="n">ind</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">vName</span><span class="p">(</span><span class="n">ES</span><span class="o">.</span><span class="n">vName</span><span class="p">[</span><span class="n">idxname</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">idxlen</span><span class="p">[</span><span class="n">ind</span><span class="p">])]</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate a list of value name for an axis.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>idxname</strong> : string - Name of the axis (datation, location, property, result)</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>list</strong> : list of the value name</li>
</ul>
</div>


                            </div>
                            <div id="Observation.vListSimple" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.vListSimple">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">vListSimple</span><span class="signature">(self, idxname)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">vListSimple</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of simple value (see `ES.ESValue` vSimple method) for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the simple value      &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="n">idxname</span><span class="p">,</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">vSimple</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate a list of simple value (see <code><a href="ESValue.html">ES.ESValue</a></code> vSimple method) for an axis.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>idxname</strong> : string - Name of the axis (datation, location, property, result)</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>list</strong> : list of the simple value</li>
</ul>
</div>


                            </div>
                            <div id="Observation.vListValue" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.vListValue">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">vListValue</span><span class="signature">(self, idxname)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">vListValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idxname</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generate a list of value (see `ES.ESValue` getValue method) for an axis.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **idxname** : string - Name of the axis (datation, location, property, result)</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **list** : list of the values      &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vList</span><span class="p">(</span><span class="n">idxname</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">ESValue</span><span class="o">.</span><span class="n">getValue</span><span class="p">)</span>
</pre></div>

        </details>

            <div class="docstring"><p>Generate a list of value (see <code><a href="ESValue.html">ES.ESValue</a></code> getValue method) for an axis.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>idxname</strong> : string - Name of the axis (datation, location, property, result)</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>list</strong> : list of the values</li>
</ul>
</div>


                            </div>
                            <div id="Observation.voxel" class="classattr">
                                        <div class="attr function"><a class="headerlink" href="#Observation.voxel">#&nbsp;&nbsp</a>

        
            <span class="def">def</span>
            <span class="name">voxel</span><span class="signature">(self, sort=False)</span>:
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span>    <span class="k">def</span> <span class="nf">voxel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Visualize Result `ES.ESValue` in a cube with voxels.</span>

<span class="sd">        *Parameters*</span>

<span class="sd">        - **sort** : Boolean (default False) - Sort along axis.</span>

<span class="sd">        *Returns*</span>

<span class="sd">        - **None**</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">consistent</span> <span class="p">:</span> <span class="k">return</span>
        <span class="n">obc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sort</span> <span class="p">:</span> <span class="n">obc</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">obc</span><span class="o">.</span><span class="n">ilist</span><span class="o">.</span><span class="n">full</span><span class="p">()</span>
        <span class="c1">#obx = obc.to_xarray(numeric = False, func=ReesultValue.isNotNull)</span>
        <span class="n">obx</span> <span class="o">=</span> <span class="n">obc</span><span class="o">.</span><span class="n">to_xarray</span><span class="p">(</span><span class="n">numeric</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="n">ESValue</span><span class="o">.</span><span class="n">isNotNull</span><span class="p">)</span>
        <span class="n">obp</span> <span class="o">=</span> <span class="n">obx</span> <span class="c1">#&gt;=0</span>
        <span class="n">obp</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;locran&#39;</span><span class="p">,</span> <span class="n">dat</span><span class="o">=</span><span class="s1">&#39;datran&#39;</span><span class="p">,</span> <span class="n">prp</span><span class="o">=</span><span class="s1">&#39;prpran&#39;</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">voxels</span><span class="p">(</span><span class="n">obp</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nValueObs</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;dat (index)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;loc (index)&#39;</span><span class="p">,</span> <span class="n">zlabel</span><span class="o">=</span><span class="s1">&#39;prp (index)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

        </details>

            <div class="docstring"><p>Visualize Result <code><a href="ESValue.html">ES.ESValue</a></code> in a cube with voxels.</p>

<p><em>Parameters</em></p>

<ul>
<li><strong>sort</strong> : Boolean (default False) - Sort along axis.</li>
</ul>

<p><em>Returns</em></p>

<ul>
<li><strong>None</strong></li>
</ul>
</div>


                            </div>
                </section>
                <section id="ObservationError">
                                <div class="attr class">
        <a class="headerlink" href="#ObservationError">#&nbsp;&nbsp</a>

        
        <span class="def">class</span>
        <span class="name">ObservationError</span><wbr>(<span class="base">builtins.Exception</span>):
    </div>

            <details>
            <summary>View Source</summary>
            <div class="pdoc-code codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ObservationError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">)</span> <span class="p">:</span>
    <span class="k">pass</span>
</pre></div>

        </details>

            <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>


                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt>builtins.Exception</dt>
                                <dd id="ObservationError.__init__" class="function">Exception</dd>

            </div>
            <div><dt>builtins.BaseException</dt>
                                <dd id="ObservationError.with_traceback" class="function">with_traceback</dd>
                <dd id="ObservationError.args" class="variable">args</dd>

            </div>
                                </dl>
                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.type) {
                    case "function":
                        heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span><span class="signature">${doc.signature}:</span>`;
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value">${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.type}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>